"use strict";var __importDefault=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.onAfterInit=exports.throwError=void 0;const path_1=__importDefault(require("path")),os_1=__importDefault(require("os")),fs_1=require("fs");function localWhich(t){var e=[t];const n="win32"===os_1.default.platform();n&&e.push(t+".exe");t=n?null==(t=process.env.PATH)?void 0:t.split(";"):null==(t=process.env.PATH)?void 0:t.split(":");if(t&&0!==t.length)for(const r of t)if(0<e.filter(t=>{if(!fs_1.existsSync(path_1.default.join(r,t)))return!1;if(n)return!0;try{return fs_1.accessSync(path_1.default.join(r,t),fs_1.constants.X_OK),!0}catch(t){return!1}}).length)return r;return null}async function generateOptions(t){var e,t=t.packages.ohos;if(t.orientation=t.orientation||{},t.sdkPath=await Editor.Profile.getConfig("program","ohos_sdk")||"",t.ndkPath=await Editor.Profile.getConfig("program","ohos_ndk")||"",t.sdkPath&&t.ndkPath)return{packageName:t.packageName||"",orientation:{landscapeRight:null==(e=t.orientation.landscapeRight)||e,landscapeLeft:null==(e=t.orientation.landscapeLeft)||e,portrait:null!=(e=t.orientation.portrait)&&e,upsideDown:null!=(e=t.orientation.upsideDown)&&e},apiLevel:t.apiLevel||"",sdkPath:t.sdkPath||"",ndkPath:t.ndkPath||"",renderBackEnd:{gles3:null==(t=null==(e=t.renderBackEnd)?void 0:e.gles3)||t}};throw new Error(Editor.I18n.t("ohos.tips.ohos_sdk_error"))}async function onAfterInit(t,e,n){var r=await generateOptions(t),o=(t.packages.ohos=r).renderBackEnd,o=(t.assetSerializeOptions["cc.EffectAsset"].glsl3=null==(t=o.gles3)||t,{packageName:r.packageName,orientation:r.orientation});n.__addStaticsInfo(o)}exports.throwError=!0,exports.onAfterInit=onAfterInit;