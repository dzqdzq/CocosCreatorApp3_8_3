"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,i,o){void 0===o&&(o=i),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,o){e[o=void 0===o?i:o]=t[i]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&__createBinding(t,e,i);return __setModuleDefault(t,e),t};Object.defineProperty(exports,"__esModule",{value:!0}),exports.configs=exports.load=void 0;const path_1=require("path"),fs_extra_1=require("fs-extra"),electron_1=require("electron"),xcode_proj_injection_1=require("../xcode-proj-injection"),utils_1=require("./utils"),Editor=__importStar(require("editor")),astcTypes=["astc_4x4","astc_5x5","astc_6x6","astc_8x8","astc_10x5","astc_10x10","astc_12x12"];async function load(){await Editor.Profile.getConfig("utils","features.ios-app-clip")||(exports.configs["ios-app-clip"]={})}exports.load=load,exports.configs={"ios-app-clip":{platformName:"iOS App Clip",options:{mainPackagePath:{label:"i18n:ios-app-clip.options.ios_app_path",verifyRules:["required","ios-app-path"],description:"i18n:ios-app-clip.options.ios_app_path_hint",render:{ui:"ui-file",attributes:{type:"directory",placeholder:"i18n:ios-app-clip.options.ios_app_path_hint"}}},embedXcodeprojTarget:{label:"i18n:ios-app-clip.options.embed_xcodeproj_target",description:"i18n:ios-app-clip.options.embed_xcodeproj_target_hint",verifyRules:["xcodeproj-path"],render:{ui:"ui-file",attributes:{type:"file",placeholder:"i18n:ios-app-clip.options.embed_xcodeproj_target_hint"}}},remoteServerAddress:{label:"i18n:ios-app-clip.options.remote_server_address",description:"i18n:ios-app-clip.options.remote_server_address_tips",render:{ui:"ui-input",attributes:{placeholder:"i18n:ios-app-clip.options.remote_server_address_tips"}},verifyRules:["http"]},orientation:{label:"Orientation",type:"object",default:{portrait:!0},attributes:{class:"wrap"},itemConfigs:{portrait:{label:"Portrait",default:!0,render:{ui:"ui-checkbox"}},landscapeLeft:{label:"Landscape Left",default:!1,render:{ui:"ui-checkbox"}},landscapeRight:{label:"Landscape Right",default:!1,render:{ui:"ui-checkbox"}}}},polyfills:{label:"Polyfills",type:"object",attributes:{class:"wrap"},itemConfigs:{asyncFunctions:{label:"i18n:native.options.async_functions",description:"i18n:native.options.async_functions_tips",default:!0,render:{ui:"ui-checkbox"}}}}},hooks:"./hooks",textureCompressConfig:{platformType:"ios",support:{rgb:["pvrtc_4bits_rgb","pvrtc_2bits_rgb",...astcTypes],rgba:["pvrtc_4bits_rgb_a","pvrtc_4bits_rgba","pvrtc_2bits_rgb_a","pvrtc_2bits_rgba",...astcTypes]}},assetBundleConfig:{supportedCompressionTypes:["none","merge_dep","merge_all_json"]},commonOptions:{buildPath:!1},verifyRuleMap:{"ios-app-path":{func:(e,t)=>!(!e||!fs_extra_1.existsSync(e)),message:"i18n:ios-app-clip.tips.ios_app_path_error"},"xcodeproj-path":{func:(e,t)=>{t=t.packages["ios-app-clip"].mainPackagePath;if(e){if(!e.endsWith(".xcodeproj"))return!1;var i=path_1.join(Editor.App.path,"../resources/3d/engine/native"),o=path_1.join(i,"templates/js-template-link/frameworks/runtime-src/proj.ios_mac"),r=utils_1.findXcodeProjects(o);if(1!==r.length)throw new Error(r.length+` Xcode projects found in ${o}, 1 expected`);try{new xcode_proj_injection_1.XcodeProjModifer({appName:"_AppClip",doBackup:!0,refXcodeProject:path_1.join(o,r[0]),inputXcodeProj:e,cocosRoot:i,projectResDir:t})}catch(e){if(e.message.indexOf("already loaded")<0)return console.error(""+e.message),!1}}return!0},message:"i18n:ios-app-clip.tips.xcodeproj_path_error"}},realInFileExplorer:e=>{e.packages["ios-app-clip"].mainPackagePath?(e=path_1.join(e.packages["ios-app-clip"].mainPackagePath,"ios-app-clip"),fs_extra_1.existsSync(e)?electron_1.shell.openExternal(e):console.error(e+" is not exist!")):console.error("mainPackagePath")}}};