"use strict";var __awaiter=this&&this.__awaiter||function(e,n,r,s){return new(r=r||Promise)(function(a,t){function i(e){try{p(s.next(e))}catch(e){t(e)}}function o(e){try{p(s.throw(e))}catch(e){t(e)}}function p(e){var t;e.done?a(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(i,o)}p((s=s.apply(e,n||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0}),exports.buttonConfig=exports.ready=exports.update=exports.$=exports.template=void 0;const fs_1=require("fs"),path_1=require("path"),build_1=require("./build"),verification_1=require("./utils/verification"),lodash=require("lodash");let panel;const methods={onNewCertificate(){Editor.Panel.open("builder.certificate")},t(e,t=""){return Editor.I18n.t("oppo-mini-game."+t+e)},onConfirm(i){return __awaiter(this,void 0,void 0,function*(){var e=this,t=i.target.value,a=i.target.getAttribute("path");lodash.set(e.pkgOptions,a,t),["useDebugKey","certificatePemPath","privatePemPath"].includes(a)&&e.updatePemPathCheckRes(),panel.dispatch("update",`packages.${e.pkgName}.`+a,t,e.verifyRes[a])})},updatePemPathCheckRes(){var e=this,t=e.pkgOptions.useDebugKey,a=verification_1.verificationFunc("privatePemPath",e.pkgOptions.privatePemPath,e.options),i=verification_1.verificationFunc("certificatePemPath",e.pkgOptions.certificatePemPath,e.options);e.verifyRes.privatePemPath=t?null:a.error,e.verifyRes.certificatePemPath=t?null:i.error,panel.dispatch("update",`packages.${e.pkgName}.certificatePemPath`,e.pkgOptions.certificatePemPath,e.verifyRes.certificatePemPath),panel.dispatch("update",`packages.${e.pkgName}.privatePemPath`,e.pkgOptions.privatePemPath,e.verifyRes.privatePemPath)},init(){return __awaiter(this,void 0,void 0,function*(){var e=this;e.pkgOptions=lodash.get(panel.options,"packages."+panel.options.platform),e.verifyRes=lodash.get(panel.errorMap,"packages."+panel.options.platform)||{},e.updatePemPathCheckRes()})}};function update(e,t){return __awaiter(this,void 0,void 0,function*(){panel=this,t&&!t.startsWith("packages."+panel.pkgName)||(panel.options=e,panel.vm.init())})}function ready(e,t,a,i){panel=this;var o=BuildPanel.Vue;panel.options=e,panel.pkgName=a,panel.errorMap=i,panel.vm=new o({el:panel.$.root,methods:methods,data(){return{pkgName:a,options:panel.options,errorMap:panel.errorMap,optionsConfig:build_1.optionsInPanel,pkgOptions:{},verifyRes:{}}},mounted(){this.init()},components:{"build-prop":BuildPanel.vueComps.buildProp,"template-comp":BuildPanel.vueComps.templateComp}})}exports.template=fs_1.readFileSync(path_1.join(__dirname,"../static/view.html"),"utf8"),exports.$={root:".oppo-mini-game"},exports.update=update,exports.ready=ready,exports.buttonConfig={configs:{build:{label:"i18n:oppo-mini-game.build.label"},make:{label:"i18n:oppo-mini-game.make.label",hookHandle:"make"}}};