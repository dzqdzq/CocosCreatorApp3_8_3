const _0x5b59=["download-with-progress","errorStr","download-canceled","progressCallback","basename","callId","now","hostAPI","canceled","download-progress","download-succeeded","fileName","once","function","transferred","file-selected","type","sendToHost","undefined","electron","readFile","__esModule","random","toString","../../constant/namespace","ipcRenderer","default","download-failed","download","off","is-ready","url",":panel-win-state-changed","defineProperty","promises",":get-version","floor","new-msg","total","percent","select-file","__importDefault","succeeded"],_0x1544=(!function(e){for(var n=457;--n;)e.push(e.shift())}(_0x5b59),function(e,n){return e-=235,_0x5b59[e]}),_0x481b97=_0x1544;var __importDefault=this&&this[_0x481b97(250)]||function(e){var n=_0x481b97;return e&&e[n(273)]?e:{default:e}};Object[_0x481b97(242)](exports,"__esModule",{value:!0});const fs_1=__importDefault(require("fs")),fsPromises=fs_1.default[_0x481b97(243)],path_1=__importDefault(require("path")),namespace_1=require(_0x481b97(276)),electron_1=require(_0x481b97(271)),pluginVersion=electron_1.ipcRenderer.sendSync(namespace_1.ns+_0x481b97(244)),globalAny=global;let panelWinStateChangedListener=null;function uuid(){const r=_0x481b97;let o=Date[r(258)]();return r(270)!=typeof performance&&r(265)==typeof performance[r(258)]&&(o+=performance[r(258)]()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var n=r,t=(o+16*Math[n(274)]())%16|0;return o=Math[n(245)](o/16),("x"===e?t:3&t|8)[n(275)](16)})}electron_1.ipcRenderer.on(namespace_1.ns+_0x481b97(241),(e,n)=>{panelWinStateChangedListener&&panelWinStateChangedListener(n)}),globalAny[_0x481b97(259)]={imPluginVersion:pluginVersion,getData:async()=>new Promise(t=>{var e=_0x481b97;electron_1[e(277)][e(264)]("get-data",function(e,n){t(n)}),electron_1[e(277)][e(269)]("request-data")}),sendToHost:(e,n)=>{var t=_0x481b97;t(246)===e?electron_1.ipcRenderer.sendToHost(t(246),{newMsgCount:n}):t(237)===e&&electron_1[t(277)][t(269)](t(237),{url:n[t(240)],type:n.type,fileName:n.fileName})},isReady(e){var n=_0x481b97;electron_1[n(277)][n(269)](n(239),e)},setWindowListener(e){panelWinStateChangedListener=e},selectFile:async r=>new Promise((t,e)=>{var n=_0x481b97;electron_1[n(277)][n(264)](n(267),function(e,n){n?async function(e){var n=_0x1544,t=path_1[n(235)][n(256)](e),n=await fsPromises[n(272)](e);return new File([n],t)}(n).then(t):t("")}),electron_1[n(277)][n(269)](n(249),{type:r})}),downloadWithProgress:async i=>new Promise((t,e)=>{const n=_0x481b97,r=uuid();function o(e,n){var t=_0x1544;n[t(257)]!==r||1==n[t(248)]&&n.transferred!==n[t(247)]||i[t(255)]&&i[t(255)]({percent:n.percent,transferred:n[t(266)],total:n[t(247)]})}function a(e,n){var t=_0x1544;n===r&&c({status:t(251)})}function l(e,n){var t=_0x1544;n[t(257)]===r&&c({status:"failed",errorStr:n[t(253)]})}function s(e,n){var t=_0x1544;n===r&&c({status:t(260)})}function c(e){var n=_0x1544;t(e),electron_1[n(277)].off(n(261),o),electron_1[n(277)][n(238)](n(262),a),electron_1[n(277)][n(238)](n(236),l),electron_1[n(277)][n(238)](n(254),s)}electron_1[n(277)][n(269)](n(252),{url:i[n(240)],type:i[n(268)],fileName:i[n(263)],callId:r}),electron_1[n(277)].on(n(261),o),electron_1.ipcRenderer.on(n(262),a),electron_1[n(277)].on(n(236),l),electron_1[n(277)].on(n(254),s)})};