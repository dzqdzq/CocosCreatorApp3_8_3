"use strict";const _0x22ad84=_0x4aeb;function _0x3039(e,i){const r=_0x1819();return(_0x3039=function(e,i){return e-=255,r[e]})(e,i)}function _0x4aeb(e,i){const r=_0x592d();return(_0x4aeb=function(e,i){return e-=201,r[e]})(e,i)}function _0x592d(){const e=["filter","337610DikWxJ","find","254303HxTFPG","96harIFn","splice","readProjectProfile","Config file error! (copyConfigSet => configs.find)","Config file error! (readEnableServices => readConfigSet)","shift","appConfigMaps","app_id","52jfbTNH","join","settings/service.json","test","Default","configs","__esModule","appid","readGlobalProfile","readServiceList","enable","2794850Azjjgx","310IayPEq","service_id","__importDefault","Config file error! (deleteConfigSet => configs.findIndex)","6bKhypO","readJsonSync","map","findIndex","default","length","defineProperty","name","36taLfbT","All","Config file error! (writeServiceParam => readConfigSet)","3VqOHLV","385801dVUGnv","writeProjectProfile","push","writeBindGame","5308369TRBzgO","services","Config file error! (readServiceParam => readConfigSet)","272057MpNVcV","writeGlobalProfile","getLang","max","924665GhkbgO","param","551537GVIFlf","cid","244278kPBNjp","104hXcxvj","fs-extra","generateConfigSet","game.app_id","compareVersion","config_id","Config file error! (copyConfigSet => appConfigMaps.find)","config_name","min","config_remarks","224XmOJqg","1417980WwDHzP","2.0.0","readConfigSets","6078668KLIoLM","groups","path","23221dAJiXE","4juoimo","game","forEach","service_component_name","getProjectPath","lang","117sXqtOj","6UdUtsJ"];return(_0x592d=function(){return e})()}!function(){for(var e=_0x4aeb,i=_0x592d();;)try{if(803912==-parseInt(e(270))+-parseInt(e(246))/2*(-parseInt(e(262))/3)+parseInt(e(211))/4+parseInt(e(274))/5*(parseInt(e(251))/6)+-parseInt(e(226))/7*(parseInt(e(207))/8)+-parseInt(e(221))/9*(-parseInt(e(224))/10)+-parseInt(e(267))/11*(parseInt(e(259))/12))break;i.push(i.shift())}catch(e){i.push(i.shift())}}();const _0x2cd05a=_0x3039;!function(){for(var i=_0x4aeb,e=_0x3039,r=_0x1819();;)try{if(394816==+parseInt(e(306))*(-parseInt(e(304))/2)+-parseInt(e(271))/3*(-parseInt(e(269))/4)+-parseInt(e(270))/5+parseInt(e(314))/6*(-parseInt(e(292))/7)+parseInt(e(273))/8*(parseInt(e(307))/9)+parseInt(e(301))/10*(parseInt(e(259))/11)+parseInt(e(294))/12*(parseInt(e(290))/13))break;r.push(r[i(232)]())}catch(e){r[i(265)](r[i(232)]())}}();var __importDefault=this&&this[_0x2cd05a(326)]||function(e){return e&&e.__esModule?e:{default:e}};function _0x1819(){const e=_0x4aeb,i=["./editor",e(222),e(252),"push",e(239),e(242),e(238),"find",e(256),e(282),e(269),e(271),e(218),e(249),"UNKNOW",e(203),"Config file error! (wirteEnableService => config.find)",e(281),e(233),e(228),"filter.",e(214),e(230),e(204),e(217),e(231),e(243),e(253),e(280),"config_remarks",e(219),e(215),e(208),"1515606FHPLrI",e(273),e(279),e(229),e(236),e(268),"cscv",e(260),e(216),e(223),e(255),e(220),e(201),e(237),e(234),e(264),e(241),e(213),e(258),e(263),e(202),e(276),"readConfigSet",e(227),e(257),e(277),"service_id","generateID",e(245),e(272),e(247),e(254),e(275),e(235),e(240),"15527FDMBpQ",e(278),"Config file error! (wirteEnableService => readConfigSet)",e(209),e(205),e(212),e(210)];return(_0x1819=function(){return i})()}Object[_0x2cd05a(295)](exports,_0x2cd05a(287),{value:!0});const editor_1=__importDefault(require(_0x2cd05a(313))),util_1=__importDefault(require("./util")),path_1=require(_0x2cd05a(288)),fs_extra_1=require(_0x2cd05a(266));let generateConfigItem=(e,i,r=[])=>({app_id:e,config_id:i[_0x2cd05a(291)],config_name:i[_0x2cd05a(261)],config_remarks:i[_0x22ad84(206)],services:r}),getConfigSetByConfig=e=>({config_id:e.config_id,config_name:e.config_name,config_remarks:e[_0x2cd05a(267)]});exports[_0x2cd05a(281)]={updateConfigFile:async function(){return new Promise(async(i,e)=>{var r=_0x4aeb,t=_0x3039;let a=async e=>{const a=_0x3039;e[a(265)](e=>{var i,r=_0x4aeb,t=a;void 0===e[r(202)]&&(i=this[r(281)](t(317)),e[t(291)]=i[r(202)],e[r(204)]=i[r(204)],e[t(267)]=i[t(267)])}),await editor_1[a(281)][a(286)](a(305),e)},n=async e=>{var i,r=_0x4aeb,t=_0x3039;null!=e&&(void 0!==e[t(305)]&&e[t(305)]instanceof Array&&await a(e[t(305)]),void 0!==e[t(279)]&&(e=e[t(279)],this[r(266)]({app_id:e[t(318)]||e.app_id||t(327),name:e[t(289)],c_id:e[t(296)]||"0"})),e=await editor_1[t(281)].readProjectProfile(t(322)),0<(i=await this[r(210)](e))[t(321)]&&await editor_1[r(255)][t(286)](t(256),[{app_id:e,config_id:i[0][t(291)]}]),await editor_1[t(281)][t(286)](t(277),t(309)))},o=await editor_1[t(281)][t(274)](t(277));if(void 0!==o&&0===util_1[t(281)][t(283)](o,t(309)))return i();var d=(0,path_1[t(275)])(editor_1[t(281)][t(268)](),t(284));if((0,fs_extra_1.existsSync)(d)&&(void 0===await editor_1[t(281)][t(274)](t(279))||null===await editor_1[r(255)][t(274)](t(279))))try{n((0,fs_extra_1[t(315)])(d))}catch(e){return i()}i()})},generateConfigSet:function(e,i=""){var r=_0x2cd05a;return{config_id:util_1[r(281)][r(298)](e),config_name:e,config_remarks:i}},copyConfigSet:async function(o,d="",c=""){return new Promise(async(e,i)=>{const r=_0x4aeb,t=_0x3039;if(""===c&&(c=await editor_1[r(255)][r(229)](t(322))),""===d){var a=(await editor_1[t(281)][t(274)]("appConfigMaps")||[])[r(225)](e=>e[t(285)]===c);if(void 0===a)return i(t(328));d=a[r(202)]}var a=await editor_1.default[r(229)](t(305))||[],n=a[r(225)](e=>e[r(234)]==c&&e[t(291)]===d);if(void 0===n)return i(t(260));i=generateConfigItem(c,o,n[t(276)]||[]);a[t(316)](i),await editor_1[t(281)][r(264)](t(305),a),e()})},deleteConfigSet:async function(o,d=""){return new Promise(async(e,i)=>{const r=_0x4aeb,t=_0x3039;""===d&&(d=await editor_1[t(281)][t(274)](r(282)));let a=await editor_1[r(255)][t(274)](t(305));var n=(a=a||[])[t(302)](e=>e[t(285)]==d&&e[t(291)]===o);if(n<0)return i(r(250));a[t(257)](n,1),await editor_1[t(281)][r(264)](t(305),a);i=a[r(223)](e=>e[t(285)]===d);e(i[Math[t(272)](Math[t(310)](i[t(321)]-1,n-1),0)])})},readServiceList:async function(){var e=_0x2cd05a;return await editor_1[e(281)].readGlobalProfile(e(276))||[]},writeServiceList:async function(e){var i=_0x22ad84,r=_0x2cd05a;return await editor_1[i(255)][r(324)](r(282),editor_1[r(281)][r(300)]()),editor_1[r(281)][r(324)](i(268),e)},readServiceGroupList:async function(){var e=_0x22ad84,i=_0x2cd05a;return await editor_1[i(281)][e(243)](i(311))||[]},writeServiceGroupList:async function(e){var i=_0x22ad84,r=_0x2cd05a;return await editor_1[r(281)][i(271)](r(282),editor_1[r(281)][r(300)]()),editor_1[r(281)][r(324)](r(311),e)},readServiceFilter:async function(){var e=_0x2cd05a;return await editor_1[e(281)][e(264)](e(258)+editor_1[e(281)][e(300)]())||{status:e(278),platforms:[e(278)]}},writeServiceFilter:async function(e){var i=_0x22ad84,r=_0x2cd05a;return editor_1[r(281)][i(271)](r(258)+editor_1[r(281)][r(300)](),e)},readBindGame:async function(){var e=_0x2cd05a;return editor_1[e(281)][e(274)](e(279))},writeBindGame:async function(n){return new Promise(async(e,i)=>{var r=_0x4aeb,t=_0x3039;await editor_1.default[r(264)](t(279),n);let a=await this[t(293)](n[t(285)]);void 0===(a=void 0===a&&0<(r=await this[t(312)](n[t(285)]))[t(321)]?r[0]:a)&&(a=this[t(255)]("Default")),await this.writeConfigSet(a,n[t(285)]),e()})},readConfigSet:async function(d=""){return new Promise(async(e,i)=>{const r=_0x4aeb,t=_0x3039;""===d&&(d=await editor_1[t(281)][t(274)](t(322)));let a,n=await editor_1[t(281)][t(274)](t(256))||[];do{let i=n.find(e=>e[t(285)]===d),e=await editor_1[t(281)][t(274)](t(305));if(void 0===i||null===e)break;var o=e[t(320)](e=>e[t(285)]==d&&e[r(202)]==(null==i?void 0:i[r(202)]));if(void 0===o)break;a=getConfigSetByConfig(o)}while(0);e(a)})},writeConfigSet:async function(c,_=""){return new Promise(async(e,i)=>{const r=_0x4aeb,t=_0x3039;""===_&&(_=await editor_1[t(281)][t(274)](t(322)));let a=await editor_1[r(255)][t(274)](r(233))||[],n=a[t(320)](e=>e[t(285)]===_),o=(void 0===n?(n={app_id:_,config_id:c[t(291)]},a[t(316)](n)):n[r(202)]=c[r(202)],await editor_1[t(281)][t(286)](t(256),a),await editor_1[t(281)][t(274)](t(305)));var d=(o=o||[])[t(320)](e=>e[t(285)]==_&&e[t(291)]===c.config_id);void 0===d?o[t(316)](generateConfigItem(_,c)):(d[t(291)]=c[t(291)],d[t(261)]=c[t(261)],d[r(206)]=c[t(267)]),await editor_1[t(281)][t(286)](t(305),o),e()})},readConfigSets:async function(o=""){return new Promise(async(e,i)=>{const r=_0x4aeb,t=_0x3039;""===o&&(o=await editor_1[t(281)][r(229)](t(322)));let a=await editor_1[r(255)][t(274)](t(305)),n=(a=a||[],[]);a[t(280)](e=>e[r(234)]===o)[r(217)](e=>e[t(291)]&&n[t(316)](getConfigSetByConfig(e))),e(n)})},readEnableServices:async function(_=""){return new Promise(async(e,i)=>{const r=_0x4aeb,t=_0x3039;let a=await editor_1[t(281)].readProjectProfile(t(322));if(""===_){var n=await this[t(293)]();if(void 0===n)return i(t(263));_=n[t(291)]}let o=await editor_1[t(281)][t(274)](t(305)),d=(o=o||[],[]);do{var c=o[t(320)](e=>e[t(285)]==a&&e[t(291)]===_);if(void 0===c||void 0===c[t(276)]||0===c[t(276)][t(321)])break;c[t(276)][t(280)](e=>e[t(299)])[t(262)](e=>d[r(265)](e.service_id))}while(0);e(d)})},wirteEnableService:async function(c,_,s=""){return new Promise(async(e,i)=>{const r=_0x4aeb,t=_0x3039;let a=await editor_1[t(281)][t(274)]("game.app_id");if(""===s){var n=await this.readConfigSet();if(void 0===n)return i(t(308));s=n[t(291)]}let o=await editor_1[r(255)][t(274)](r(240));n=(o=o||[])[t(320)](e=>e[t(285)]==a&&e[r(202)]===s);if(void 0===n)return i(t(329));void 0===n.services&&(n[t(276)]=[]);let d=n[t(276)][t(320)](e=>e[r(248)]===c);void 0===d?(d={service_id:c,enable:_,param:{}},n[t(276)][t(316)](d)):d[t(299)]=_,await editor_1[t(281)][t(286)](t(305),o),e()})},readServiceParam:async function(_,s=""){return new Promise(async(e,i)=>{const r=_0x4aeb,t=_0x3039;let a=await editor_1[t(281)][t(274)]("game.app_id");if(""===s){var n=await this[t(293)]();if(void 0===n)return i(t(323));s=n[r(202)]}let o=await editor_1[t(281)][t(274)](t(305)),d=(o=o||[],{});do{var c=o[r(225)](e=>e[t(285)]==a&&e[t(291)]===s);if(void 0===c||void 0===c[t(276)]||0===c[t(276)][t(321)])break;c=c[t(276)][r(225)](e=>e[r(248)]===_);void 0!==c&&void 0!==c[t(303)]&&null!==c[t(303)]&&(d=c[t(303)])}while(0);e(d)})},writeServiceParam:async function(c,_,s=""){return new Promise(async(e,i)=>{const r=_0x4aeb,t=_0x3039;let a=await editor_1[t(281)][r(229)](t(322));if(""===s){var n=await this[t(293)]();if(void 0===n)return i(r(261));s=n[t(291)]}let o=await editor_1[t(281)][t(274)](r(240));n=(o=o||[])[t(320)](e=>e[t(285)]==a&&e[t(291)]===s);if(void 0===n)return i("Config file error! (writeServiceParam => readConfigSet)");void 0===n[t(276)]&&(n[t(276)]=[]);let d=n.services[r(225)](e=>e[t(297)]===c);void 0===d?(d={service_id:c,enable:!1,param:_},n[r(268)][t(316)](d)):d[t(303)]=_,await editor_1[t(281)][r(264)](t(305),o),e()})},readDevMode:async function(){const e=_0x22ad84,i=_0x2cd05a;return 0!==(await this[e(244)]())[i(280)](e=>/service-cocosads/[i(319)](e[i(325)]))[i(321)]}};