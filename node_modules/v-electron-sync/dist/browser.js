'use strict';
Object.defineProperty(exports, "__esModule", { value: true });
var electron_1 = require("electron");
var pkg = require('../package.json');
var ipcFlag = pkg.name + "@" + pkg.version;
var map = {};
exports.id = -1;
/**
* 注册一个通道
* @param key
* @param value
*/
function set(key, value) {
    map[key] = value;
    var array = electron_1.webContents.getAllWebContents();
    array.forEach(function (content) {
        content.send(ipcFlag + ":set", key, value);
    });
}
exports.set = set;
/**
 * 删除一个通道
 * @param key
 */
function remove(key) {
    delete map[key];
    var array = electron_1.webContents.getAllWebContents();
    array.forEach(function (content) {
        content.send(ipcFlag + ":delete", key);
    });
}
exports.remove = remove;
/**
 * 查询通道对应的 webContext id
 * @param key
 */
function get(key) {
    return map[key];
}
exports.get = get;
electron_1.ipcMain.on(ipcFlag + ":set", function (event, key, value) {
    set(key, value);
});
electron_1.ipcMain.on(ipcFlag + ":remove", function (event, key) {
    remove(key);
});
electron_1.ipcMain.on(ipcFlag + ":get", function (event, key) {
    event.returnValue = get(key);
});
electron_1.ipcMain.on(ipcFlag + ":query", function (event) {
    event.returnValue = {
        id: event.sender.id,
        map: map,
    };
});
