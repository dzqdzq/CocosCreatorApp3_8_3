'use strict';
Object.defineProperty(exports, "__esModule", { value: true });
exports.query = exports.clear = exports.unregister = exports.register = void 0;
var electron_1 = require("electron");
var pkg = require('../package.json');
var ipcFlag = "".concat(pkg.name, "@").concat(pkg.version);
var map = {};
/**
* 注册一个通道
* @param channel
*/
function register(channel) {
    electron_1.ipcRenderer.send("".concat(ipcFlag, ":register"), channel);
}
exports.register = register;
/**
* 删除一个通道
* @param channel
*/
function unregister(channel) {
    electron_1.ipcRenderer.send("".concat(ipcFlag, ":unregister"), channel);
}
exports.unregister = unregister;
/**
* 删除一个通道
* @param channel
*/
function clear(channel) {
    electron_1.ipcRenderer.send("".concat(ipcFlag, ":clear"), channel);
}
exports.clear = clear;
/**
* 查询通道对应的 webContext id
* @param channel
*/
function query(channel) {
    return electron_1.ipcRenderer.sendSync("".concat(ipcFlag, ":query"), channel);
}
exports.query = query;
electron_1.ipcRenderer.on("".concat(ipcFlag, ":delete"), function (event, channel, id) {
    var array = map[channel];
    if (!array) {
        return;
    }
    var index = array.indexOf(id);
    if (index >= 0) {
        array.splice(index, 1);
    }
    if (array.length === 0) {
        delete map[channel];
    }
});
electron_1.ipcRenderer.on("".concat(ipcFlag, ":clear"), function (event, channel) {
    delete map[channel];
});
