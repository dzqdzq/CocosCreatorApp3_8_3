"use strict";const ipc=require("@base/electron-base-ipc"),pkg=require("../package.json"),ipcFlag=`${pkg.name}@${pkg.version}`;let find=function(e,r){for(let n=0;n<e.length;n++){let c=e[n];if(c.label===r)return c}return null};class MenuManager{popup(e){e.separator=e.separator||"/",ipc.send(`${ipcFlag}:popup`,JSON.parse(JSON.stringify(e))).callback((r,n)=>{if(r)return void console.warn(r);let c=n.split(e.separator),a={submenu:e.menu};c.forEach(e=>{if(!a)return null;a=find(a.submenu,e)}),a.click&&a.click()})}click(e){return new Promise((r,n)=>{ipc.send(`${ipcFlag}:click-popup`,e).callback((e,c)=>{if(e)return console.warn(e),void n();r()})})}query(){return new Promise((e,r)=>{ipc.send(`${ipcFlag}:query-popup`).callback((n,c)=>{n?r(n):e(c)})})}}module.exports=new MenuManager;