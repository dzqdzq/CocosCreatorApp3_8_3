"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.analyzeCommonJs = exports.detectCjsExports = void 0;
const cjs_module_lexer_1 = __importDefault(require("cjs-module-lexer"));
// TODO: Not working in certain circumstances: https://github.com/endojs/endo/issues/1083
// import { analyzeCommonJS as analyzeCommonJsX } from '../../static/cjs-module-analyzer';
const detect_1 = require("./detect");
function detectCjsExports(source) {
    // `requires` may be also parsed from cjs-module-lexer.
    // Let's watch it:
    // https://github.com/guybedford/cjs-module-lexer/pull/10
    const { exports, reexports } = cjs_module_lexer_1.default.parse(source);
    return {
        exports,
        reexports,
    };
}
exports.detectCjsExports = detectCjsExports;
function analyzeCommonJs(source) {
    const requires = (0, detect_1.detectRequiresFromSourceSync)(source);
    // `requires` may be also parsed from cjs-module-lexer.
    // Let's watch it:
    // https://github.com/guybedford/cjs-module-lexer/pull/10
    const { exports, reexports } = detectCjsExports(source);
    return {
        requires,
        exports,
        reexports,
    };
}
exports.analyzeCommonJs = analyzeCommonJs;
//# sourceMappingURL=detect-exports.js.map