"use strict";var __awaiter=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(s,a)}c((n=n.apply(e,t||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0}),exports.checkReload=exports.enableOther=exports.disableOther=exports.startup=exports.queryDisableInfo=exports.removeDisableInfo=exports.addDisableInfo=exports.removeListener=exports.emit=exports.once=exports.on=exports.normalizePath=exports.checkVersion=exports.checkType=exports.scan=exports.compareVersion=void 0;const path_1=require("path"),events_1=require("events"),semver_1=require("semver"),ipc=require("@base/electron-base-ipc"),constant_1=require("../constant");var utils_1=require("../utils");Object.defineProperty(exports,"compareVersion",{enumerable:!0,get:function(){return utils_1.compareVersion}});const eventEmitter=new events_1.EventEmitter;function scan(e){return new Promise((t,r)=>{ipc.send("editor-lib-package-protected:call",scan,e).callback((e,n)=>{e?r(e):t(n)})})}function stripSep(e){let t;for(t=(e=(0,path_1.normalize)(e)).length-1;t>=0&&e[t]===path_1.sep;--t);return e.substring(0,t+1)}function contains(e,t){return e=stripSep(e),t=stripSep(t),"win32"===process.platform&&(e=e.toLowerCase(),t=t.toLowerCase()),e===t||(0,path_1.dirname)(e)!==(0,path_1.dirname)(t)&&(e.length<t.length&&0===t.indexOf(e+path_1.sep))}function checkType(e){return contains(constant_1.PATHS.BUILTIN,e)?"builtin":contains(constant_1.PATHS.LOCAL,e)?"local":contains(constant_1.PATHS.COVER,e)?"cover":contains(constant_1.PATHS.GLOBAL,e)?"global":"other"}function checkVersion(e){return(0,semver_1.satisfies)((0,semver_1.valid)((0,semver_1.coerce)(Editor.App.version)),e)}function normalizePath(e){return e=(0,path_1.normalize)(e),"win32"!==process.platform?e:e.replace(/^([a-z]):/,(e,t)=>t.toUpperCase()+":")}function on(e,t){return eventEmitter.on(e,t)}function once(e,t){return eventEmitter.once(e,t)}function emit(e,...t){ipc.send("editor-lib-package-protected:call","emit",e,...t)}function removeListener(e,t){return eventEmitter.removeListener(e,t)}function addDisableInfo(e){ipc.send("editor-lib-package-protected:call","addDisableInfo",e)}function removeDisableInfo(e){ipc.send("editor-lib-package-protected:call","removeDisableInfo",e)}function queryDisableInfo(e){return new Promise((t,r)=>{ipc.send("editor-lib-package-protected:call","queryDisableInfo",e).callback((e,n)=>{e?r(e):t(n)})})}function startup(){return __awaiter(this,void 0,void 0,function*(){console.warn("Please ise it(startup) in the browser process")})}function disableOther(e){return __awaiter(this,void 0,void 0,function*(){console.warn("Please ise it(disableOther) in the browser process")})}function enableOther(e){return __awaiter(this,void 0,void 0,function*(){console.warn("Please ise it(enableOther) in the browser process")})}function checkReload(e){return console.warn("Please ise it(checkReload) in the browser process"),!1}exports.scan=scan,exports.checkType=checkType,exports.checkVersion=checkVersion,exports.normalizePath=normalizePath,exports.on=on,exports.once=once,exports.emit=emit,exports.removeListener=removeListener,exports.addDisableInfo=addDisableInfo,exports.removeDisableInfo=removeDisableInfo,exports.queryDisableInfo=queryDisableInfo,exports.startup=startup,exports.disableOther=disableOther,exports.enableOther=enableOther,exports.checkReload=checkReload,ipc.on("editor-lib-package-protected:emit",(e,t,...r)=>__awaiter(void 0,void 0,void 0,function*(){eventEmitter.emit(t,...r)}));