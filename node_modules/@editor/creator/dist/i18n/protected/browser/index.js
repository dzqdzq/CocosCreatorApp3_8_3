"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getLanguageList=exports.exportLanguageData=exports.register=exports.select=exports.t=exports.getLanguage=void 0;const path_1=require("path"),electron_1=require("electron"),fs_extra_1=require("fs-extra"),i18n=require("@base/electron-i18n"),setting=require("@editor/setting"),ipc=require("@base/electron-base-ipc"),DEFAULT_LAN=electron_1.app.getLocale().indexOf("zh")>=0?"zh":"en";let json={language:DEFAULT_LAN};const languages={zh:require("../languages/zh"),en:require("../languages/en")},file=(0,path_1.join)(setting.PATH.HOME,"editor/i18n.json");try{json=(0,fs_extra_1.readJSONSync)(file)}catch(e){}"zh"===json.language&&i18n.switch(json.language);const save=function(){try{(0,fs_extra_1.outputJSONSync)(file,json,{spaces:2})}catch(e){console.error(e)}};function getLanguage(){return json.language||DEFAULT_LAN}function t(e,t){let n=i18n.translation(e)||i18n.translation(e,"en"===getLanguage()?"zh":"en");if("string"!=typeof n)return e;if(t&&"object"==typeof t){if(Object.keys(t).length){const e=/\{([a-zA-Z_]+[a-zA-Z0-9_])\}/g;n=n.replace(e,function(e,n){return""+t[n]})}}return n}function select(e){i18n.switch(e)}function register(e,t,n){i18n.append(t,n,e)}function exportLanguageData(e){let t;return e&&(t=i18n._message._map[e]),t||(t=i18n._message._current),t}function getLanguageList(){return Object.keys(i18n._message._map)}i18n.register(languages.en,"en"),i18n.register(languages.zh,"zh"),exports.getLanguage=getLanguage,exports.t=t,exports.select=select,exports.register=register,exports.exportLanguageData=exportLanguageData,exports.getLanguageList=getLanguageList,ipc.on("editor3d-lib-i18n:language",()=>json.language),i18n.on("switch",e=>{json.language!==e&&(json.language=e,Editor.Message.broadcast("i18n:change",e),save())});