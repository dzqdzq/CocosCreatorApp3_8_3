<!DOCTYPE html>
<html lang="en" spellcheck="false">

<head>
    <meta charset="utf-8">
    <title>Cocos Creator</title>
    <link href="./style/base.css" rel="stylesheet" />
    <link href="./style/main.css" rel="stylesheet" />
</head>

<body name="main">
    <!-- 同步任务的遮罩 -->
    <editor-mask id="task-sync-mask"></editor-mask>

    <!-- 顶部工具条 -->
    <header id="toolbar"
        :hidden="MAIN_WINDOW_ORIGIN_HEADER.ALL===false"
        :platform="platform"
        @dblclick="maximize"
    >
        <div class="left">
            <div class="hack-style"
                v-if="platform!=='win32'"
            ></div>
            <ui-panel
                v-for="item,key in left"
                :key="key"
                :src="item.path"
                @dblclick.stop
            ></ui-panel>
            <menu class="menu" id="menu" tabindex="0"
                v-if="platform==='win32'"   
                @dblclick.stop
            ></menu>
        </div>
        <div class="middle"
            :hidden="MAIN_WINDOW_ORIGIN_HEADER.CENTER===false"
        >
            <ui-panel
                v-for="item,key in middle"
                :key="key"
                :src="item.path"
                @dblclick.stop
            ></ui-panel>
        </div>
        <div class="right"
            :hidden="MAIN_WINDOW_ORIGIN_HEADER.RIGHT===false"
        >
            <div class="hack-style"
                v-if="platform==='win32'"
            ></div>
            <ui-panel
                v-for="item,key in right"
                :key="key"
                :src="item.path"
                @dblclick.stop
            ></ui-panel>
        </div>
        <div class="commands"
            v-if="platform==='win32'"
        >
            <ui-icon class="command mini" value="mini"
                @click="minimize"
            ></ui-icon>
            <ui-icon class="command maxi" 
                :value="maxiIcon"
                @click="maximize"
            ></ui-icon>
            <ui-icon class="command close" value="close"
                @click="close"
            ></ui-icon>
        </div>
    </header>

    <header id="custom-toolbar" hidden>
        <ui-panel></ui-panel>
    </header>

    <!-- 实际的插件布局 -->
    <dock-frame id="dock"></dock-frame>

    <!-- 底部工具条 -->
    <footer id="footer">
        <div class="left">
            <ui-panel
                v-for="item,key in left"
                :key="key"
                :src="item.path"
            ></ui-panel>
        </div>
        <div class="right">
            <ui-panel
                v-for="item,key in right"
                :key="key"
                :src="item.path"
            ></ui-panel>
            <span style="flex: 1;"></span>
        </div>
    </footer>

    <footer id="custom-footer" hidden>
        <ui-panel></ui-panel>
    </footer>

    <!-- 加载 js 运行逻辑 -->
    <script>
        // 禁止 electron 显示安全提示
        window.ELECTRON_DISABLE_SECURITY_WARNINGS = true;
        window.__MAIN__ = true;
        window.__InitializationTime__ = Date.now();
        const { init, registerFindModulePath } = require('../../index');
        init().then(() => {
            const path = require('path');
            const appModulePath = path.join(Editor.App.path, 'node_modules');
            registerFindModulePath((args) => {
                switch (args[0]) {
                    case '@electron/remote':
                    case 'cc': {
                        args[1].splice(0, 0, appModulePath);
                    }
                }
                return args;
            });
            require('./script/main');
        });
    </script>
</body>

</html>
