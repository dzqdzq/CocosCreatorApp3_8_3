{"version":3,"file":"indexed-source-map.js","sourceRoot":"","sources":["../src/indexed-source-map.ts"],"names":[],"mappings":";;;AAGA,MAAa,gBAAgB;IACzB,YAAY,EACR,IAAI,EACJ,SAAS,GAIZ;QAwCO,eAAU,GAAgB;YAC9B,OAAO,EAAE,CAAC;YACV,QAAQ,EAAE,EAAE;SACf,CAAC;QAEM,UAAK,GAAG,EAAE,CAAC;QACX,WAAM,GAAG,CAAC,CAAC;QACX,aAAQ,GAAG,CAAC,CAAC;QACb,eAAU,GAAG,EAAE,CAAC;QA/CpB,IAAI,CAAC,UAAU,GAAG;YACd,OAAO,EAAE,CAAC;YACV,IAAI;YACJ,QAAQ,EAAE,EAAE;SACf,CAAC;QACF,IAAI,CAAC,UAAU,GAAG,SAAS,aAAT,SAAS,cAAT,SAAS,GAAI,EAAE,CAAC;IACtC,CAAC;IAED,IAAI,IAAI;QACJ,OAAO,IAAI,CAAC,KAAK,CAAC;IACtB,CAAC;IAED,IAAI,SAAS;QACT,OAAO,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;IAC3C,CAAC;IAEM,GAAG,CAAC,IAAqB,EAAE,GAAkB;QAChD,IAAI,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE;YACvB,IAAI,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC;SAC1B;QACD,IAAI,IAAI,CAAC,UAAU,EAAE;YACjB,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;SAClC;QACD,IAAI,GAAG,EAAE;YACL,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,IAAI,CAAC;gBAC1B,MAAM,EAAE,EAAE,IAAI,EAAE,IAAI,CAAC,MAAM,EAAE,MAAM,EAAE,IAAI,CAAC,QAAQ,EAAE;gBACpD,GAAG;aACN,CAAC,CAAC;SACN;QACD,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;IACxB,CAAC;IAEO,QAAQ,CAAC,IAAY;QACzB,MAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,aAAa,CAAC,CAAC;QACxC,IAAI,CAAC,MAAM,IAAI,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC;QAChC,IAAI,CAAC,QAAQ,IAAI,KAAK,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,MAAM,CAAC;QAChD,IAAI,CAAC,KAAK,IAAI,IAAI,CAAC;IACvB,CAAC;CAWJ;AAxDD,4CAwDC","sourcesContent":["\nimport { SourceMapGenerator, RawIndexMap, RawSourceMap } from 'source-map';\n\nexport class IndexedSourceMap {\n    constructor({\n        file,\n        separator,\n    }: {\n        file?: string,\n        separator?: string,\n    }) {\n        this._sourceMap = {\n            version: 3,\n            file,\n            sections: [],\n        };\n        this._separator = separator ?? '';\n    }\n\n    get code() {\n        return this._code;\n    }\n\n    get sourceMap() {\n        return JSON.stringify(this._sourceMap);\n    }\n\n    public add(code: string | Buffer, map?: RawSourceMap) {\n        if (Buffer.isBuffer(code)) {\n            code = code.toString();\n        }\n        if (this._separator) {\n            this._addCode(this._separator);\n        }\n        if (map) {\n            this._sourceMap.sections.push({\n                offset: { line: this._lines, column: this._columns },\n                map,\n            });\n        }\n        this._addCode(code);\n    }\n\n    private _addCode(code: string) {\n        const lines = code.split(/\\r\\n|\\r|\\n/g);\n        this._lines += lines.length - 1;\n        this._columns += lines[lines.length - 1].length;\n        this._code += code;\n    }\n\n    private _sourceMap: RawIndexMap = {\n        version: 3,\n        sections: [],\n    };\n\n    private _code = '';\n    private _lines = 0;\n    private _columns = 0;\n    private _separator = '';\n}\n"]}