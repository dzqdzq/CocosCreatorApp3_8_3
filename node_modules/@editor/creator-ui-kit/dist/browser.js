(()=>{"use strict";var e={84157:e=>{e.exports=require("electron")}},t={};function o(r){var l=t[r];if(void 0!==l)return l.exports;var n=t[r]={exports:{}};return e[r](n,n.exports,o),n.exports}o.d=(e,t)=>{for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};(()=>{o.r(r),o.d(r,{File:()=>f});var e=o(84157);e.ipcMain.on("ui-drag-item-start",((t,o)=>{const r=e.BrowserWindow.getAllWindows()??[];for(const e of r)e?.webContents.send("ui-drag-area-start",o)})),e.ipcMain.on("ui-drag-item-end",((t,o)=>{const r=e.BrowserWindow.getAllWindows()??[];for(const e of r)e?.webContents.send("ui-drag-area-end",o)}));const t=require("path"),{ipcMain:l,webContents:n}=o(84157);class i{register(e,t){return i.urlMap||(i.urlMap={}),i.urlMap[e]||"file"===e?(console.warn(`[UI-File] Register protocol(${e}) failed! protocol(${e}) has exist!`),!1):(i.urlMap[e]=t,this.emitChanges(),!0)}unregister(e){return delete i.urlMap[e],!0}getAllFileProtocol(){return Object.keys(i.urlMap).map((e=>({protocol:e,label:i.urlMap[e].label,path:i.urlMap[e].path})))}resolveToRaw(e){const o=e.match(/^([a-zA-z]*):\/\/(.*)$/);if(o){const e=o[2].replace(/\\/g,"/"),r=this.getProtocalInfo(o[1]);if(r)return(0,t.join)(r.path,e)}return e}resolveToUrl(e,o){if(!e||!(0,t.isAbsolute)(e)||!o)return"";const r=this.getProtocalInfo(o);return r?r.protocol+"://"+(0,t.relative)(r.path,e).replace(/\\/g,"/"):""}getProtocalInfo(e){if(i.urlMap[e])return{protocol:e,...i.urlMap[e]}}emitChanges(){const e=i.urlMap;n.getAllWebContents().forEach((t=>{t.send("main-protocols-change",e)}))}}i.urlMap={};const s=new i;l.on("ui-file-query-protocols",(e=>{e.reply("main-query-protocols",i.urlMap)}));const{ipcMain:a,dialog:p,BrowserWindow:c}=o(84157);a.on("ui-file-select-file",((e,t)=>{t=t||{};const o=c.fromWebContents(e.sender),r={defaultPath:t.defaultPath||"",properties:["openFile"],buttonLabel:t.buttonLabel||""};"directory"===t.type?r.properties=["openDirectory"]:"app"===t.type&&(r.filters=[{name:"Application",extensions:["win32"===process.platform?"exe":"app"]}]),t.multi&&r.properties.push("multiSelections"),t.extensions&&(r.filters=[{name:t.extensions,extensions:t.extensions.split(",").filter(Boolean)}]),p.showOpenDialog(o,r).then((o=>o.filePaths?(t.multi?e.reply("main-select-file",o.filePaths):e.reply("main-select-file",o.filePaths[0]),!0):e.reply("main-select-file",void 0)))})),a.on("ui-file-not-exist",((e,t)=>{p.showMessageBox({type:"warning",title:"warning",message:"File does not exist."})}));const u={label:"file://",path:"",protocol:"file",description:"",invalidInfo:""};class f{static registerProtocol(e,t){return"file"===e?(Object.assign(u,t),!0):(t.label=e+"://",s.register(e,t))}static unregisterProtocol(e){return s.unregister(e)}static resolveToRaw(e){return s.resolveToRaw(e)}static resolveToUrl(e,t){return s.resolveToUrl(e,t)}static getAllProtocolInfos(){return[u,...s.getAllFileProtocol()]}}})(),module.exports=r})();