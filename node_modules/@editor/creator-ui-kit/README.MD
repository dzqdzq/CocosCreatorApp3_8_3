# Creator UI kit

Creator 内使用的 ui 组件。组件能够同时在 web 和 electron 环境下运行。

## 开发须知

### 集成到编辑器内的测试方式

#### 方式 1

通过 Creator内置配置实现。

1. 在编辑器控制台输入以下内容，开启外部自定义的 `ui-kit` 插件后
```ts
Editor.Profile.setConfig('ui-kit', '__custom__', '{CreatorUIKitRoot}\\dist', 'global');
```

2. 修改 editor-extension 仓库的 extensions/ui-kit/static/scripts/windows.js 里引用 ui-kit 的路径
3. 刷新面板/重启编辑器即可

#### 方式二

通过 npm link 实现替换，无需其它配置

> 参考文档 https://docs.npmjs.com/cli/v6/commands/npm-link

1. 在本仓库下执行 `npm link`，等待 npm 执行完毕。该操作是全局生效的，仓库拉下来后只需执行一次即可。
2. 在 cocos-editor 仓库的 app 目录下执行 `npm link @editor/creator-ui-kit` 命令
3. 刷新面板/重启编辑器即可

某些情况下 creator-editor/app 下 npm link 创建的关联会失效（可能发生在重新 npm install之后），此时**只需重新执行上述第 2-3 步**即可

### 开发调试 
若需要获取带 sources map 的编译版本请执行 

```ts
npm run build:dev
```

`注意：` 浏览器 DevTool 需开启 Enable JavaScript sources map 选项，才能看到对应的 sources map

## 实现原则

1. 尽量将属性挂在 :host，这样外部能够通过样式覆盖更改
2. 数据流向保持 setter -> attributes -> property
3. 行内元素高度需要和 line-height 一致
4. 所有大小和配色需要使用 css 变量
5. attribute 一定有 property，但有 property 不一定会有 attribute
6. 简单属性 attribute 和 property 互相同步，如果接受对象需要序列化，则不同步
7. 组件设计、实现时的分类、命名、使用方式，可尽量先参考流行的组件库，减少理解成本。

**注意不能混淆外观相似、但操作逻辑不同的组件**。看着像一个 Button，不代表可以直接使用 Button。
如 `RadioButton`, `CheckboxButton` 这样的组件，在设计上是有所考量的。如特定的样式、与其它组件配合使用时的联动等，
这些封装在组件内部的逻辑，是直接使用 Button 组件时难以达成或无法达成的。

## 事件发送原则
- change event：当组件的 value 变化的时候立即发送

- confirm event：当组件触发过 change，ui 组件认为用户提交数据后，立即发送

- cancel event：当组件触发过 change，ui 组件认为用户需要丢弃数据，立即发送

用户丢失焦点，沿用之前的规则，视为用户确认需要数据（不丢弃数据）

## 分类

UI ELEMENT 应该分成：

1. 编辑元素
2. 操作元素
3. 布局元素
4. 显示元素
5. 功能元素
6. 其他复杂元素

## 编辑元素

编辑元素的一个特点是包含一个 value 数据，这个数据记录元素当前的数据，并且这个数据可以在元素上直接操作修改。

### 特点

可以获得焦点，inline

### 事件

- input 不冒泡
  当数据被修改的时候触发的消息

- change 冒泡
  数据被修改后触发的消息

- confirm 冒泡
  数据确认后触发的消息

- cancel 冒泡
  数据修改但取消后的消息

### 属性

1. value 记录当前元素记录的数据
2. readonly 只读的时候，无法对元素进行操作，其他表现和正常一致（包括焦点）
3. invalid 当数据错误的时候，给予一个错误的显示表现
4. disabled 不允许修改数据，在显示上和正常状态作出区分，并且无法点击，无法获得焦点
5. placeholder 当 value 为空的时候，默认显示的数据，在显示效果上需要和实际输入 value 不一样
6. focused 是否获得焦点

其他附加属性可以由每个元素自己实现。

### 元素列表

- [x] ui-input
- [x] ui-num-input
- [x] ui-file
- [x] ui-gradient
- [x] ui-slider
- [x] ui-textarea
- [x] ui-curve
- [ ] ui-array

- [x] ui-bit
- [x] ui-select
- [x] ui-checkbox
- [x] ui-object
- [x] ui-asset
- [x] ui-component
- [x] ui-node

## 操作元素

操作元素一般是能够操作响应到事件，但没有 change 事件的一种元素

### 特点

可获得焦点，inline

### 事件

- confirm 冒泡
  操作元素的时候触发

### 属性

1. disabled 无法操作元素，并且在显示效果上能够看出，无法获得焦点
2. value 部分元素可能会有的值
3. focused 是否获得焦点

### 元素列表

- [x] ui-button
- [x] ui-color
- [x] ui-tab

## 布局元素

布局元素作用是自动布局内部的一些元素，能够脱离 css 实现简单的布局。

### 特点

不可获得焦点，block
**但焦点如果传递到布局元素内的元素上的时候，被折叠的布局元素需要展开**

### 事件

- resize
  大小变化的时候触发

- layout
  重新布局的时候触发

### 属性

没有固定属性

### 元素列表

- [x] ui-prop
- [x] ui-section
- [ ] ui-layout
- [ ] ui-table

## 显示元素

显示元素顾名思义，是一个只负责显示的元素。

### 特点

不可获得焦点，inline

### 事件

没有事件

### 属性

没有公用属性

### 元素列表

- [x] ui-image
- [x] ui-code
- [x] ui-icon
- [x] ui-label
- [x] ui-loading
- [x] ui-progress
- [x] ui-qrcode

## 功能元素

功能元素是实现了某种特定功能，只要将其他元素套入功能元素，就能够实现某种特定功能的 ui。

### 特点

不可获得焦点

### 事件

没有公用事件

### 属性

没有公用属性

### 元素列表

- [x] ui-drag-area
- [x] ui-drag-item
- [x] ui-link
- [x] ui-setting
- [x] ui-tooltip

## 复杂元素

复杂元素是不能概括成以上几种类型的元素。关于复杂元素，并没有过多的约定和限制。

### 属性

- [x] ui-tree
- [x] ui-color-picker
- [x] ui-gradient-picker
- [x] ui-node-graph
