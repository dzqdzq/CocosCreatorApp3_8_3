"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.modifyPackageName=exports.checkPackageNameValidity=exports.changePackageName=void 0;const path_1=require("path"),fs_extra_1=require("fs-extra");async function changePackageName(e,t){var c=(0,path_1.join)(e,".cocos-project.json");if((0,fs_extra_1.existsSync)(c)){var r=await(0,fs_extra_1.readJSON)(c);if(checkPackageNameValidity(t=t||r.packageName)){let a=r.packageName;var i=(a=r.mac&&r.mac.packageName?r.mac.packageName:a)!==t;if(i){var o=(0,path_1.join)(e,"cocos-project-template.json");if((0,fs_extra_1.existsSync)(o)){var s=(await(0,fs_extra_1.readJSON)(o)).do_add_native_support;if(i)for(const l of s.project_replace_mac_bundleid.files){var n=(0,path_1.join)(e,l);if((0,fs_extra_1.existsSync)(n)){let e=await(0,fs_extra_1.readFile)(n,"utf8");e=e.replace(new RegExp(a,"gm"),t),await(0,fs_extra_1.writeFile)(n,e)}else console.error(`Can't not find file [${l}], replace package name failed`)}r.mac||(r.mac={}),r.mac.packageName=t,await(0,fs_extra_1.writeFile)(c,JSON.stringify(r,null,2))}else console.error(`Can't find template json [${o}]`)}}else console.error("The package name is illegal(MAC). It can only contain these characters: [0-9], [a-z], [A-Z], [_].")}else console.error(`Can't find project json [${c}]`)}function checkPackageNameValidity(e){return/^[a-zA-Z]+([a-zA-Z0-9-.])+$/.test(e)}function modifyPackageName(e){return e}exports.changePackageName=changePackageName,exports.checkPackageNameValidity=checkPackageNameValidity,exports.modifyPackageName=modifyPackageName;