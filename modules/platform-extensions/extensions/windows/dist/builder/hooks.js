"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.onAfterBundleInit=exports.onAfterInit=void 0;const fs_extra_1=require("fs-extra");async function onAfterInit(e,a,t){const s=e.packages.windows.renderBackEnd,n=(a.staticsInfo.B100005=e.name,Editor.Metrics.trackEvent({category:"Project",action:"Rendering Backend",label:"Vulkan",value:e.packages.windows.renderBackEnd.vulkan?100:0}),a.compileOptions);n.platformParams.targetPlatform="x64",n.platformParams.vsVersion=e.packages.windows.vsData||"",n.cMakeConfig.USE_SERVER_MODE=`set(USE_SERVER_MODE ${e.packages.native.serverMode?"ON":"OFF"})`;var r=Number(e.packages.native.netMode);n.cMakeConfig.NET_MODE=`set(NET_MODE ${isNaN(r)||2<r||r<0?0:r})`,e.buildScriptParam.flags.NET_MODE=isNaN(r)||2<r||r<0?0:r,n.cMakeConfig.NET_MODE=`set(NET_MODE ${isNaN(r)||2<r||r<0?0:r})`,n.executableName=executableNameOrDefault(n.projectName,e.packages.windows.executableName),n.cMakeConfig.CC_EXECUTABLE_NAME=`set(CC_EXECUTABLE_NAME "${n.executableName}")`,s&&Object.keys(s).forEach(e=>{n.cMakeConfig["CC_USE_"+e.toUpperCase()]=s[e]}),await(0,fs_extra_1.outputJSON)(a.paths.compileConfig,n,{spaces:2})}async function onAfterBundleInit(e){var a,t=e.packages.windows.renderBackEnd,t=(e.assetSerializeOptions["cc.EffectAsset"].glsl1=null==(a=t.gles2)||a,e.assetSerializeOptions["cc.EffectAsset"].glsl3=null==(a=t.gles3)||a,e.assetSerializeOptions["cc.EffectAsset"].glsl4=null==(a=t.vulkan)||a,Number(e.packages.native.netMode));e.buildScriptParam.flags.NET_MODE=isNaN(t)||2<t||t<0?0:t,e.buildScriptParam.flags.SERVER_MODE=!!e.packages.windows.serverMode,e.buildScriptParam.platform="WINDOWS"}function executableNameOrDefault(e,a){return a||(/^[0-9a-zA-Z_-]+$/.test(e)?e:(console.warn(`The provided project name "${e}" is not suitable for use as an executable name. 'CocosGame' is applied instead.`),"CocosGame"))}exports.onAfterInit=onAfterInit,exports.onAfterBundleInit=onAfterBundleInit;