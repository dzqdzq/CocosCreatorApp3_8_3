"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ready=exports.update=exports.$=exports.template=exports.style=void 0;const utils_1=require("./utils"),fs_1=require("fs"),path_1=require("path"),lodash=require("lodash");let panel;const defaultOptions={packageName:"",executableName:"",orientation:{portrait:!1,upsideDown:!1,landscapeRight:!0,landscapeLeft:!0},renderBackEnd:{metal:!0,gles3:!0,gles2:!1},osTarget:{iphoneos:!1,simulator:!0},developerTeam:"",targetVersion:"",skipUpdateXcodeProject:!1},methods=(exports.style=`
.developer-team-select,
.developer-team-input {
    margin-bottom: 5px;
}
`,{t(e,t){return Editor.I18n.t("ios."+e,t)},changeRenderBackEndType(e){var t=this,e=e.target.value;t.pkgOptions.renderBackEnd="metal"===e?{metal:!0,gles3:!1}:{metal:!1,gles3:!0},t.emitChange("renderBackEndType",t.pkgOptions.renderBackEnd)},async onChange(e){var t,a=this,p=e.target.value,e=e.target.getAttribute("path");e&&(lodash.set(a.pkgOptions,e,p),t=await(0,utils_1.verificationFunc)(e,a.pkgOptions[e],panel.options),a.pkgErrorMap[e]=t.error,a.emitChange(e,p,a.pkgErrorMap[e]))},emitChange(e,t,a){panel.dispatch("update",`packages.${panel.pkgName}.`+e,t,a)},init(){var e=this;e.pkgOptions=lodash.get(panel.options,"packages."+panel.options.platform)||{targetVersion:"12.0"};for(const a of Object.keys(defaultOptions)){var t=(0,utils_1.verificationFunc)(a,e.pkgOptions[a],panel.options);e.pkgErrorMap[a]=t.error}panel.dispatch("update","packages."+panel.pkgName,e.pkgOptions,e.pkgErrorMap)},developerTeamSelectChanged(e){var t=this,e=e.target.value;t.developerTeamSelect=e,t.pkgOptions.developerTeam="custom"===e?"":e,t.emitChange("developerTeam",t.pkgOptions.developerTeam)},async updateTeamInfo(){var e=this;e.teams=await Editor.Message.request("ios","query-team-info"),e.updateTeamList(e.teams)},updateTeamList(e){const t=this;e&&e.length?(t.developerTeamList=e.map(e=>({value:e.outputValue+"_"+e.hash,label:e.fullValue,error:e.errorState?"Error: "+e.errorState:""})),t.pkgOptions.developerTeam?t.developerTeamSelect=-1===t.developerTeamList.findIndex(e=>e.value===t.pkgOptions.developerTeam)?"custom":t.pkgOptions.developerTeam:"new"===t.type&&"custom"!==t.developerTeamSelect&&(e=t.developerTeamList.find(e=>!e.error),t.developerTeamSelect=t.pkgOptions.developerTeam=e?e.value:"",t.emitChange("developerTeam",t.pkgOptions.developerTeam))):t.developerTeamSelect="custom"}});async function mounted(){var e=this;e.dev=Editor.App.dev,e.pkgOptions=lodash.get(panel.options,"packages."+panel.options.platform)||{},e.pkgErrorMap={},"check"!==e.type&&(e.init(),e.updateTeamList(e.teams)),await e.updateTeamInfo()}function update(e,t){panel=this,t&&!t.startsWith("packages."+panel.pkgName)&&"packages.native.JobSystem"!==t||(panel.options=e,panel.vm.init())}function ready(e,t,a,p){panel=this;var o=BuildPanel.Vue;panel.options=e,panel.pkgName=a,panel.vm=new o({el:panel.$.root,data(){return{pkgOptions:defaultOptions,pkgErrorMap:defaultOptions,dev:!1,type:t,developerTeamList:[],developerTeamSelect:""}},mounted:mounted,methods:methods})}exports.template=(0,fs_1.readFileSync)((0,path_1.join)(__dirname,"../../static/view.html"),"utf8"),exports.$={root:".ios"},exports.update=update,exports.ready=ready;