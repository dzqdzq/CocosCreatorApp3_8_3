"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getCurrentString=exports.hasKey=exports.getString=exports.setCurrentLanguage=void 0;const path=require("path"),fs=require("fs"),cfgInfo=require("./strings"),DEFAULTLANGUAGE="en";let locale=null,curLangString=null,defaultLangString=null;function getEnvLocale(){var n={lang:"en"},e=process.env,e=e.LCALL||e.LCMESSAGES||e.LANG||e.LANGUAGE||Intl.DateTimeFormat().resolvedOptions().locale;return e?{lang:e.split(".")[0]||n.lang}:n}function getAvaiableLangs(){return cfgInfo?Object.keys(cfgInfo):[]}function getLangKey(n){n=n.split("_");return"zh"===n[0]?1===n.length||"cn"===n[1]?"zh":"zhTr":n[0]}function doInit(){locale=getEnvLocale(),curLangString=(curLangString=cfgInfo[getLangKey(locale.lang)])||cfgInfo[DEFAULTLANGUAGE],defaultLangString=cfgInfo[DEFAULTLANGUAGE]}function setCurrentLanguage(n){var e=getLangKey(n);n in cfgInfo?(curLangString=cfgInfo[n],locale.lang=n):e in cfgInfo?(curLangString=cfgInfo[e],locale.lang=e):console.warn()}function getString(r,...g){if(curLangString){var a=curLangString[r];if(!a)return`[KEY "${r}" is not found! lang: ${locale.lang}]`;if(0===g.length)return a;var o=Array.from(a),u=[],l=o.length;let n=0,e=0,t=0;for(;n<l;)"%"===o[n]?("d"!==o[n+1]&&"f"!==o[n+1]&&"s"!==o[n+1]&&"%"===o[n+1]?u.push("%"):(u.push(g[e++]+""),t++),n+=2):(u.push(o[n]),n+=1);return t!==g.length&&console.error(`format argument mismatch: ${a} & `+g.join(", ")),u.join("")}return`[language ${locale.lang} not set, key ${r}]`}function hasKey(n,e){return!!e&&n in e}function getCurrentString(n){let e;return hasKey(n,curLangString)?e=curLangString[n]:hasKey(n,defaultLangString)&&(e=defaultLangString[n]),e||n}doInit(),exports.setCurrentLanguage=setCurrentLanguage,exports.getString=getString,exports.hasKey=hasKey,exports.getCurrentString=getCurrentString;