"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const fs_1=require("fs"),path_1=require("path"),Vue=require("vue/dist/vue.js"),panelDataMap=(Vue.config.productionTip=!1,Vue.config.devtools=!1,new WeakMap),app_1=require("./app"),utils_build_1=require("../../public/utils-build");module.exports=Editor.Panel.define({template:'<div id="app"></div>',style:(0,fs_1.readFileSync)((0,path_1.join)(__dirname,"../../create.css"),"utf8"),$:{app:"#app"},async ready(e){var t=await Editor.Message.request("extension","get-extension-info-map"),a=await Editor.Profile.getTemp("extension",utils_build_1.TempProfileKeys.author)||"Cocos Creator",o=await Editor.Profile.getTemp("extension",utils_build_1.TempProfileKeys.showInManager),o=null===o||Boolean(o),i=await Editor.Profile.getTemp("extension",utils_build_1.TempProfileKeys.showInFolder),i=null===i||Boolean(i);const n=new Vue({extends:app_1.ExtensionCreation,propsData:{showInFolder:i,showInManager:o,author:a,preloadExtensionInfo:t}});function l(e){n&&n.onPluginEnable(e)}function r(e){n&&n.onPluginDisable(e)}(this.vm=n).$mount(this.$.app),e?.selectedTemplate&&({packageName:i,templatePath:o}=e.selectedTemplate,a=n.getAvailableTemplate(i,o))&&n.selectTemplate(i,a),n.loadAllCreatorModule({force:!0}),Editor.Package.__protected__.on("enable",l),Editor.Package.__protected__.on("disable",r),panelDataMap.set(this,{onExtensionDisable:r,onExtensionEnable:l,async releaseAllCreatorModule(){return n.unloadAllCreatorModule()}})},async close(){var e=panelDataMap.get(this);e&&(await e.releaseAllCreatorModule(),Editor.Package.__protected__.removeListener("enable",e.onExtensionEnable),Editor.Package.__protected__.removeListener("disable",e.onExtensionDisable)),panelDataMap.delete(this),this.vm?.$destroy(),delete this.vm}});