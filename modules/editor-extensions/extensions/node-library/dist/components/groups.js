"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.model=exports.methods=exports.mounted=exports.data=exports.components=exports.props=exports.template=exports.name=void 0;const fs_extra_1=require("fs-extra"),path_1=require("path"),panel_1=require("../panel"),MAX_NODE_ICON_SIZE=5242880;function data(){return{}}function mounted(){}exports.name="groups",exports.template=(0,fs_extra_1.readFileSync)((0,path_1.join)(__dirname,"../../static/template/groups.html"),"utf8"),exports.props=["groups","active"],exports.components={"group-items":require("./group-items")},exports.data=data,exports.mounted=mounted,exports.methods={onDeLete(o){this.groups.forEach(t=>{for(let e=0;e<t.items.length;e++)t.items[e].assetUuid===o.assetUuid&&t.items.splice(e,1)}),Editor.Profile.setConfig("node-library","custom",this.groups)},async onChangeIcon(t){var e,o=await Editor.Dialog.select({filters:[{name:"Images",extensions:["jpg","png"]}],multi:!1});o.canceled||(o=o.filePaths[0],(0,fs_extra_1.existsSync)(o)&&((await fs_extra_1.promises.stat(o)).size>MAX_NODE_ICON_SIZE?Editor.Dialog.error(Editor.I18n.t("node-library.ImageSmallerThen5mb")):(e=(0,path_1.basename)(o),e=(0,path_1.join)(Editor.App.home,"user-static","node-library",e),await(0,fs_extra_1.copy)(o,e),(o=await Editor.Profile.getConfig("node-library","custom")||panel_1.defaultCustomData)[0].items.find(e=>e.assetUuid===t.assetUuid).icon=e,this.$emit("change",o),Editor.Profile.setConfig("node-library","custom",o))))},async onRename(t){if(t.name.trim())for(const o of this.groups){if(o.items.find(e=>e.name===t.name))return void Editor.Dialog.warn(Editor.I18n.t("node-library.tips.customNodeExist"));var e=o.items.find(e=>e.assetUuid===t.assetUuid);e&&(e.name=t.name,Editor.Profile.setConfig("node-library","custom",this.groups))}else Editor.Dialog.warn(Editor.I18n.t("node-library.tips.notEmpty"))}},exports.model={prop:"groups",event:"change"};