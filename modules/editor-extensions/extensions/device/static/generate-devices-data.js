const xlsx=require("node-xlsx"),fse=require("fs-extra"),ps=require("path"),excelFilePath=ps.join(__dirname,"./test.xlsx"),sheets=xlsx.parse(excelFilePath),sheet=sheets[0];function collectDeviceData(){const c={devices:[],default:[]};sheet.data.forEach((e,s)=>{var t,a,i=e[4];!i||e[2]&&"删除"===e[2].trim()||0===s||(s=Number(e[5]),t=Number(e[6]),a=Number(e[7]),Number.isNaN(s)||Number.isNaN(t)||Number.isNaN(a)?console.log("Invalid data "+JSON.stringify(e)):(i={name:i,width:s,height:t,ratio:a},"是"===e[3]&&(i.default=!0,c.default.push(i.name)),c.devices.push(i)))}),fse.writeJsonSync(ps.join(__dirname,"devices.json"),c,{spaces:4}),console.log(`update devices(${c.devices.length}) success!`)}collectDeviceData();