"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.close=exports.beforeClose=exports.ready=exports.methods=exports.$=exports.template=exports.style=void 0;const fs_1=require("fs"),path_1=require("path"),Vue=require("vue/dist/vue.js");Vue.config.productionTip=!1,Vue.config.devtools=!1;let panel=null,vm=null;function ready(){panel=this,vm?.$destroy(),vm=new Vue({el:panel.$.container,components:{},directives:{},data:{isInit:!1,isBaking:!1,rate:0,logs:[],isStart:!1,isFinish:!1,isEnd:!1},async mounted(){this.sceneReady=await Editor.Message.request("scene","query-is-ready"),this.sceneReady&&await this.refresh()},updated(){this.scrollToBottom()},methods:{async refresh(){var e=await Editor.Message.request("scene","execute-scene-script",{name:"light-probe",method:"query",args:[]});e&&(this.isInit=!0,this.$refs.props.render(e),this.$refs.props.querySelector("ui-section").setAttribute("whole",""))},confirm(e){var e=e.target;e&&(e=e.dump)&&Editor.Message.send("scene","execute-scene-script",{name:"light-probe",method:"update",args:[e]})},async baking(){if(!this.clickedBake){this.clickedBake=!0,setTimeout(()=>{this.clickedBake=!1},1e3);try{var e,t;this.isBaking?Editor.Message.send("lightmap","cancelLightProbe"):(e=(0,path_1.join)(Editor.Project.path,"temp/light-probe"),(t=await Editor.Message.request("lightmap","getConfig")).path=e,Editor.Message.send("lightmap","bakeLightProbe",t),Editor.Metrics._trackEventWithTimer({category:"bakingSystem",id:"A100009",value:1}))}catch(e){console.error(e)}}},clear(){Editor.Message.send("scene","execute-scene-script",{name:"light-probe",method:"clear",args:[]})},async updateLog(){var e=await Editor.Message.request("light-probe","unstaging");this.rate=e.rate,this.logs=e.logs,this.isStart=e.isStart,this.isFinish=e.isFinish,this.isEnd=e.isEnd},scrollToBottom(){this.$nextTick(()=>{var e=this.$refs.logs;e&&e.scrollHeight-e.scrollTop!==e.clientHeight&&(e.scrollTop=e.scrollHeight)})}}})}async function beforeClose(){return Editor.Message.request("scene","execute-scene-script",{name:"light-probe",method:"beforeClose",args:[]})}function close(){vm?.$destroy(),vm=null,panel=null}exports.style=(0,fs_1.readFileSync)((0,path_1.join)(__dirname,"../dist/index.css"),"utf8"),exports.template=(0,fs_1.readFileSync)((0,path_1.join)(__dirname,"../static","/index.html"),"utf8"),exports.$={container:".container"},exports.methods={refresh(){vm&&vm.refresh()},start(){vm&&(vm.isBaking=!0,vm.updateLog())},cancel(){vm&&(vm.isBaking=!1,vm.updateLog())},log(){vm&&vm.updateLog()},progress(){vm&&vm.updateLog()},finished(){vm&&vm.updateLog()},end(){vm&&(vm.isBaking=!1,vm.updateLog())},clear(){vm&&vm.updateLog()}},exports.ready=ready,exports.beforeClose=beforeClose,exports.close=close;