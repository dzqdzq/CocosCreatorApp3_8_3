"use strict";const fs=require("fs"),join=require("path")["join"];let filesList=[];function convertTime(t){t=new Date(t);return t.getFullYear()+"-"+(t.getMonth()+1).toString().padStart(2,"0")+"-"+t.getDate().toString().padStart(2,"0")+" "+t.getHours().toString().padStart(2,"0")+":"+t.getMinutes().toString().padStart(2,"0")+":"+t.getSeconds().toString().padStart(2,"0")}async function readImageList(t,e=!1){e||(filesList=[]);e=fs.readdirSync(t);return await Promise.all(e.map(async e=>{var r=join(t,e),i=fs.statSync(r);if(i.isDirectory())readImageList(r,!0);else if(e.endsWith(".png")){var a=await Editor.Message.request("asset-db","query-url",r);let t=null;a&&(t=await Editor.Message.request("asset-db","query-uuid",a));a={path:r,filename:e,size:formatBytes(i.size),birthtime:convertTime(i.birthtime),uuid:t,mtime:convertTime(i.mtime)};filesList.push(a)}})),filesList}function formatBytes(t,e=2){var r;return 0===t?"0 Bytes":(e=e<0?0:e,r=Math.floor(Math.log(t)/Math.log(1024)),parseFloat((t/Math.pow(1024,r)).toFixed(e))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][r])}exports.formatBytes=formatBytes,exports.readImageList=readImageList;