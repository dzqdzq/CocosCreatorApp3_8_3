"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const Chroma=require("chroma-js");let isStart=!1,isFinish=!1,isEnd=!1,currProgress=0,bakerSum=20,progress=0,logInfos=[],currPath;function initVal(){currProgress=0,bakerSum=20,progress=0}function changeProgress(e=null,o=!0){e||((currProgress+=10)>=bakerSum-10&&(bakerSum+=10),e=currProgress/bakerSum*100,o&&(e/=2)),progress=e}const methods={async open(){await Editor.Profile.getConfig("lightmap","laboratory.bake_feature")?(isStart=!1,logInfos=[],Editor.Panel.open("lightmap.panel")):Editor.Dialog.warn(Editor.I18n.t("lightmap.openWarn"))},async start(){console.debug("Light map panel output info: start."),isStart=!0,isFinish=!1,isEnd=!1,(logInfos=[]).push("Baking started")},cancel(){isEnd=!0,initVal()},log(e){console.debug("Light map panel output info: log.",e),logInfos.push(e),isFinish&&changeProgress(null,!1)},progress(e){console.debug("Light map panel output info: progress.",e),logInfos.push(e),isFinish||changeProgress()},finished(){console.debug("Light map panel output info: finished."),isFinish=!0,isEnd=!1,logInfos.push("The baking is ready to complete and begin generating images."),changeProgress(50)},async end(){console.debug("light map panel output info: end."),isEnd=!0,logInfos.push("End of the baking."),logInfos.push(Editor.I18n.t("lightmap.end")),initVal()},async clear(){console.debug("Light map panel output info: clear."),logInfos=[],isStart=!1,isFinish=!1,isEnd=!1,initVal(),currPath=""},async unstaging(){return{progress:progress,logInfos:logInfos,currPath:currPath,isStart:isStart,isFinish:isFinish,isEnd:isEnd}},async savePicPath(e){currPath=Editor.Utils.Path.normalize(e)},async getConfig(){let e=await Editor.Profile.getConfig("lightmap","lightmap");return"string"==typeof(e=e||{msaa:4,path:"",size:1024,highp:!1,giScale:1,giSamples:25,giPathLength:4,aoLevel:0,aoStrength:.5,aoRadius:1,aoColor:[136,136,136,255],tab:0,r:!0,g:!0,b:!0,a:!1,filter:!0}).aoColor&&(e.aoColor=Chroma(e.aoColor).rgb()),e},bakeLightProbe(e){Editor.Message.send("scene","execute-scene-script",{name:"lightmap",method:"bakeLightProbe",args:[e,Editor.App.path]})},cancelLightProbe(){Editor.Message.send("scene","execute-scene-script",{name:"lightmap",method:"cancelLightProbe",args:[]})}};async function load(){}function unload(){}exports.load=load,exports.methods=methods,exports.unload=unload;