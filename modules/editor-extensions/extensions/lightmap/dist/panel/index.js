"use strict";var fs=require("fs"),ps=require("path"),Vue=require("vue"),image=require("../image-91ee442d.js");function _interopDefaultLegacy(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var Modes,fs__default=_interopDefaultLegacy(fs),Vue__default=_interopDefaultLegacy(Vue);Vue__default.default.config.productionTip=!1,Vue__default.default.config.devtools=!1;const Chroma=require("chroma-js");!function(e){e[e.SCENE=0]="SCENE",e[e.BAKED=1]="BAKED"}(Modes=Modes||{});var manager=Vue__default.default.extend({name:"App",data(){return{mode:Modes.SCENE,progress:0,logInfos:[],picInfos:[],selectInfo:null,isGenerate:!1,msaa:4,path:"",size:1024,highp:!1,giScale:1,giSamples:25,giPathLength:2,aoLevel:1,aoStrength:1,aoRadius:1,aoColor:[136,136,136,255],tab:0,r:!0,g:!0,b:!0,a:!1,sceneUUID:"",filter:!0}},computed:{channel(){return(this.r?"r":"")+(this.g?"g":"")+(this.b?"b":"")+(this.a?"a":"")||void 0}},async mounted(){var e=await Editor.Message.request("lightmap","unstaging");e.isStart&&!e.isEnd&&(this.isGenerate=!0,this.progress=e.progress),this.setLogs(e.logInfos)},methods:{async onSceneReady(e){this.sceneUUID=e;e=await image.Profile.getLatestLightmapResults(e);this.picInfos=(await Promise.all(e.map(e=>image.getImageInfo(e)))).filter(Boolean),this.$set(this.logInfos,"length",0),this.onItemClick(0)},changeColor(e){this.aoColor=e.target.value,this.saveEdit()},saveEdit(){Editor.Profile.setConfig("lightmap","lightmap",{msaa:this.msaa,size:this.size,highp:this.highp,giScale:this.giScale,giSamples:this.giSamples,giPathLength:this.giPathLength,aoLevel:this.aoLevel,aoStrength:this.aoStrength,aoRadius:this.aoRadius,aoColor:this.aoColor,filter:this.filter}),this.onItemClick(0)},t(e){return Editor.I18n.t("lightmap."+e)},clickTab(e,t){this[e]=t,"a"===e?t&&(this.r=this.g=this.b=!1):t&&(this.a=!1)},changeMode(e){this.mode=e},async onClear(){var e=await Editor.Message.request("lightmap","unstaging"),e=(this.sceneUUID=await Editor.Message.request("scene","query-current-scene"),e.currPath||await image.Profile.getLatestLightmapResultDir(this.sceneUUID));e&&!this.isGenerate&&(e=delDir(e),await image.Profile.setLatestLightmapResults(this.sceneUUID,[]),this.selectInfo=null,this.picInfos=[],this.logInfos=[],e)&&(await Editor.Message.request("scene","execute-scene-script",{name:"lightmap",method:"clear",args:[]}),await Editor.Message.request("lightmap","clear"),await Editor.Message.request("asset-db","refresh-asset","db://assets"))},async onCancel(){this.isGenerate=!1,this.logInfos=[],await Editor.Message.request("scene","execute-scene-script",{name:"lightmap",method:"cancel",args:[]})},async onBakerEnd(){this.isGenerate=!1;var e=await Editor.Message.request("lightmap","unstaging");this.picInfos=await image.readImageList(ps.join(e.currPath,"output")),this.saveEdit()},pushLog(e){this.logInfos.push(e)},setLogs(t){this.logInfos=[];for(let e=0;e<t.length;e++)this.logInfos.push(t[e])},onItemClick(e){if(this.picInfos[e]){this.selectInfo={};for(const t in this.picInfos[e])"path"!==t&&"uuid"!==t&&(this.selectInfo[t]=this.picInfos[e][t])}else this.selectInfo=null},async onConfirm(){this.r=this.g=this.b=!0,this.progress=0,this.logInfos=[];let e;var t=await image.Profile.getLatestLightmapResultDir(this.sceneUUID),t=(t&&(e=ps.join(t,"../")),await Editor.Dialog.select({type:"directory",title:this.t("title"),path:e||ps.join(Editor.Project.path,"assets"),multi:!1,filters:[{name:"Lightmap",extensions:["png"]}]}));let n=t.filePaths?t.filePaths[0]:[];if(!(n=Array.isArray(n)?n[0]:n))return!1;n+="/LightFX",this.path=n,await new Promise(e=>{setTimeout(e,500)}),await Editor.Message.request("lightmap","savePicPath",n),fs__default.default.existsSync(n)&&(delDir(n),await Editor.Message.request("asset-db","refresh-asset",n)),this.logInfos.push(this.t("start")+"\n"),this.isGenerate=!0;try{await Editor.Message.request("scene","execute-scene-script",{name:"lightmap",method:"apply",args:[this.$data,Editor.App.path]})}catch(e){console.error(e),await this.onCancel(),this.logInfos.push(this.t("fail")+"\n")}Editor.Metrics.trackEvent({sendToNewCocosAnalyticsOnly:!0,category:"bakingSystem",value:{A100003:1}})}}});function delDir(a,e=0){let i=!1;return fs__default.default.existsSync(a)&&fs__default.default.readdirSync(a).forEach((e,t)=>{var n=a+"/"+e;e.endsWith(".meta")||(i=fs__default.default.statSync(n).isDirectory()?(e=delDir(n,!0),i||e):(fs__default.default.unlinkSync(n),!0))}),i}function normalizeComponent(e,n,t,a,i,s,o,l,r,c){"boolean"!=typeof o&&(r=l,l=o,o=!1);var p="function"==typeof t?t.options:t;e&&e.render&&(p.render=e.render,p.staticRenderFns=e.staticRenderFns,p._compiled=!0,i)&&(p.functional=!0),a&&(p._scopeId=a);let u;if(s?(u=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),n&&n.call(this,r(e)),e&&e._registeredComponents&&e._registeredComponents.add(s)},p._ssrRegister=u):n&&(u=o?function(e){var t=this.$root.$el&&this.$root.$el.parentNode||this.$root.$options.el&&this.$root.$options.el.parentNode;n.call(this,c(e,t))}:function(e){n.call(this,l(e))}),u)if(p.functional){const h=p.render;p.render=function(e,t){return u.call(t),h(e,t)}}else{e=p.beforeCreate;p.beforeCreate=e?[].concat(e,u):[u]}return t}var normalizeComponent_1=normalizeComponent;const styles={},isOldIE="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());var styleInjector=function(e,s){return function(t,n){var a,i=isOldIE?n.media||"default":t,i=styles[i]||(styles[i]={ids:new Set,styles:[]});if(!i.ids.has(t)){i.ids.add(t);let e=n.source;n.map&&(e=(e+="\n/*# sourceURL="+n.map.sources[0]+" */")+"\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(n.map))))+" */"),i.element||(i.element=document.createElement("style"),i.element.type="text/css",n.media&&i.element.setAttribute("media",n.media),(s=void 0===s?document.shadowRoot||document.getElementsByTagName("shadowRoot")[0]:s).appendChild(i.element)),"styleSheet"in i.element?(i.styles.push(e),i.element.styleSheet.cssText=i.styles.filter(Boolean).join("\n")):(t=i.ids.size-1,n=document.createTextNode(e),(a=i.element.childNodes)[t]&&i.element.removeChild(a[t]),a.length?i.element.insertBefore(n,a[t]):i.element.appendChild(n))}}};const __vue_script__=manager;var __vue_render__=function(){var n=this,e=n.$createElement,a=n._self._c||e;return a("div",{staticClass:"lightmap"},[a("header",[a("ui-tab",{staticClass:"button_tab",attrs:{value:n.mode},on:{confirm:function(e){return n.changeMode(e.target.value)}}},[a("ui-button",[a("ui-label",{attrs:{value:"i18n:lightmap.tabScene"}})],1),n._v(" "),a("ui-button",[a("ui-label",{attrs:{value:"i18n:lightmap.tabBaked"}})],1)],1)],1),n._v(" "),a("section",{directives:[{name:"show",rawName:"v-show",value:0===n.mode,expression:"mode === 0"}]},[a("div",{staticClass:"properties"},[a("ui-prop",[a("ui-label",{attrs:{slot:"label",value:"i18n:lightmap.MSAA"},slot:"label"}),n._v(" "),a("ui-select",{attrs:{slot:"content",value:n.msaa},on:{confirm:function(e){e.stopPropagation(),n.msaa=e.target.value,n.saveEdit()}},slot:"content"},[a("option",{attrs:{value:"1"}},[n._v("\n                        1\n                    ")]),n._v(" "),a("option",{attrs:{value:"2"}},[n._v("\n                        2\n                    ")]),n._v(" "),a("option",{attrs:{value:"4"}},[n._v("\n                        4\n                    ")]),n._v(" "),a("option",{attrs:{value:"8"}},[n._v("\n                        8\n                    ")])])],1),n._v(" "),a("ui-prop",[a("ui-label",{attrs:{slot:"label",value:"i18n:lightmap.resolution"},slot:"label"}),n._v(" "),a("ui-select",{attrs:{slot:"content",value:n.size},on:{confirm:function(e){e.stopPropagation(),n.size=e.target.value,n.saveEdit()}},slot:"content"},[a("option",{attrs:{value:"128"}},[n._v("\n                        128\n                    ")]),n._v(" "),a("option",{attrs:{value:"256"}},[n._v("\n                        256\n                    ")]),n._v(" "),a("option",{attrs:{value:"512"}},[n._v("\n                        512\n                    ")]),n._v(" "),a("option",{attrs:{value:"1024"}},[n._v("\n                        1024\n                    ")]),n._v(" "),a("option",{attrs:{value:"2048"}},[n._v("\n                        2048\n                    ")])])],1),n._v(" "),a("ui-prop",[a("ui-label",{attrs:{slot:"label",tooltip:"i18n:lightmap.applyFilterTip",value:"i18n:lightmap.applyFilter"},slot:"label"}),n._v(" "),a("ui-checkbox",{attrs:{slot:"content",value:n.filter},on:{confirm:function(e){e.stopPropagation(),n.filter=e.target.value,n.saveEdit()}},slot:"content"})],1),n._v(" "),a("ui-prop",[a("ui-label",{attrs:{slot:"label",tooltip:"i18n:lightmap.highPrecisionTip",value:"i18n:lightmap.highPrecision"},slot:"label"}),n._v(" "),a("ui-checkbox",{attrs:{slot:"content",value:n.highp},on:{confirm:function(e){e.stopPropagation(),n.highp=e.target.value,n.saveEdit()}},slot:"content"})],1),n._v(" "),a("ui-prop",[a("ui-label",{attrs:{slot:"label",value:"i18n:lightmap.GIScale"},slot:"label"}),n._v(" "),a("ui-num-input",{attrs:{slot:"content",value:n.giScale,state:"",preci:"2",step:"0.1"},on:{confirm:function(e){e.stopPropagation(),n.giScale=e.target.value,n.saveEdit()}},slot:"content"})],1),n._v(" "),a("ui-prop",[a("ui-label",{attrs:{slot:"label",value:"i18n:lightmap.GISamples"},slot:"label"}),n._v(" "),a("ui-num-input",{attrs:{slot:"content",value:n.giSamples},on:{confirm:function(e){e.stopPropagation(),n.giSamples=e.target.value,n.saveEdit()}},slot:"content"})],1),n._v(" "),a("ui-prop",[a("ui-label",{attrs:{slot:"label",value:"i18n:lightmap.bounces"},slot:"label"}),n._v(" "),a("ui-select",{attrs:{slot:"content",value:n.giPathLength},on:{confirm:function(e){e.stopPropagation(),n.giPathLength=e.target.value,n.saveEdit()}},slot:"content"},[a("option",{attrs:{value:"1"}},[n._v("\n                        1\n                    ")]),n._v(" "),a("option",{attrs:{value:"2"}},[n._v("\n                        2\n                    ")]),n._v(" "),a("option",{attrs:{value:"3"}},[n._v("\n                        3\n                    ")]),n._v(" "),a("option",{attrs:{value:"4"}},[n._v("\n                        4\n                    ")])])],1),n._v(" "),a("ui-prop",[a("ui-label",{attrs:{slot:"label",value:"i18n:lightmap.AOLevel"},slot:"label"}),n._v(" "),a("ui-select",{attrs:{slot:"content",value:n.aoLevel},on:{confirm:function(e){e.stopPropagation(),n.aoLevel=e.target.value,n.saveEdit()}},slot:"content"},[a("option",{attrs:{value:"0"}},[n._v("\n                        0\n                    ")]),n._v(" "),a("option",{attrs:{value:"1"}},[n._v("\n                        1\n                    ")]),n._v(" "),a("option",{attrs:{value:"2"}},[n._v("\n                        2\n                    ")])])],1),n._v(" "),a("ui-prop",[a("ui-label",{attrs:{slot:"label",value:"i18n:lightmap.AOStrength"},slot:"label"}),n._v(" "),a("ui-num-input",{attrs:{slot:"content",value:n.aoStrength,state:"",preci:"2",step:"0.1"},on:{confirm:function(e){e.stopPropagation(),n.aoStrength=e.target.value,n.saveEdit()}},slot:"content"})],1),n._v(" "),a("ui-prop",[a("ui-label",{attrs:{slot:"label",value:"i18n:lightmap.AORadius"},slot:"label"}),n._v(" "),a("ui-num-input",{attrs:{slot:"content",value:n.aoRadius,state:"",preci:"2",step:"0.1"},on:{confirm:function(e){e.stopPropagation(),n.aoRadius=e.target.value,n.saveEdit()}},slot:"content"})],1),n._v(" "),a("ui-prop",[a("ui-label",{attrs:{slot:"label",value:"i18n:lightmap.AOColor"},slot:"label"}),n._v(" "),a("ui-color",{attrs:{slot:"content",value:JSON.stringify(n.aoColor)},on:{confirm:function(e){return e.stopPropagation(),n.changeColor(e)}},slot:"content"})],1)],1),n._v(" "),a("ui-button",{staticClass:"generate",class:n.isGenerate?"red":"blue",on:{click:function(e){n.isGenerate?n.onCancel():n.onConfirm()}}},[a("ui-label",{attrs:{value:n.isGenerate?"i18n:lightmap.cancel":"i18n:lightmap.generate"}})],1),n._v(" "),a("ui-progress",{directives:[{name:"show",rawName:"v-show",value:n.isGenerate,expression:"isGenerate"}],staticClass:"progress",attrs:{value:n.progress}}),n._v(" "),a("div",{staticClass:"output"},n._l(n.logInfos,function(e,t){return a("div",{key:t},[a("div",[n._v(n._s(e))])])}),0)],1),n._v(" "),a("section",{directives:[{name:"show",rawName:"v-show",value:1===n.mode,expression:"mode === 1"}]},[a("div",{staticClass:"properties result"},[a("ui-label",{attrs:{value:"i18n:lightmap.bakedResult"}}),n._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:0<n.picInfos.length,expression:"picInfos.length > 0"}],staticClass:"channels"},[a("ui-label",{class:{select:n.r},on:{click:function(e){return n.clickTab("r",!n.r)}}},[n._v("\n                    R\n                ")]),n._v(" "),a("ui-label",{class:{select:n.g},on:{click:function(e){return n.clickTab("g",!n.g)}}},[n._v("\n                    G\n                ")]),n._v(" "),a("ui-label",{class:{select:n.b},on:{click:function(e){return n.clickTab("b",!n.b)}}},[n._v("\n                    B\n                ")]),n._v(" "),a("ui-label",{class:{select:n.a},on:{click:function(e){return n.clickTab("a",!n.a)}}},[n._v("\n                    A\n                ")])],1),n._v(" "),a("div",{staticClass:"image-content"},n._l(n.picInfos,function(e,t){return a("ui-image",{key:t,ref:"images",refInFor:!0,attrs:{"show-alpha":"",channel:n.channel,value:e.path+"?"+e.birthtime},on:{click:function(e){return n.onItemClick(t)}}})}),1)],1),n._v(" "),a("ui-button",{staticClass:"blue clear",on:{click:function(e){return n.onClear()}}},[a("ui-label",{attrs:{value:"i18n:lightmap.clear"}})],1),n._v(" "),a("div",{staticClass:"output"},n._l(n.selectInfo,function(e,t){return a("div",{key:t},[a("ui-label",{staticClass:"label",attrs:{value:"i18n:lightmap."+t}}),n._v(" "),a("ui-label",{staticClass:"data",attrs:{value:e}})],1)}),0)],1)])},__vue_staticRenderFns__=[];__vue_render__._withStripped=!0;const __vue_inject_styles__=function(e){e&&e("data-v-3eea2815_0",{source:".lightmap[data-v-3eea2815] {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  overflow: auto;\n}\n.lightmap > header[data-v-3eea2815] {\n  margin-top: 8px;\n  text-align: center;\n}\n.lightmap section[data-v-3eea2815] {\n  flex: 1;\n  display: flex;\n  overflow: hidden;\n  flex-direction: column;\n  height: 100%;\n  min-height: 560px;\n}\n.lightmap section .properties[data-v-3eea2815] {\n  padding: 8px;\n}\n.lightmap section .properties ui-prop[data-v-3eea2815] {\n  margin-bottom: 6px;\n}\n.lightmap section .properties.result[data-v-3eea2815] {\n  width: 340px;\n  margin: auto;\n}\n.lightmap section .generate[data-v-3eea2815],\n.lightmap section .clear[data-v-3eea2815] {\n  margin: 14px auto;\n  min-width: 200px;\n}\n.lightmap section .progress[data-v-3eea2815] {\n  height: 6px;\n  margin: 10px 14px;\n  width: inherit;\n}\n.lightmap section .output[data-v-3eea2815] {\n  flex: 1;\n  min-height: 120px;\n  background-color: var(--color-normal-fill-emphasis);\n  overflow: auto;\n  margin: 0 14px 14px 14px;\n  padding: 7px 14px;\n  border-radius: 4px;\n}\n.lightmap section .output .label[data-v-3eea2815] {\n  width: 100px;\n  display: inline-block;\n}\n.lightmap section .output .data[data-v-3eea2815] {\n  display: inline-block;\n}\n.lightmap section .channels[data-v-3eea2815] {\n  min-height: 20px;\n  margin-top: 14px;\n  margin-bottom: 4px;\n  display: flex;\n  user-select: none;\n  justify-content: center;\n}\n.lightmap section .channels > ui-label[data-v-3eea2815] {\n  height: 20px;\n  width: 42px;\n  text-align: center;\n  line-height: 20px;\n  border: calc(var(--size-normal-border) * 1px) solid var(--color-normal-border);\n  background-color: var(--color-default-fill);\n  border-radius: calc(var(--size-normal-radius) * 1px);\n}\n.lightmap section .channels > ui-label[data-v-3eea2815]:nth-child(2) {\n  margin-left: 5px;\n  margin-right: 5px;\n}\n.lightmap section .channels > ui-label[data-v-3eea2815]:nth-child(3) {\n  margin-right: 5px;\n}\n.lightmap section .channels > ui-label.select[data-v-3eea2815] {\n  background-color: var(--color-default-fill-emphasis);\n}\n.lightmap section .image-content[data-v-3eea2815] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  height: 200px;\n  overflow: auto;\n}\n.lightmap section .image-content ui-image[data-v-3eea2815] {\n  width: 200px;\n  height: 200px;\n  background-color: var(--color-normal-fill-emphasis);\n}\n",map:{version:3,sources:["App.vue"],names:[],mappings:"AAAA;EACE,aAAa;EACb,sBAAsB;EACtB,YAAY;EACZ,cAAc;AAChB;AACA;EACE,eAAe;EACf,kBAAkB;AACpB;AACA;EACE,OAAO;EACP,aAAa;EACb,gBAAgB;EAChB,sBAAsB;EACtB,YAAY;EACZ,iBAAiB;AACnB;AACA;EACE,YAAY;AACd;AACA;EACE,kBAAkB;AACpB;AACA;EACE,YAAY;EACZ,YAAY;AACd;AACA;;EAEE,iBAAiB;EACjB,gBAAgB;AAClB;AACA;EACE,WAAW;EACX,iBAAiB;EACjB,cAAc;AAChB;AACA;EACE,OAAO;EACP,iBAAiB;EACjB,mDAAmD;EACnD,cAAc;EACd,wBAAwB;EACxB,iBAAiB;EACjB,kBAAkB;AACpB;AACA;EACE,YAAY;EACZ,qBAAqB;AACvB;AACA;EACE,qBAAqB;AACvB;AACA;EACE,gBAAgB;EAChB,gBAAgB;EAChB,kBAAkB;EAClB,aAAa;EACb,iBAAiB;EACjB,uBAAuB;AACzB;AACA;EACE,YAAY;EACZ,WAAW;EACX,kBAAkB;EAClB,iBAAiB;EACjB,8EAA8E;EAC9E,2CAA2C;EAC3C,oDAAoD;AACtD;AACA;EACE,gBAAgB;EAChB,iBAAiB;AACnB;AACA;EACE,iBAAiB;AACnB;AACA;EACE,oDAAoD;AACtD;AACA;EACE,aAAa;EACb,sBAAsB;EACtB,mBAAmB;EACnB,aAAa;EACb,cAAc;AAChB;AACA;EACE,YAAY;EACZ,aAAa;EACb,mDAAmD;AACrD",file:"App.vue",sourcesContent:[".lightmap {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  overflow: auto;\n}\n.lightmap > header {\n  margin-top: 8px;\n  text-align: center;\n}\n.lightmap section {\n  flex: 1;\n  display: flex;\n  overflow: hidden;\n  flex-direction: column;\n  height: 100%;\n  min-height: 560px;\n}\n.lightmap section .properties {\n  padding: 8px;\n}\n.lightmap section .properties ui-prop {\n  margin-bottom: 6px;\n}\n.lightmap section .properties.result {\n  width: 340px;\n  margin: auto;\n}\n.lightmap section .generate,\n.lightmap section .clear {\n  margin: 14px auto;\n  min-width: 200px;\n}\n.lightmap section .progress {\n  height: 6px;\n  margin: 10px 14px;\n  width: inherit;\n}\n.lightmap section .output {\n  flex: 1;\n  min-height: 120px;\n  background-color: var(--color-normal-fill-emphasis);\n  overflow: auto;\n  margin: 0 14px 14px 14px;\n  padding: 7px 14px;\n  border-radius: 4px;\n}\n.lightmap section .output .label {\n  width: 100px;\n  display: inline-block;\n}\n.lightmap section .output .data {\n  display: inline-block;\n}\n.lightmap section .channels {\n  min-height: 20px;\n  margin-top: 14px;\n  margin-bottom: 4px;\n  display: flex;\n  user-select: none;\n  justify-content: center;\n}\n.lightmap section .channels > ui-label {\n  height: 20px;\n  width: 42px;\n  text-align: center;\n  line-height: 20px;\n  border: calc(var(--size-normal-border) * 1px) solid var(--color-normal-border);\n  background-color: var(--color-default-fill);\n  border-radius: calc(var(--size-normal-radius) * 1px);\n}\n.lightmap section .channels > ui-label:nth-child(2) {\n  margin-left: 5px;\n  margin-right: 5px;\n}\n.lightmap section .channels > ui-label:nth-child(3) {\n  margin-right: 5px;\n}\n.lightmap section .channels > ui-label.select {\n  background-color: var(--color-default-fill-emphasis);\n}\n.lightmap section .image-content {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  height: 200px;\n  overflow: auto;\n}\n.lightmap section .image-content ui-image {\n  width: 200px;\n  height: 200px;\n  background-color: var(--color-normal-fill-emphasis);\n}\n"]},media:void 0})},__vue_scope_id__="data-v-3eea2815",__vue_module_identifier__=void 0,__vue_is_functional_template__=!1,__vue_component__=normalizeComponent_1({render:__vue_render__,staticRenderFns:__vue_staticRenderFns__},__vue_inject_styles__,__vue_script__,__vue_scope_id__,__vue_is_functional_template__,__vue_module_identifier__,!0,void 0,void 0,styleInjector);let $vm;async function applyLogsAndProgress(){var e=await Editor.Message.request("lightmap","unstaging");$vm.setLogs(e.logInfos),$vm.progress=e.progress}module.exports=Editor.Panel.define({template:'<div id="app"></div>',$:{app:"#app"},methods:{async start(){applyLogsAndProgress()},cancel(){},log(){applyLogsAndProgress()},progress(){applyLogsAndProgress()},finished(){applyLogsAndProgress()},async end(){applyLogsAndProgress(),$vm.progress=100,await $vm.onBakerEnd()},onSceneReady(e){$vm.onSceneReady(e)}},async ready(){var e=await Editor.Message.request("scene","query-current-scene"),t=(($vm=new __vue_component__({el:this.$.app})).onSceneReady(e),await Editor.Message.request("lightmap","getConfig"));if(t)for(const n in t)$vm.$data[n]=t[n]}});