"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.encode=exports.decode=void 0;const element_1=require("../../element"),htmlparser2_1=require("htmlparser2");function decode(e,t){if(t&&"inspector-root"!==t.tag)throw new Error("Not a legitimate root node");const c=new Map;var r=t||new element_1.VirtualElement("inspector-root");let i=r;var n=new htmlparser2_1.Parser({onopentag(t,e){var r=c.get(i)||0;c.set(i,r+1);let n;for(let e=r;e<i.children.length;e++)if(i.children[e].tag===t){(n=i.children[e]).attrs={},n.text="";break}n=n||new element_1.VirtualElement(t),i.insertChild(n,r),i=n;for(const o in e)i.setAttribute(o,e[o])},ontext(e){i.text+=e},onclosetag(e){i=i.getParent()}});return n.write(e),n.end(),t&&function e(t){var r=c.get(t)||0;t.children.length=r,t.children.forEach(e)}(t),r}function encode(e){let o="";return function t(e){for(const r of e){let e="";for(const n in r.attrs)e+=` ${n}="${r.attrs[n]}"`;o+=`<${r.tag.toLowerCase()}${e}>`,t(r.children),o+=`${r.text}</${r.tag.toLowerCase()}>`}}(e.children),o}exports.decode=decode,exports.encode=encode;