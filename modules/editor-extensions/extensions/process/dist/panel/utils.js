"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.closeProcessByPid=exports.openPanelDevTool=exports.queryProcessTree=exports.processNameMap=void 0;const electron_1=require("electron"),processManage_1=require("./processManage"),EXE_REG=(exports.processNameMap={},/^.*[\\\/]([^\\\/]+)\.exe.*$/i),formatProcessInfo=(e,o)=>(o[e.pid]||(o[e.pid]=[]),{detail:{pid:e.pid,ppid:e.ppid,name:e.name,cmd:e.cmd,memory:e.memory,cpu:e.cpu,panel:e.panel},showArrow:!!o[e.pid].length,children:o[e.pid]});async function queryProcessTree(e){var o={};let s=null;for(const n of"darwin"===process.platform?await processManage_1.macProcess.getProcessList(e):await processManage_1.windowProcess.getProcessList(e)){var r=formatProcessInfo(n,o);n.pid===e&&(s=r,EXE_REG.test(s.detail.name))&&(s.detail.name=s.detail.name.replace(EXE_REG,"$1")),o[n.ppid]?o[n.ppid].push(r):o[n.ppid]=[r]}return s}async function openPanelDevTool(o){var e=electron_1.BrowserWindow.getAllWindows().find(e=>e.webContents.getOSProcessId()===o);e&&e.webContents.openDevTools()}async function closeProcessByPid(o){var e=electron_1.BrowserWindow.getAllWindows().find(e=>e.webContents.getOSProcessId()===o);e&&e.close()}exports.queryProcessTree=queryProcessTree,exports.openPanelDevTool=openPanelDevTool,exports.closeProcessByPid=closeProcessByPid;