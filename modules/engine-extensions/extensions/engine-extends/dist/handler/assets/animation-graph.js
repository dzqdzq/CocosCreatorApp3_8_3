"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.migrateMotionStateSpeed=void 0;const cc_1=require("cc"),new_gen_anim_1=require("cc/editor/new-gen-anim"),_3_5_0_1=require("./migrates/animation-graph/3.5.0"),migration_utils_1=require("./utils/migration-utils"),fs_extra_1=require("fs-extra"),utils_1=require("../utils"),_3_8_0_1=require("./migrates/animation-graph/3.8.0"),AnimationGraphHandler={name:"animation-graph",assetType:cc_1.js.getClassName(new_gen_anim_1.AnimationGraph),open(e){Editor.Message.send("animation-graph","open",e.uuid)},createInfo:{generateMenuInfo(){return[{label:"i18n:ENGINE.assets.newAnimationGraph",fullFileName:"Animation Graph.animgraph",template:`db://internal/default_file_content/${AnimationGraphHandler.name}/default.animgraph`,group:"animation"},{label:"i18n:ENGINE.assets.newAnimationGraphTS",fullFileName:"AnimationGraphComponent.ts",template:`db://internal/default_file_content/${AnimationGraphHandler.name}/ts-animation-graph`,handler:"typescript",group:"animation"}]}},importer:{version:"1.2.0",async import(e){var a=await(0,fs_extra_1.readFile)(e.source,"utf8"),a=(await e.saveToLibrary(".json",a),(0,utils_1.getDependUUIDList)(a));return e.setData("depends",a),!0},migrationHook:migration_utils_1.migrationHook,migrations:[{version:"1.0.1",migrate:async e=>{var e=e.getSwapSpace(),a=new migration_utils_1.Archive(e.json),a=(migrateMotionStateSpeed(a),a.get());e.json=a}},{version:"1.1.0",migrate:async e=>{var e=e.getSwapSpace(),a=new migration_utils_1.Archive(e.json),a=((0,_3_5_0_1.migrateVariables)(a),a.get());e.json=a}},{version:"1.2.0",migrate:async e=>{var e=e.getSwapSpace(),a=new migration_utils_1.Archive(e.json),a=((0,_3_8_0_1.migrateAnimationGraph_3_8_0)(a),a.get());e.json=a}}]}};function migrateMotionStateSpeed(e){e.visitTypedObject("cc.animation.Motion",e=>{var a=e.speed.value;"number"==typeof a&&(e.speed=a)})}exports.default=AnimationGraphHandler,exports.migrateMotionStateSpeed=migrateMotionStateSpeed;