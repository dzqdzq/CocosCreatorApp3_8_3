"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const utils_1=require("../utils"),AudioHandler={name:"audio-clip",assetType:"cc.AudioClip",importer:{version:"1.0.0",async import(o){return o.userData.downloadMode=0,await o.copyToLibrary(o.extname,o.source),await new Promise((a,t)=>{const r=document.createElement("audio");r.addEventListener("loadedmetadata",async()=>{var e=createAudio(o,r.duration),e=EditorExtends.serialize(e),e=(await o.saveToLibrary(".json",e),(0,utils_1.getDependUUIDList)(e));o.setData("depends",e),a()}),r.addEventListener("error",e=>{t(e)});try{var e=o.source.split(/\\|\//).map(e=>encodeURIComponent(e)).join("/").replace("%3A",":");r.src=e}catch(e){t(e)}}),!0}}};function createAudio(e,a){var t=new cc.AudioClip;return t._loadMode=e.userData.downloadMode,t._duration=a,t.name=e.basename,t._setRawAsset(e.extname),t}exports.default=AudioHandler;