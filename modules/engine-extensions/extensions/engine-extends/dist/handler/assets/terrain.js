"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(e,r,t,a){void 0===a&&(a=t);var n=Object.getOwnPropertyDescriptor(r,t);n&&("get"in n?r.__esModule:!n.writable&&!n.configurable)||(n={enumerable:!0,get:function(){return r[t]}}),Object.defineProperty(e,a,n)}:function(e,r,t,a){e[a=void 0===a?t:a]=r[t]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,r){Object.defineProperty(e,"default",{enumerable:!0,value:r})}:function(e,r){e.default=r}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)"default"!==t&&Object.prototype.hasOwnProperty.call(e,t)&&__createBinding(r,e,t);return __setModuleDefault(r,e),r};Object.defineProperty(exports,"__esModule",{value:!0}),exports.TerrainHandler=void 0;const fs=__importStar(require("fs-extra")),index_1=require("./scene/index"),cc_1=require("cc"),utils_1=require("../utils");exports.TerrainHandler={name:"terrain",assetType:"cc.TerrainAsset",createInfo:{generateMenuInfo(){return[{label:"i18n:ENGINE.assets.newTerrain",fullFileName:"terrain.terrain",template:`db://internal/default_file_content/${exports.TerrainHandler.name}/default.terrain`}]}},importer:{version:index_1.version,async import(e){await e.copyToLibrary(".bin",e.source);var r=new cc_1.TerrainAsset;if(r._loadNativeData(fs.readFileSync(e.source))){r.layerInfos.length=r.layerBinaryInfos.length;for(let e=0;e<r.layerInfos.length;++e){var t=r.layerBinaryInfos[e],a=new cc_1.TerrainLayerInfo;a.slot=t.slot,a.tileSize=t.tileSize,t.detailMapId&&""!=t.detailMapId&&(a.detailMap=EditorExtends.serialize.asAsset(t.detailMapId,cc_1.Texture2D)),t.normalMapId&&""!=t.normalMapId&&(a.normalMap=EditorExtends.serialize.asAsset(t.normalMapId,cc_1.Texture2D)),a.metallic=t.metallic,a.roughness=t.roughness,r.layerInfos[e]=a}}r.name=e.basename,r._setRawAsset(".bin");var n=EditorExtends.serialize(r),n=(await e.saveToLibrary(".json",n),(0,utils_1.getDependUUIDList)(n));return e.setData("depends",n),!0}}},exports.default=exports.TerrainHandler;