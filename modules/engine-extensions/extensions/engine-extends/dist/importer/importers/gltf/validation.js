"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.validateGlTf=void 0;const fs_1=__importDefault(require("fs")),gltf_validator_1=require("gltf-validator");async function validateGlTf(e,s){var t={uri:e,ignoredIssues:[],severityOverrides:{NON_RELATIVE_URI:2,UNDECLARED_EXTENSION:1,ACCESSOR_TOTAL_OFFSET_ALIGNMENT:2}};const i=await(e.endsWith(".glb")?gltf_validator_1.validateBytes(fs_1.default.readFileSync(e),t):gltf_validator_1.validateString(fs_1.default.readFileSync(e).toString()));for(const r of i.issues.messages.filter(e=>!("VALUE_NOT_IN_RANGE"!==e.code||!/\/accessors\/\d+\/count/.test(e.pointer)||"Value 0 is out of range."!==e.message)||!("ROTATION_NON_UNIT"!==e.code||!/\/nodes\/\d+\/rotation/.test(e.pointer)))){switch(r.severity){case 0:--i.issues.numErrors;break;case 1:--i.issues.numInfos}console.debug(`glTf-validator issue(from ${s}) ${JSON.stringify(r)} is ignored.`),i.issues.messages.splice(i.issues.messages.indexOf(r),1)}t=s=>JSON.stringify(i.issues.messages.filter(e=>e.severity===s),void 0,2);0!==i.issues.numErrors?console.debug(`File ${s} contains errors, `+"this may cause problem unexpectly, please fix them: \n"+t(0)+`
`):0!==i.issues.numWarnings?console.debug(`File ${s} contains warnings, `+"the result may be not what you want, please fix them if possible: \n"+t(1)+`
`):0===i.issues.numHints&&0===i.issues.numInfos||console.debug(`Logs from ${s}:`+"\n"+t(2)+`
`)}exports.validateGlTf=validateGlTf;