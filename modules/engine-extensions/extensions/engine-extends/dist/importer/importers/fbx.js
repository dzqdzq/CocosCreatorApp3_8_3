"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.FbxImporter=void 0;const gltf_1=__importDefault(require("./gltf")),fbx_to_gltf_1=require("./gltf/fbx-to-gltf"),fbx_converter_1=require("./utils/fbx-converter"),model_convert_routine_1=require("./utils/model-convert-routine");class FbxImporter extends gltf_1.default{get version(){return super.version}get name(){return"fbx"}async getGltfFilePath(e){var t=e.userData;void 0===(null==(i=t.fbx)?void 0:i.smartMaterialEnabled)&&((null!=(i=t.fbx)?i:t.fbx={}).smartMaterialEnabled=await Editor.Profile.getProject("project","fbx.material.smart"));let r;if(t.legacyFbxImporter)r=await fbx_to_gltf_1.fbxToGlTf(e,this.assetDB,this.version);else{var i={},o=(i.unitConversion=null==(o=t.fbx)?void 0:o.unitConversion,i.animationBakeRate=null==(o=t.fbx)?void 0:o.animationBakeRate,i.preferLocalTimeSpan=null==(o=t.fbx)?void 0:o.preferLocalTimeSpan,i.smartMaterialEnabled=null!=(o=null==(o=t.fbx)?void 0:o.smartMaterialEnabled)&&o,i.matchMeshNames=null==(o=null==(o=t.fbx)?void 0:o.matchMeshNames)||o,fbx_converter_1.createFbxConverter(i)),i=await model_convert_routine_1.modelConvertRoutine("fbx.FBX-glTF-conv",e,this.assetDB,this.version,o);if(!i)throw new Error("Failed to import "+e.source);r=i}return t.meshOptimizer&&t.meshOptimizer.enable?this.getOptimizerPath(e,r,t.meshOptimizer):r}}exports.FbxImporter=FbxImporter;