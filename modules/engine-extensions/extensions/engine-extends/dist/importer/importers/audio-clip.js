"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AudioImporter=void 0;const asset_db_1=require("@editor/asset-db"),utils_1=require("../utils");class AudioImporter extends asset_db_1.Importer{get version(){return"1.0.0"}get name(){return"audio-clip"}get assetType(){return"cc.AudioClip"}async import(o){return o.userData.downloadMode=0,await o.copyToLibrary(o.extname,o.source),await new Promise((t,r)=>{const a=document.createElement("audio");a.addEventListener("loadedmetadata",async()=>{var e=this.createAudio(o,a.duration),e=EditorExtends.serialize(e),e=(await o.saveToLibrary(".json",e),utils_1.getDependUUIDList(e));o.setData("depends",e),t()}),a.addEventListener("error",e=>{r(e)});try{var e=o.source.split(/\\|\//).map(e=>encodeURIComponent(e)).join("/").replace("%3A",":");a.src=e}catch(e){r(e)}}),!0}createAudio(e,t){var r=new cc.AudioClip;return r._loadMode=e.userData.downloadMode,r._duration=t,r.name=e.basename,r._setRawAsset(e.extname),r}}exports.AudioImporter=AudioImporter;