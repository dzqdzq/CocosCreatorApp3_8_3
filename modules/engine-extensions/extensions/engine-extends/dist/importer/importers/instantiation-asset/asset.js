"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.zip=void 0;const asset_db_1=require("@editor/asset-db"),fs_extra_1=require("fs-extra"),path_1=require("path");class AssetImporter extends asset_db_1.Importer{get version(){return"1.0.0"}get name(){return"instantiation-asset"}get assetType(){return"cc.Asset"}async import(t){var r=path_1.join(t._assetDB.options.temp,t.uuid),e="darwin"===process.platform?"unzip":path_1.join(Editor.App.path,"../tools/unzip.exe"),s=(await Editor.Utils.Process.quickSpawn(e,[t.source,"-d",r]),fs_extra_1.readdirSync(r));for(let e=0;e<s.length;e++){var a=s[e],i=path_1.join(r,a);await t.copyToLibrary("."+a,i)}return fs_extra_1.existsSync(r)&&fs_extra_1.removeSync(r),!0}}function zip(e,t){var r=require("archiver"),e=fs_extra_1.createWriteStream(e);const s=r("zip");s.on("error",e=>{throw e}),s.pipe(e),t.forEach(e=>{var t=path_1.parse(e);s.append(fs_extra_1.createReadStream(e),{name:t.ext.substr(1)})}),s.finalize()}exports.default=AssetImporter,exports.zip=zip;