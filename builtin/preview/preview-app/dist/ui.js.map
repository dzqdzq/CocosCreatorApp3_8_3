{"version":3,"file":"ui.js","sourceRoot":"","sources":["../src/ui.ts"],"names":[],"mappings":"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","sourcesContent":["import { bootstrap } from './index.js';\nimport type { ISplashSetting } from '../../../builder/@types/public/options';\n\ninterface ErrorInfo {\n    message: string;\n    stack?: string;\n}\n\nexport type UIConfiguration = ISplashSetting & { width: number; height: number };\n\nconst userAgentRE =\n    /(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i;\n// FIXME: 看不懂是干嘛的\nconst navigatorVendorRE =\n    /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i;\n\nexport class Ui {\n    constructor(options: Ui.Options) {\n        this._devices = options.devices;\n        this._emit = options.emit;\n        this._checkMobile();\n\n        this._query = document.querySelector.bind(document);\n        this._canvas = this._queryChecked('#GameCanvas');\n        this._toolbar = this._queryChecked('.toolbar');\n        // this._footer = this._queryChecked('.footer');\n        this._viewSelect = this._queryChecked('#view-select');\n        this._viewSelectValue = this._viewSelect.querySelector('#name') as HTMLElement;\n        this._optsDebugMode = this._queryChecked('#opts-debug-mode');\n        this._rotateButton = this._queryChecked('#btn-rotate');\n        this._pauseButton = this._queryChecked('#btn-pause');\n        this._stepButton = this._queryChecked('#btn-step');\n        this._stepLengthWrap = this._queryChecked('#step-length');\n        this._stepLength = this._stepLengthWrap.querySelector('input')!;\n        this._showFpsButton = this._queryChecked('#btn-show-fps');\n        this._setFpsInput = this._queryChecked('#input-set-fps');\n        this._splash = this._queryChecked('#splash');\n        this._progressBar = this._queryChecked('#splash .progress-bar span');\n\n        // ??\n        // select 标签的初始化\n        let value = this._viewSelect.getAttribute('value') || 'Default';\n        // 设备初始值容错\n        if (!this._devices[value]) {\n            value = 'Default';\n        }\n        // 网页全屏处理初始数据\n        if (value === 'WebpageFullScreen') {\n            this._devices[value].width = window.innerWidth;\n            this._devices[value].height = window.innerHeight;\n            this._viewSelectValue.innerText = this._devices[value].name;\n        } else {\n            const width = this._devices[value].width || 960;\n            const height = this._devices[value].height || 640;\n            this._viewSelectValue.innerText = `${this._devices[value].name} (${width}X${height})`;\n        }\n        // 网页全屏时监听 hover 来控制菜单来是否显示，在构造函数中绑定函数，避免使用 bind(this) 移除时绑定的函数不同而移除失败\n        this.handleContentMouseMove = this.handleContentMouseMove.bind(this);\n        this._optsDebugMode.value = this._optsDebugMode.getAttribute('value')!;\n        this._rotated = this._rotateButton.className === 'checked';\n    }\n\n    get gameCanvas() {\n        return this._canvas;\n    }\n\n    get showFps() {\n        return this._showFpsButton.className === 'checked';\n    }\n\n    get isShowError() {\n        return this.debugMode !== 'NONE';\n    }\n\n    get debugMode() {\n        return this._optsDebugMode.value;\n    }\n\n    get frameRate() {\n        return parseInt(this._setFpsInput.value, 10);\n    }\n\n    private _errorInfo: ErrorInfo | null = null;\n\n    /**\n     * Get layout size and show loading.\n     */\n    public showLoading() {\n        if (this._errorInfo) {\n            return;\n        }\n\n        this._splash.style.visibility = 'visible';\n        const { width, height } = this._getEmulatedScreenSize();\n        if (width < height) {\n            this._splash.className += ' portrait';\n        }\n    }\n\n    public setWindowSize(cc: any) {\n        const dpr = window.devicePixelRatio;\n        if (!this.isFullscreen()) {\n            const sizeInCssPixels = this._getEmulatedScreenSize();\n            cc.screen.windowSize = new cc.Size(sizeInCssPixels.width * dpr, sizeInCssPixels.height * dpr);\n        }\n    }\n\n    private _updateToolBarVisibility() {\n        //  全屏和网页全屏时隐藏菜单栏\n        if (this.isFullscreen() || this._viewSelect.getAttribute('value') === 'WebpageFullScreen') {\n            toggleElementClass(this._toolbar, 'hide', true);\n            // toggleElementClass(this._footer, 'hide', true);\n        } else {\n            toggleElementClass(this._toolbar, 'hide', false);\n            // toggleElementClass(this._footer, 'hide', false);\n        }\n    }\n\n    /**\n     * @param message 显示加载错误\n     */\n    public showError(error: Error | ErrorEvent | PromiseRejectionEvent) {\n        // @ts-ignore\n        if (!window.__errorTools) {\n            return;\n        }\n        // @ts-ignore\n        const { showError, transToErrorInfo } = window.__errorTools;\n        const errorInfo = transToErrorInfo(error);\n        const message = '[Browser Preview]' + errorInfo.message + (errorInfo.stack ? '/n' + errorInfo.stack : '');\n        this._emit('preview error', message);\n        this._errorInfo = errorInfo;\n        // 添加容错，允许用户去掉 error-main 标签屏蔽错误遮罩\n        if (!this.isShowError) {\n            return;\n        }\n        showError(errorInfo, message);\n    }\n\n    public hideSplash() {\n        if (this._splash) {\n            this._splash.style.display = 'none';\n        }\n    }\n\n    public hintEmptyScene() {\n        this._queryChecked<HTMLElement>('#bulletin').style.display = 'block';\n        this._queryChecked<HTMLElement>('#sceneIsEmpty').style.display = 'block';\n    }\n\n    public bindEngine(cc: any) {\n        let pausedByMe = false;\n\n        const toggleOnPauseOrResumed = () => {\n            toggleElementClass(this._pauseButton, 'checked');\n            toggleElementClass(this._stepButton, 'show');\n            this._stepLength.value = cc.game.frameTime;\n            toggleElementClass(this._stepLengthWrap, 'show');\n        };\n\n        // To react on `game.pause()` invocation from anywhere else,\n        // We do inspect \"actual\" pausing state at frame end to align with our UI.\n        cc.director.on(cc.Director.EVENT_END_FRAME, () => {\n            const paused = cc.game.isPaused();\n            if (pausedByMe !== paused) {\n                // Actual pausing state does not match with what we recorded.\n                pausedByMe = paused;\n                toggleOnPauseOrResumed();\n            }\n        });\n\n        let resizeTimer: number;\n        window.addEventListener('resize', () => {\n            this._updateToolBarVisibility();\n            // 窗口改变时处理网页全屏\n            clearTimeout(resizeTimer);\n            resizeTimer = setTimeout(() => {\n                const device = this._viewSelect.getAttribute('value');\n                if (device === 'FullScreen') {\n                    this.setWindowSize(cc);\n                }\n            }, 500);\n        });\n        this._rotateButton.addEventListener('click', () => {\n            this._rotated = !this._rotated;\n            toggleElementClass(this._rotateButton, 'checked');\n            this.setWindowSize(cc);\n            window.dispatchEvent(new Event('orientationchange'));\n            this._emit('changeOption', 'rotate', this._rotated);\n        });\n\n        const $select = this._viewSelect.querySelector('.view-select');\n        const $options = this._viewSelect.querySelector('.options');\n        const $ul = this._viewSelect.querySelector('.options > ul');\n        $select?.addEventListener('click', (e: any) => {\n            e.stopPropagation();\n            if ($options?.hasAttribute('open')) {\n                $options.removeAttribute('open');\n            } else {\n                $options?.setAttribute('open', '');\n            }\n        });\n        document.addEventListener('click', (e: any) => {\n            e.stopPropagation();\n            if ($options?.hasAttribute('open')) {\n                $options?.removeAttribute('open');\n            }\n        });\n        // 退出全屏模式\n        document.addEventListener('fullscreenchange', () => {\n            if (!document.fullscreenElement) {\n                this.setWindowSize(cc);\n                window.dispatchEvent(new Event('resize'));\n            }\n        });\n        $ul?.addEventListener('click', (e: any) => {\n            const target = e.target;\n            if (target?.tagName.toLowerCase() === 'li' && target.dataset.device) {\n                const value = target.dataset.device;\n                if (value === 'FullScreen') {\n                    document.fullscreenEnabled && !document.fullscreenElement && cc.screen.requestFullScreen();\n                } else {\n                    this._viewSelect.setAttribute('value', value);\n                    if (value === 'WebpageFullScreen') {\n                        this._devices[value].width = window.innerWidth;\n                        this._devices[value].height = window.innerHeight;\n                        this._viewSelectValue.innerText = this._devices[value].name;\n\n                        // 鼠标 hover 后展示菜单栏\n                        if (!this._isAddContentListener) {\n                            this._canvas.addEventListener('mousemove', this.handleContentMouseMove);\n                            this._isAddContentListener = true;\n                        }\n                    } else {\n                        const width = (this._devices[value] && this._devices[value].width) || 960;\n                        const height = (this._devices[value] && this._devices[value].height) || 640;\n                        this._viewSelectValue.innerText = `${this._devices[value].name} (${width}X${height})`;\n\n                        if (this._isAddContentListener) {\n                            this._canvas.removeEventListener('mousemove', this.handleContentMouseMove);\n                            this._isAddContentListener = false;\n                        }\n                    }\n    \n                    this.setWindowSize(cc);\n                    window.dispatchEvent(new Event('resize'));\n                    this._emit('changeOption', 'device', value);\n    \n                    changeSelectedClass($ul, target, 'selected');\n                }\n            }\n            $options?.removeAttribute('open');\n        });\n\n        // init show fps, true by default\n        this._showFpsButton.addEventListener('click', () => {\n            const show = !cc.isDisplayStats();\n            cc.setDisplayStats(show);\n            toggleElementClass(this._showFpsButton, 'checked');\n            this._emit('changeOption', 'showFps', show);\n        });\n\n        // init pause button\n        this._pauseButton.addEventListener('click', () => {\n            const shouldPause = !cc.game.isPaused();\n            if (shouldPause) {\n                cc.game.pause();\n            } else {\n                cc.game.resume();\n            }\n            pausedByMe = !pausedByMe;\n            toggleOnPauseOrResumed();\n        });\n\n        // Debug mode.\n        this._optsDebugMode.addEventListener('change', (event) => {\n            // @ts-ignore\n            const value = event!.target!.value;\n            const debugMode = cc.DebugMode[value] ?? cc.DebugMode.INFO;\n            if (debugMode === cc.DebugMode.NONE || !this._errorInfo) {\n                this._queryChecked<HTMLElement>('#error').style.display = 'none';\n            } else {\n                this._queryChecked<HTMLElement>('#error').style.display = 'block';\n            }\n            // @ts-ignore\n            window.cc.debug._resetDebugSetting(debugMode);\n            this._emit('changeOption', 'debugMode', value);\n        });\n\n        // Set FPS.\n        this._setFpsInput.addEventListener('change', (event) => {\n            let fps = parseInt(this._setFpsInput.value, 10);\n            if (isNaN(fps)) {\n                fps = 60;\n                this._setFpsInput.value = fps.toString();\n            }\n            cc.game.setFrameRate(fps);\n        });\n\n        // Set step length.\n        this._stepLength.addEventListener('change', (event: any) => {\n            const stepLen = parseInt(event.target.value, 10);\n            if (isNaN(stepLen)) {\n                event.target.value = cc.game.frameTime;\n                return;\n            }\n            cc.game.frameTime = stepLen;\n        });\n\n        // 鼠标hover后展示菜单栏\n        if (this._viewSelect.getAttribute('value') === 'WebpageFullScreen' && !this._isAddContentListener) {\n            this._canvas.addEventListener('mousemove', this.handleContentMouseMove);\n            this._isAddContentListener = true;\n        }\n        // When click step button, game is stepped.\n        this._stepButton.addEventListener('click', () => {\n            cc.game.step();\n        });\n        // enable toolbar\n        toggleElementClass(this._toolbar, 'disabled', false);\n\n        // 初始化引擎\n        this.setWindowSize(cc);\n        this._updateToolBarVisibility();\n    }\n\n    private handleContentMouseMove(event: MouseEvent) {\n        const contentRect = this._canvas.getBoundingClientRect();\n        if (event.clientY <= contentRect.top + 50 && event.clientY >= contentRect.top) {\n            toggleElementClass(this._toolbar, 'hide', false);\n        } else {\n            toggleElementClass(this._toolbar, 'hide', true);\n        }\n    }\n\n    /**\n     * @param progress 进度值，[0, 100]\n     */\n    public reportLoadProgress(progress: number) {\n        this._progressBar.style.width = progress.toFixed(2) + '%';\n    }\n\n    private _queryChecked<E extends Element = Element>(selectors: string): E {\n        const element = this._query<E>(selectors);\n        if (!element) {\n            throw new Error(`UI element ${selectors} doesn't exist.`);\n        } else {\n            return element;\n        }\n    }\n\n    /**\n     * 获取当前设备 size\n     */\n    public getRotatedCurrentSize() {\n        // 当前分辨率为非自定义\n        const value = this._viewSelect.getAttribute('value') || 'Default';\n        const width = (this._devices[value] && this._devices[value].width) || 960;\n        const height = (this._devices[value] && this._devices[value].height) || 640;\n        return this._rotated ? { height: width, width: height } : { width, height };\n    }\n\n    /**\n     * Get emulated screen size.\n     * Return the size in css pixels.\n     */\n    private _getEmulatedScreenSize() {\n        if (this.isFullscreen()) {\n            const { width, height } = screen;\n            return this._rotated ? { height: width, width: height } : { width, height };\n        }\n        return this.getRotatedCurrentSize();\n    }\n\n    public isFullscreen() {\n        if (this._isMobile) {\n            return true;\n        }\n        return !!document.fullscreenElement;\n    }\n\n    private _checkMobile() {\n        // @ts-ignore\n        const nav = navigator.userAgent || navigator.vendor || window.opera;\n        if (userAgentRE.test(nav) || navigatorVendorRE.test(nav.substr(0, 4))) {\n            this._isMobile = true;\n        } else {\n            this._isMobile = false;\n        }\n    }\n\n    private _query: Query;\n    private _toolbar: HTMLElement;\n    private _canvas: HTMLCanvasElement;\n    // private _footer: HTMLElement;\n    private _viewSelect: HTMLSelectElement;\n    private _viewSelectValue: HTMLElement;\n    private _optsDebugMode: HTMLSelectElement;\n    private _rotateButton: HTMLButtonElement;\n    private _pauseButton: HTMLButtonElement;\n    private _stepButton: HTMLButtonElement;\n    private _stepLengthWrap: HTMLDivElement;\n    private _stepLength: HTMLInputElement;\n    private _showFpsButton: HTMLButtonElement;\n    private _setFpsInput: HTMLInputElement;\n    private _progressBar: HTMLDivElement;\n    private _splash: HTMLElement;\n    private _gameContainer?: HTMLElement;\n    private _rotated: boolean;\n    private _devices: Ui.Options['devices'];\n    private _emit: Ui.Options['emit'];\n    private _isMobile = false;\n    private _isAddContentListener = false;\n}\n\nexport declare namespace Ui {\n    export interface Options {\n        devices: bootstrap.Options['devices'];\n        emit(event: string, ...args: any[]): void;\n    }\n}\n\ntype Query = {\n    <K extends keyof HTMLElementTagNameMap>(selectors: K): HTMLElementTagNameMap[K] | null;\n    <K extends keyof SVGElementTagNameMap>(selectors: K): SVGElementTagNameMap[K] | null;\n    <E extends Element = Element>(selectors: string): E | null;\n};\n\nfunction toggleElementClass(element: HTMLElement, className: string, add?: boolean) {\n    const isAdd = add === undefined ? !element.classList.contains(className) : add;\n    if (isAdd) {\n        element.classList.add(className);\n    } else {\n        element.classList.remove(className);\n    }\n}\n\nfunction changeSelectedClass(element: Element, target: Element, className: string) {\n    const lis = element.querySelectorAll('li');\n    for (let i = 0; i < lis.length; i++) {\n        if (lis[i].classList.contains(className)) {\n            lis[i].classList.remove(className);\n        }\n    }\n    target.classList.add(className);\n}\n"]}