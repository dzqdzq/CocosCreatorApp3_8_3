"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.syncAxisY=exports.syncAxisX=exports.gridCtrl=void 0;const utils_1=require("../utils"),grid_1=require("../vm/grid");class GridCtrl{constructor(){this._gridCanvas=null,this._grid=null,this.startOffset=10,this.$left=null,this.$right=null}get grid(){return this._grid}get gridCanvas(){return this._gridCanvas}get scale(){return this.grid?.xAxisScale??100}init(t){var{$canvas:i,$left:e,$right:r,$xAxis:s,showType:a}=t,e=(i.width=r.offsetWidth,i.height=r.offsetHeight,this._gridCanvas=i,this.$left=e,this.$right=r,i.getContext("2d"));this._grid=new grid_1.Grid({context:e,lineWidth:.5,showType:a||"time",color:"#333846",axis:{container:{x:s},startOffset:this.startOffset,lods:[10,2],minScale:t.minScale||1,maxScale:t.maxScale||50,sample:60},hformat:utils_1.transFrameByTypeInGrid}),this._grid.xAxisScaleAt(this.$left.offsetWidth,20)}getFrameRang(){var t;return this.grid&&this.gridCanvas?(t=this.gridCanvas.width,{start:Math.ceil(this.grid.pixelToValueH(this.startOffset+this.grid.xAxisScale/2)),end:Math.floor(this.grid.pixelToValueH(this.startOffset+t-this.grid.xAxisScale/2))}):{start:0,end:0}}checkOverFlow(t){var i=this.getFrameRang();return i?t>i.end?t-i.end:t<i.start?t-i.start:0:0}pageToFrame(t){var i;return this.grid?(t=t-this.$left.getBoundingClientRect().right,i=Math.round(this.grid.pixelToValueH(Math.abs(t))),0<t?i:-i):0}pageToCtrl(t,i){return{x:t-=this.$left.getBoundingClientRect().right,y:i-=this.$left.getBoundingClientRect().top}}frameToCanvas(t){let i=0;return this.grid&&(i=this.grid.valueToPixelH(t)-this.grid.xAxisOffset),Number(i)}canvasToFrame(t){return this.grid?Math.max(0,Math.round(this.grid.pixelToValueH(t+this.grid.xAxisOffset))):0}}exports.gridCtrl=new GridCtrl;var grid_2=require("../vm/grid");Object.defineProperty(exports,"syncAxisX",{enumerable:!0,get:function(){return grid_2.syncAxisX}}),Object.defineProperty(exports,"syncAxisY",{enumerable:!0,get:function(){return grid_2.syncAxisY}});