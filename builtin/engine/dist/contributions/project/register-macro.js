"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&("get"in n?t.__esModule:!n.writable&&!n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){e[o=void 0===o?r:o]=t[r]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&__createBinding(t,e,r);return __setModuleDefault(t,e),t};Object.defineProperty(exports,"__esModule",{value:!0}),exports.registerMacroConfig=void 0;const path_1=require("path"),ts=__importStar(require("typescript")),fs_1=require("fs"),type2UI={string:"ui-input",number:"ui-num-input",boolean:"ui-checkbox"},ReadonlyKeyList=["SUPPORT_TEXTURE_FORMATS","KEY","RAD","DEG","FLT_EPSILON","ORIENTATION_PORTRAIT","ORIENTATION_PORTRAIT_UPSIDE_DOWN","ORIENTATION_LANDSCAPE","ORIENTATION_LANDSCAPE_LEFT","ORIENTATION_LANDSCAPE_RIGHT","ORIENTATION_AUTO","REPEAT_FOREVER"];async function registerMacroConfig(e){const o=(await Promise.resolve().then(()=>__importStar(require("cc/editor/macro"))))["macro"];var t=Editor.Package.getPackages({name:"engine"});if(!(t.length<=0)){t=t[0];if(t.info.contributions){var r,e=(0,path_1.join)(e,"cocos/core/platform/macro.ts");const n={},i={},a={};try{(0,fs_1.existsSync)(e)&&((r=ts.createSourceFile(e,(0,fs_1.readFileSync)(e).toString(),ts.ScriptTarget.Latest,!0).statements.find(e=>ts.isInterfaceDeclaration(e)&&"Macro"===e.name.escapedText))&&r.members.filter(e=>{var t;return(null==(t=e.jsDoc)?void 0:t.length)&&["en","zh"].every(t=>e.jsDoc[0].tags.some(e=>e.tagName.escapedText===t))}).forEach(e=>{var t=e.jsDoc[0].tags;n[e.name.escapedText]={en:t.find(e=>"en"===e.tagName.escapedText).comment,zh:t.find(e=>"zh"===e.tagName.escapedText).comment},i[e.name.escapedText]=n[e.name.escapedText].en,a[e.name.escapedText]=n[e.name.escapedText].zh}),Editor.I18n.__protected__.register("en","engine_macro",i),Editor.I18n.__protected__.register("zh","engine_macro",a))}catch(e){console.error(e)}const c=t.info.contributions.project.macroConfig,s=(c.content={},{}),f={};Object.keys(o).forEach(e=>{var t,r;ReadonlyKeyList.includes(e)||(t=o[e],["string","number","boolean"].includes(r=typeof t)&&(s["macroConfig."+e]={label:e,default:t,description:"i18n:engine_macro."+e},f[e]=t,c.content["macroConfig."+e]={ui:type2UI[r]}))}),await Editor.Profile.setProject("engine","macroConfig",f,"default"),t.info.contributions.profile.project||(t.info.contributions.profile.project={}),Object.assign(t.info.contributions.profile.project,s),t.info.contributions.project.macroConfig=c}}}exports.registerMacroConfig=registerMacroConfig;