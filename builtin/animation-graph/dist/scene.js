"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.methods=exports.state=exports.beforeClose=exports.unload=exports.load=void 0;const make_life_easier_utils_1=require("./make-life-easier-utils"),scene_animation_graph_1=__importDefault(require("./scene-animation-graph")),SceneMotionPreview=cce.Preview.motionPreview,SceneTransitionPreview=cce.Preview.transitionPreview;function load(){}function unload(){}async function beforeClose(){if(!exports.state.closing){if(exports.state.closing=!0,scene_animation_graph_1.default.dirtyData.isDirty()){var e=await scene_animation_graph_1.default.dialog();if(0===e)await scene_animation_graph_1.default.apply();else if(1===e)scene_animation_graph_1.default.reset();else if(2===e)return exports.state.closing=!1}scene_animation_graph_1.default.unselect(),exports.state.closing=!1}return!0}exports.load=load,exports.unload=unload,exports.beforeClose=beforeClose,exports.state={closing:!1},exports.methods=Object.assign(Object.assign({async beforeClose(){return await beforeClose()},async edit(e){return!(exports.state.closing||(exports.state.closing=!0,await scene_animation_graph_1.default.edit(e),SceneTransitionPreview.reset(),SceneMotionPreview.reset(),exports.state.closing=!1))}},(0,make_life_easier_utils_1.instantiateIPCMethods)(scene_animation_graph_1.default)),{async changeView(e,n,i){scene_animation_graph_1.default.changeView(e,n,i),Array.isArray(i)&&await this.showMotionPreview()},removeMotionInMotion(e){scene_animation_graph_1.default.getMotionByLevel(e)===SceneMotionPreview.motion&&SceneMotionPreview.hide(),scene_animation_graph_1.default.removeMotionInMotion(e)},changeMotionAutoThreshold(e,n){scene_animation_graph_1.default.changeMotionAutoThreshold(e,n),scene_animation_graph_1.default.getMotionByLevel(e)===SceneMotionPreview.motion&&SceneMotionPreview.setProp()},changeMotionThreshold1D(e,n,i){scene_animation_graph_1.default.changeMotionThreshold1D(e,n,i),scene_animation_graph_1.default.getMotionByLevel(e)===SceneMotionPreview.motion&&SceneMotionPreview.setProp()},changeMotionThreshold2D(e,n,i){scene_animation_graph_1.default.changeMotionThreshold2D(e,n,i),scene_animation_graph_1.default.getMotionByLevel(e)===SceneMotionPreview.motion&&SceneMotionPreview.setProp()},changeMotionProp(...e){scene_animation_graph_1.default.changeMotionProp(...e);var[e]=e;scene_animation_graph_1.default.getMotionByLevel(e)===SceneMotionPreview.motion&&SceneMotionPreview.setProp()},changeClipMotionInMotion(e,n){scene_animation_graph_1.default.changeClipMotionInMotion(e,n),scene_animation_graph_1.default.getMotionByLevel(e)===SceneMotionPreview.motion&&SceneMotionPreview.setProp()},changeAnimationBlend1DInMotion(e,n,i){scene_animation_graph_1.default.changeAnimationBlend1DInMotion(e,n,i),scene_animation_graph_1.default.getMotionByLevel(e)===SceneMotionPreview.motion&&SceneMotionPreview.setProp()},changeAnimationBlend2DInMotion(e,n,i,t){scene_animation_graph_1.default.changeAnimationBlend2DInMotion(e,n,i,t),scene_animation_graph_1.default.getMotionByLevel(e)===SceneMotionPreview.motion&&SceneMotionPreview.setProp()},hideMotionPreview(){SceneMotionPreview.hide()},async showMotionPreview(){var e;return SceneMotionPreview.hasModel()||(e=await scene_animation_graph_1.default.queryPreviewModel())&&await SceneMotionPreview.setModel(e),SceneMotionPreview.show(scene_animation_graph_1.default.getCurrentMotion(),scene_animation_graph_1.default.animationGraph)},playMotionPreview(){SceneMotionPreview.play()},pauseMotionPreview(){SceneMotionPreview.pause()},stopMotionPreview(){SceneMotionPreview.stop()},setTimeMotionPreview(e){SceneMotionPreview.setTime(e)},addTransition(e,n){e=scene_animation_graph_1.default.addTransition(e,n);e&&SceneTransitionPreview.show(e,scene_animation_graph_1.default.stateMachine,scene_animation_graph_1.default.animationGraph)},viewTransition(e){scene_animation_graph_1.default.viewTransition(e);e=scene_animation_graph_1.default.getTransition(e);SceneTransitionPreview.transition&&e===SceneTransitionPreview.transition||SceneTransitionPreview.show(e,scene_animation_graph_1.default.stateMachine,scene_animation_graph_1.default.animationGraph)},removeTransition(e,n){scene_animation_graph_1.default.getTransition(e)===SceneTransitionPreview.transition&&SceneTransitionPreview.hide(),scene_animation_graph_1.default.removeTransition(e,n)},changeTransitionProp(e,n,i){scene_animation_graph_1.default.changeTransitionProp(e,n,i),scene_animation_graph_1.default.getTransition(e)===SceneTransitionPreview.transition&&SceneTransitionPreview.setProp()},hideTransitionPreview(){SceneTransitionPreview.hide()},async showTransitionPreview(e){SceneTransitionPreview.hasModel()||(n=await scene_animation_graph_1.default.queryPreviewModel())&&await SceneTransitionPreview.setModel(n);var n=scene_animation_graph_1.default.getTransition(e);return SceneTransitionPreview.show(n,scene_animation_graph_1.default.stateMachine,scene_animation_graph_1.default.animationGraph)},playTransitionPreview(){SceneTransitionPreview.play()},pauseTransitionPreview(){SceneTransitionPreview.pause()},stopTransitionPreview(){SceneTransitionPreview.stop()},setTimeTransitionPreview(e){SceneTransitionPreview.setTime(e)},async setPreviewModel(e){await scene_animation_graph_1.default.setPreviewModel(e),await SceneTransitionPreview.setModel(e),await SceneMotionPreview.setModel(e)},updatePreviewVariable(e){SceneTransitionPreview.active&&SceneTransitionPreview.updateVariable(e),SceneMotionPreview.active&&SceneMotionPreview.updateVariable(e)}});