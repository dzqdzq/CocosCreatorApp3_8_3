"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Awaiter=void 0;const asserts_1=require("./asserts");class Awaiter{constructor(){this._state=State.PENDING,this._result=null,this._queue=[]}resolve(t){(0,asserts_1.asserts)(this._state===State.PENDING),this._result=t,this._state=State.RESOLVED;for(var{resolve:e}of this._queue)e(t);this._queue.length=0}reject(t){(0,asserts_1.asserts)(this._state===State.PENDING),this._result=t,this._state=State.RESOLVED;for(var{reject:e}of this._queue)e(t);this._queue.length=0}async wait(){switch(this._state){case State.RESOLVED:return this._result;case State.REJECTED:throw this._result}return new Promise((t,e)=>{this._queue.push({resolve:t,reject:e})})}}var State;exports.Awaiter=Awaiter,function(t){t[t.PENDING=0]="PENDING",t[t.RESOLVED=1]="RESOLVED",t[t.REJECTED=2]="REJECTED"}(State=State||{});