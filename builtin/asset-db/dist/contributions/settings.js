"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,a,r){void 0===r&&(r=a);var s=Object.getOwnPropertyDescriptor(t,a);s&&("get"in s?t.__esModule:!s.writable&&!s.configurable)||(s={enumerable:!0,get:function(){return t[a]}}),Object.defineProperty(e,r,s)}:function(e,t,a,r){e[r=void 0===r?a:r]=t[a]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&__createBinding(t,e,a);return __setModuleDefault(t,e),t};Object.defineProperty(exports,"__esModule",{value:!0}),exports.close=exports.ready=exports.$=exports.template=exports.style=void 0;const path_1=require("path"),fs_extra_1=require("fs-extra"),AssetConfigComp=__importStar(require("./asset-config")),Vue=require("vue/dist/vue.js");Vue.config.productionTip=!1,Vue.config.devtools=!1;let panel=null,vm=null;const vueTemplate=`
<div class="assetDB">
    <div class="default-meta">
        <ui-icon value="setting" style="color: var(--color-warn-fill); margin-right: 2px;"></ui-icon>
        <ui-label value="i18n:asset-db.preferences.defaultMeta"></ui-label>
        <ui-icon value="help" tooltip="i18n:asset-db.preferences.defaultMetaTip"></ui-icon>
        <asset-config></asset-config>
    </div>
</div>
`,PreferencesVM=Vue.extend({name:"PreferencesVM",components:{"asset-config":AssetConfigComp},data(){return{importAssetTypes:{image:{type:{label:Editor.I18n.t("asset-db.preferences.defaultImageMeta"),render:{ui:"ui-select",items:[{label:"raw",value:"raw"},{label:"texture",value:"texture"},{label:"normal map",value:"normal map"},{label:"sprite-frame",value:"sprite-frame"},{label:"texture cube",value:"texture cube"}],attributes:{value:"texture"}}}}},defaultMeta:{}}},mounted(){this.initDefaultMeta()},methods:{getRenderText(e){return e.attributes=e.attributes||{},JSON.stringify(e)},initDefaultMeta(){var e=this;try{var t=(0,path_1.join)(Editor.Project.path,".creator","default-meta.json");if((0,fs_extra_1.existsSync)(t)){var a=(0,fs_extra_1.readJSONSync)(t);for(const r in a){e.defaultMeta[r]={};for(const s in a[r])e.importAssetTypes[r]&&e.importAssetTypes[r][s]&&e.$set(e.importAssetTypes[r][s].render.attributes,"value",a[r][s]),e.$set(e.defaultMeta[r],s,a[r][s])}}}catch(e){console.error(e)}},defaultMetaConfirm(e,t,a){var r,s=this,i=(0,path_1.join)(Editor.Project.path,".creator","default-meta.json");(0,fs_extra_1.existsSync)(i)?(r=(0,fs_extra_1.readJSONSync)(i),s.defaultMeta[t]=s.defaultMeta[t]||{},e.target&&s.$set(s.defaultMeta[t],a,e.target.value),r=Object.assign({},r,s.defaultMeta),(0,fs_extra_1.outputJSONSync)(i,r,{spaces:2})):(s.defaultMeta[t]={},e.target&&s.$set(s.defaultMeta[t],a,e.target.value),(0,fs_extra_1.outputJSONSync)(i,s.defaultMeta,{spaces:2})),Editor.Message.send("asset-db","refresh-default-user-data-config"),Editor.Task.addNotice({title:"Asset-DB",message:"User data has been updated.",timeout:5e3})}},template:vueTemplate});function ready(){panel=this,null!==vm&&void 0!==vm&&vm.$destroy(),(vm=new PreferencesVM).$mount(panel.$.container)}function close(){null!==vm&&void 0!==vm&&vm.$destroy(),vm=null,panel=null}exports.style=`
ui-prop { --left-width: 40%; }
ui-prop > ui-label { padding-left: 2em; }
ui-icon { cursor: pointer; }
.setting[type='local'] { color: var(--color-warn-fill); padding-right: 2px; }
`,exports.template=`
<div class="container"></div>
`,exports.$={container:".container"},exports.ready=ready,exports.close=close;