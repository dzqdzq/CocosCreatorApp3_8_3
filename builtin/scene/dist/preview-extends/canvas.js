"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const electron_base_ipc_1=require("@base/electron-base-ipc");class GlPreview{constructor(t,e){this.gl=null,this.canvas=null,this.initialized=!1,this._registerName=t,this._name=e,this._lastData=null}async init(t){t=t||{width:100,height:100},(0,electron_base_ipc_1.sendToChannel)(this._registerName,this._name,{index:t.index,width:t.width,height:t.height}),this.initialized=!0}queryPreviewData(e){return e=e||{width:100,height:100},new Promise((a,t)=>{(0,electron_base_ipc_1.sendToChannel)(this._registerName,this._name,{index:e.index,width:e.width,height:e.height}).option({original:!0}).callback((t,e)=>{t?(console.warn("queryPreviewData Failed",this._name,t),a(null)):a(e)})})}resizeGL(e,a){if(e=Math.floor(e),a=Math.floor(a),this.canvas){let t=!1;this.canvas.width!==e&&(this.canvas.width=e,t=!0),this.canvas.height!==a&&(this.canvas.height=a,t=!0),t&&null!==this._lastData&&null!=(e=this.gl)&&e.putImageData(this._lastData,0,0)}}drawGL(t,e,a){e=Math.floor(e),a=Math.floor(a),this.canvas&&(this._lastData=new ImageData(new Uint8ClampedArray(t.buffer),e,a),null!=(t=this.gl))&&t.putImageData(this._lastData,0,0)}initGL(t,e=0){t&&(t.style.transform="scale(1, -1)",this.canvas=t,this.gl=t.getContext("2d"))}destroyGL(){}setScale(t){this.canvas&&(this.canvas.style.transform=`scale(${t}, ${-t})`)}}exports.default=GlPreview;