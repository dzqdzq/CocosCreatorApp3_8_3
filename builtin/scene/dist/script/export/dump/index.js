"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const cc_1=require("cc"),utils_1=require("./utils"),asset_1=__importDefault(require("./asset")),decode_1=require("./decode"),encode_1=require("./encode"),{get,set}=require("lodash");class DumpUtil{dumpProperty(e,t){return""===t?this.dumpNode(e):(t=(0,utils_1.parsingPath)(t,e),(0,utils_1.parsingPath)(t.search,e),t=t.search?get(e,t.search):e,e=cc_1.CCClass.Attr.getClassAttrs(t.constructor),(0,encode_1.encodeObject)(t,e))}dumpNode(e){return e?(e instanceof cc_1.Scene?(0,encode_1.encodeScene):(0,encode_1.encodeNode))(e):null}dumpComponent(e){return e?(0,encode_1.encodeComponent)(e):null}async restoreProperty(e,t,r){if(!/^__comps__\.\d+$/.test(t))return(0,decode_1.decodePatch)(t,r,e);if("object"==typeof r.value)for(const o in r.value)await(0,decode_1.decodePatch)(t+"."+o,r.value[o],e)}resetProperty(e,t){return(0,decode_1.resetProperty)(e,t)}updatePropertyFromNull(e,t){return(0,decode_1.updatePropertyFromNull)(e,t)}async restoreNode(e,t){return(t&&t.isScene?(0,decode_1.decodeScene):(0,decode_1.decodeNode))(t,e)}parsingPath(e,t){return(0,utils_1.parsingPath)(e,t)}generatePath(e,t){}encodeObject(e,t,r=null,o,c){return(0,encode_1.encodeObject)(e,t,r,o,c)}getDefaultValue(e){if(!e)return null;let t=asset_1.default.getDefaultValue(e,null);return t||(e=cc_1.js.getClassByName(e),t=e?new e:null),t}}exports.default=new DumpUtil;