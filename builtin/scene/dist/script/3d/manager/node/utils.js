"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.visitNode=exports.getNodeName=exports.hasOneKindOfComponent=exports.getUITransformParentNode=exports.getUICanvasNode=exports.walk=exports.walkChild=void 0;const cc_1=require("cc");function walkChild(e,n){(n[e.uuid]=e).children&&e.children.forEach(e=>{exports.walkChild(e,n)})}function walk(e,n){exports.walkChild(e,n)}function getUICanvasNode(r,e=!0){if(r){if(hasOneKindOfComponent(r,cc_1.Canvas))return r;let n=cc_1.director.getScene();if("prefab"===cce.SceneFacadeManager.queryMode()&&e&&(e=cce.SceneFacadeManager._facadeFSM.prefabSceneFacade._sceneProxy,n=e.getRootNode()),r!==n){let e=r.parent;for(;e;){if(hasOneKindOfComponent(e,cc_1.Canvas))return r;if(e===n)break;e=e.parent}}var t=r.children.slice();for(let e=t.length-1;0<=e;e--){var o=t[e];if(hasOneKindOfComponent(o,cc_1.Canvas))return o}}return null}function getUITransformParentNode(r){if(r){if(hasOneKindOfComponent(r,cc_1.UITransformComponent))return r;let n=cc_1.director.getScene();var e=cce.SceneFacadeManager.queryMode();if("prefab"===e&&(e=cce.SceneFacadeManager._facadeFSM.prefabSceneFacade._sceneProxy,n=e.getRootNode()),r!==n){let e=r.parent;for(;e;){if(hasOneKindOfComponent(e,cc_1.UITransformComponent))return e;if(e===n)break;e=e.parent}}}return null}function hasOneKindOfComponent(n,r){if(n&&n.components)for(let e=0;e<n.components.length;e++)if(n.components[e]instanceof r)return!0;return!1}function getNodeName(e,n){if(n&&Array.isArray(n.children))for(var r=n.children.map(e=>e&&e.name||"");r.includes(e);)/(\d+)$/.test(e)?e=e.replace(/(\d+)$/,(e,n)=>{var r=parseInt(n,10);return(r+=1).toString().padStart(n.length,"0")}):e+="-001";return e}function visitNode(e,n,r=!1){r=n(e,!!r);if(!r){var t=e.children;for(let e=t.length-1;0<=e;--e)visitNode(t[e],n,!0)}}exports.walkChild=walkChild,exports.walk=walk,exports.getUICanvasNode=getUICanvasNode,exports.getUITransformParentNode=getUITransformParentNode,exports.hasOneKindOfComponent=hasOneKindOfComponent,exports.getNodeName=getNodeName,exports.visitNode=visitNode;