"use strict";var MarchingSquares={NONE:0,UP:1,LEFT:2,DOWN:3,RIGHT:4,getBlobOutlinePoints:function(a,r,e,n){MarchingSquares.data=a,MarchingSquares.width=r,MarchingSquares.height=e,MarchingSquares.loop=n;a=MarchingSquares.getFirstNonTransparentPixelTopDown(),r=MarchingSquares.walkPerimeter(a.x,a.y);return MarchingSquares.width=null,MarchingSquares.height=null,MarchingSquares.data=null,MarchingSquares.loop=null,r},getFirstNonTransparentPixelTopDown:function(){for(var a,r=MarchingSquares.data,e=MarchingSquares.width,n=MarchingSquares.height,s=0,i=0;i<n;i++)for(a=0;a<e;a++,s+=4)if(0<r[s+3])return{x:a,y:i};return null},walkPerimeter:function(a,r){var e=a=(a=a<0?0:a)>MarchingSquares.width?MarchingSquares.width:a,n=r=(r=r<0?0:r)>MarchingSquares.height?MarchingSquares.height:r,s=[cc.v2(e,n)];do{switch(MarchingSquares.step(e,n,MarchingSquares.data),MarchingSquares.nextStep){case MarchingSquares.UP:n--;break;case MarchingSquares.LEFT:e--;break;case MarchingSquares.DOWN:n++;break;case MarchingSquares.RIGHT:e++}}while(0<=e&&e<=MarchingSquares.width&&0<=n&&n<=MarchingSquares.height&&s.push(cc.v2(e,n)),e!==a||n!==r);return MarchingSquares.loop&&s.push(cc.v2(e,n)),s},step:function(a,r,e){var n=MarchingSquares.width,s=4*n,i=(r-1)*s+4*(a-1),c=0<a,a=a<n,n=r<MarchingSquares.height,r=0<r;switch(MarchingSquares.upLeft=r&&c&&0<e[3+i],MarchingSquares.upRight=r&&a&&0<e[7+i],MarchingSquares.downLeft=n&&c&&0<e[i+s+3],MarchingSquares.downRight=n&&a&&0<e[i+s+7],MarchingSquares.previousStep=MarchingSquares.nextStep,MarchingSquares.state=0,MarchingSquares.upLeft&&(MarchingSquares.state|=1),MarchingSquares.upRight&&(MarchingSquares.state|=2),MarchingSquares.downLeft&&(MarchingSquares.state|=4),MarchingSquares.downRight&&(MarchingSquares.state|=8),MarchingSquares.state){case 1:MarchingSquares.nextStep=MarchingSquares.UP;break;case 2:case 3:MarchingSquares.nextStep=MarchingSquares.RIGHT;break;case 4:MarchingSquares.nextStep=MarchingSquares.LEFT;break;case 5:MarchingSquares.nextStep=MarchingSquares.UP;break;case 6:MarchingSquares.previousStep==MarchingSquares.UP?MarchingSquares.nextStep=MarchingSquares.LEFT:MarchingSquares.nextStep=MarchingSquares.RIGHT;break;case 7:MarchingSquares.nextStep=MarchingSquares.RIGHT;break;case 8:MarchingSquares.nextStep=MarchingSquares.DOWN;break;case 9:MarchingSquares.previousStep==MarchingSquares.RIGHT?MarchingSquares.nextStep=MarchingSquares.UP:MarchingSquares.nextStep=MarchingSquares.DOWN;break;case 10:case 11:MarchingSquares.nextStep=MarchingSquares.DOWN;break;case 12:MarchingSquares.nextStep=MarchingSquares.LEFT;break;case 13:MarchingSquares.nextStep=MarchingSquares.UP;break;case 14:MarchingSquares.nextStep=MarchingSquares.LEFT;break;default:MarchingSquares.nextStep=MarchingSquares.NONE}}};module.exports=MarchingSquares;