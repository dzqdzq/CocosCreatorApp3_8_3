"use strict";var __importDefault=this&&this.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(exports,"__esModule",{value:!0});const math_1=__importDefault(require("../../../../utils/math"));class LinearTicks{constructor(){this.ticks=[],this.tickLods=[],this.tickRatios=[],this.minScale=.1,this.maxScale=1e3,this.minValueScale=1,this.maxValueScale=1,this.minValue=-500,this.maxValue=500,this.pixelRange=500,this.minSpacing=10,this.maxSpacing=80,this.minTickLevel=0,this.maxTickLevel=0}initTicks(i,t,s){(s=s<=0?1:s)<(t=t<=0?1:t)&&(s=t),this.tickLods=i,this.minScale=t,this.maxScale=s,this.ticks=[];let e=1,h=0;this.ticks.push(e);var a=t,c=s;let l=1,n=1;for(;e*this.tickLods[h]<=c;)e*=this.tickLods[h],h=h+1>this.tickLods.length-1?0:h+1,this.ticks.push(e),l=e;for(this.minValueScale=1/l*100,h=this.tickLods.length-1,e=1;e/this.tickLods[h]>=a;)e/=this.tickLods[h],h=h-1<0?this.tickLods.length-1:h-1,this.ticks.unshift(e),n=e;return this.maxValueScale=1/n*100,this}spacing(i,t){return this.minSpacing=i,this.maxSpacing=t,this}range(i,t,s){this.minValue=Math.fround(Math.min(i,t)),this.maxValue=Math.fround(Math.max(i,t)),this.pixelRange=s,this.minTickLevel=0,this.maxTickLevel=this.ticks.length-1;for(let i=this.ticks.length-1;0<=i;i--){var e=this.ticks[i]*this.pixelRange/(this.maxValue-this.minValue);if(this.tickRatios[i]=(e-this.minSpacing)/(this.maxSpacing-this.minSpacing),1<=this.tickRatios[i]&&(this.maxTickLevel=i),e<=this.minSpacing){this.minTickLevel=i;break}}for(let i=this.minTickLevel;i<=this.maxTickLevel;i++)this.tickRatios[i]=math_1.default.clamp01(this.tickRatios[i]);return this}ticksAtLevel(t,s){var e=[],h=this.ticks[t],a=Math.floor(this.minValue/h),c=Math.ceil(this.maxValue/h);for(let i=a;i<=c;i++)(!s||t>=this.maxTickLevel||i%Math.round(this.ticks[t+1]/h)!=0)&&e.push(i*h);return e}levelForStep(t){for(let i=0;i<this.ticks.length;i++)if(t<=this.ticks[i]*this.pixelRange/(this.maxValue-this.minValue))return i;return-1}}exports.default=LinearTicks;