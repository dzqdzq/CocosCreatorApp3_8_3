"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const cc_1=require("cc"),physics_2d_1=__importDefault(require("../physics-2d"));function getBoundingBox(e){e=e.getComponent(cc_1.MeshRenderer);return e&&e.mesh?{minPosition:e.mesh.minPosition,maxPosition:e.mesh.maxPosition}:{minPosition:cc_1.Vec3.ZERO,maxPosition:cc_1.Vec3.ZERO}}function getSize(e){var t=new cc_1.Vec3;return cc_1.Vec3.subtract(t,e.maxPosition,e.minPosition),t}function getCenter(e){var t=getSize(e),c=new cc_1.Vec3;return cc_1.Vec3.scaleAndAdd(c,e.minPosition,t,.5),c}function maxComponent(e){return Math.max(e.x,Math.max(e.y,e.z))}class ComponentUtils{constructor(){this.addComponentMap={SphereCollider(e,t){var c;t._prefab||(c=getSize(t=getBoundingBox(t)),cc_1.Vec3.strictEquals(c,cc_1.Vec3.ZERO))||(e.radius=maxComponent(c)/2,e.center=getCenter(t))},BoxCollider(e,t){var c;t._prefab||(c=getSize(t=getBoundingBox(t)),cc_1.Vec3.strictEquals(c,cc_1.Vec3.ZERO))||(c.x=0===c.x?.001:c.x,c.y=0===c.y?.001:c.y,c.z=0===c.z?.001:c.z,e.size=c,e.center=getCenter(t))},ConeCollider(e,t){var c,r;t._prefab||(r=getSize(t=getBoundingBox(t)),cc_1.Vec3.strictEquals(r,cc_1.Vec3.ZERO))||(c=Math.max(r.x,r.z)/2,r=r.y,0<c&&(e.radius=c),0<r&&(e.height=r),e.center=getCenter(t))},CylinderCollider(e,t){var c,r;t._prefab||(r=getSize(t=getBoundingBox(t)),cc_1.Vec3.strictEquals(r,cc_1.Vec3.ZERO))||(c=Math.max(r.x,r.z)/2,r=r.y,0<c&&(e.radius=c),0<r&&(e.height=r),e.center=getCenter(t))},CapsuleCollider(e,t){var c,r;t._prefab||(r=getSize(t=getBoundingBox(t)),cc_1.Vec3.strictEquals(r,cc_1.Vec3.ZERO))||(c=Math.max(r.x,r.z)/2,r=r.y-2*c,0<c&&(e.radius=c,e.cylinderHeight=0<r?r:0),e.center=getCenter(t))},MeshCollider(e,t){t._prefab||(t=t.getComponent(cc_1.MeshRenderer))&&t.mesh&&(e.mesh=t.mesh)},TerrainCollider(e,t){t._prefab||(t=t.getComponent(cc_1.Terrain))&&t._asset&&(e.terrain=t._asset)},BoxCollider2D(e,t){var c,r=e.getComponent(cc_1.UITransformComponent);r&&0!==(c=r.contentSize).width&&0!==c.height&&(e.size=cc.size(c),e.offset.x=(.5-r.anchorX)*c.width,e.offset.y=(.5-r.anchorY)*c.height)},CircleCollider2D(e,t){var c=e.getComponent(cc_1.UITransformComponent);c&&(c=c.contentSize,0!=(c=Math.max(c.width,c.height)/2))&&(e.radius=c)},PolygonCollider2D(e,t){physics_2d_1.default.resetPoints(e)},Camera(e,t){"2d"===cce.SceneFacadeManager._projectType&&(e.visibility=cc_1.Layers.makeMaskInclude([cc_1.Layers.Enum.UI_3D,cc_1.Layers.Enum.UI_2D]),e.projection=cc_1.Camera.ProjectionType.ORTHO,e.near=0,e.clearFlags=cc_1.Camera.ClearFlag.DEPTH_ONLY),"3d"===cce.SceneFacadeManager._projectType&&(e.visibility=cc_1.Layers.Enum.DEFAULT,e.projection=cc_1.Camera.ProjectionType.PERSPECTIVE,e.clearFlags=cc_1.Camera.ClearFlag.SKYBOX)}}}}exports.default=new ComponentUtils;