"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.UIManager=void 0;const selection_1=__importDefault(require("../../../public/selection")),node_1=__importDefault(require("../node")),node_2=__importDefault(require("../../../utils/node")),cc_1=require("cc"),vec3_1=require("../../../utils/math/vec3"),v3_a=new cc_1.Vec3;class UIManager{alignSelection(d){var e=selection_1.default.query();if(!(e.length<=1)){let c=e.map(e=>node_1.default.query(e)).filter(Boolean),a=(c=c.filter(e=>{let n=e.parent;for(;n;){if(-1!==c.indexOf(n))return!1;n=n.parent}return!0}),1e10),t=1e10,r=-1e10,o=-1e10;e=c.map(e=>{var n=node_2.default.getWorldBounds(e);return a=Math.min(a,n.x),t=Math.min(t,n.y),r=Math.max(r,n.xMax),o=Math.max(o,n.yMax),{node:e,bounds:n}});const s=new cc_1.Rect(a,t,r-a,o-t);var n=c.map(e=>e.uuid),n=cce.SceneFacadeManager.beginRecording(n);e.forEach(e=>{var n=e.node;let c;switch(d){case"top":c=new cc_1.Vec3(0,s.yMax-e.bounds.yMax,0);break;case"v-center":c=new cc_1.Vec3(0,s.center.y-e.bounds.center.y,0);break;case"bottom":c=new cc_1.Vec3(0,s.y-e.bounds.y,0);break;case"left":c=new cc_1.Vec3(s.x-e.bounds.x,0,0);break;case"h-center":c=new cc_1.Vec3(s.center.x-e.bounds.center.x,0,0);break;case"right":c=new cc_1.Vec3(s.xMax-e.bounds.xMax,0,0);break;default:c=new cc_1.Vec3}var a=node_2.default.getWorldPosition(n);node_2.default.setWorldPosition(n,vec3_1.MVec3.add(v3_a,a,c))}),cce.SceneFacadeManager.endRecording(n)}}distributeSelection(r){var e=selection_1.default.query();if(!(e.length<=1)){let c=e.map(e=>node_1.default.query(e)).filter(Boolean);e=(c=c.filter(e=>{let n=e.parent;for(;n;){if(-1!==c.indexOf(n))return!1;n=n.parent}return!0})).map(e=>{return{node:e,bounds:node_2.default.getWorldBounds(e)}});e.sort((e,n)=>{let c=1;switch(r){case"top":c=e.bounds.yMax-n.bounds.yMax;break;case"v-center":c=e.bounds.center.y-n.bounds.center.y;break;case"bottom":c=e.bounds.y-n.bounds.y;break;case"left":c=e.bounds.x-n.bounds.x;break;case"h-center":c=e.bounds.center.x-n.bounds.center.x;break;case"right":c=e.bounds.xMax-n.bounds.xMax}return c});const o=e.length-1,d=e[0].bounds,s=e[o].bounds;var n=c.map(e=>e.uuid),n=cce.SceneFacadeManager.beginRecording(n);e.forEach((e,n)=>{var c=e.node,a=e.bounds;let t;switch(r){case"top":t=new cc_1.Vec3(0,d.yMax+(s.yMax-d.yMax)*n/o-a.yMax,0);break;case"v-center":t=new cc_1.Vec3(0,d.center.y+(s.center.y-d.center.y)*n/o-a.center.y,0);break;case"bottom":t=new cc_1.Vec3(0,d.y+(s.y-d.y)*n/o-a.y,0);break;case"left":t=new cc_1.Vec3(d.x+(s.x-d.x)*n/o-a.x,0,0);break;case"h-center":t=new cc_1.Vec3(d.center.x+(s.center.x-d.center.x)*n/o-a.center.x,0);break;case"right":t=new cc_1.Vec3(d.xMax+(s.xMax-d.xMax)*n/o-a.xMax,0,0);break;default:t=new cc_1.Vec3(0,0,0)}e=node_2.default.getWorldPosition(c);node_2.default.setWorldPosition(c,vec3_1.MVec3.add(v3_a,e,t))}),cce.SceneFacadeManager.endRecording(n)}}}exports.UIManager=UIManager,exports.default=new UIManager;