"use strict";var __importDefault=this&&this.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(exports,"__esModule",{value:!0});const gizmo_select_1=__importDefault(require("../components/base/gizmo-select")),position_1=__importDefault(require("./position")),rotation_1=__importDefault(require("./rotation")),scale_1=__importDefault(require("./scale")),rectangle_1=__importDefault(require("./rectangle")),gizmoMap={position:new position_1.default(null),rotation:new rotation_1.default(null),scale:new scale_1.default(null),rect:new rectangle_1.default(null)};class TransformGizmo extends gizmo_select_1.default{constructor(){super(...arguments),this._gizmo=gizmoMap[cce.Gizmo.transformToolData.toolName],this._eventMap={toolNameChanged:()=>{this.changeTool(cce.Gizmo.transformToolData.toolName)}}}get nodes(){return this._gizmo.nodes}set target(o){this._gizmo.target=o,super.target=o}get target(){return this._gizmo.target}changeTool(o){var e=this._gizmo.target;this._gizmo.hide(),this._gizmo.target=null,this._gizmo=gizmoMap[o],this._gizmo.target=this._gizmo.target||e,this._gizmo.show()}onVertexSnapMove(o){if(this._gizmo.onVertexSnapMove)return this._gizmo.onVertexSnapMove(o)}init(){this._gizmo.init()}show(){super.show(),this._gizmo.show()}hide(){super.hide(),this._gizmo.hide()}onShow(){var o;super.onShow&&super.onShow(),this.changeTool(cce.Gizmo.transformToolData.toolName),this._eventMap.toolNameChanged=()=>{this.changeTool(cce.Gizmo.transformToolData.toolName)},this._eventMap.pivotChanged=()=>{this._gizmo.updateControllerTransform&&this._gizmo.updateControllerTransform(),cce.Engine.repaintInEditMode()},this._eventMap.coordinateChanged=()=>{this._gizmo.updateControllerTransform&&this._gizmo.updateControllerTransform(),cce.Engine.repaintInEditMode()},null!=(o=cce.Gizmo.transformToolData)&&o.addListener("tool-name-changed",this._eventMap.toolNameChanged),null!=(o=cce.Gizmo.transformToolData)&&o.addListener("pivot-changed",this._eventMap.pivotChanged),null!=(o=cce.Gizmo.transformToolData)&&o.addListener("coordinate-changed",this._eventMap.coordinateChanged),this._gizmo.onShow()}onHide(){var o;super.onHide&&super.onHide(),null!=(o=cce.Gizmo.transformToolData)&&o.removeListener("tool-name-changed",this._eventMap.toolNameChanged),null!=(o=cce.Gizmo.transformToolData)&&o.removeListener("pivot-changed",this._eventMap.pivotChanged),null!=(o=cce.Gizmo.transformToolData)&&o.removeListener("coordinate-changed",this._eventMap.coordinateChanged),this._gizmo.onHide()}onUpdate(o){this._gizmo.onUpdate&&this._gizmo.onUpdate(o)}onDestroy(){this._gizmo.onDestroy&&this._gizmo.onDestroy()}onNodeChanged(o){this._gizmo.onNodeChanged&&this._gizmo.onNodeChanged(o)}onKeyDown(o){return this._gizmo.onKeyDown&&this._gizmo.onKeyDown(o)}onKeyUp(o){return this._gizmo.onKeyUp&&this._gizmo.onKeyUp(o)}onCameraControlModeChanged(o){return this._gizmo.onCameraControlModeChanged&&this._gizmo.onCameraControlModeChanged(o)}}exports.default=TransformGizmo;