"use strict";var __importDefault=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});const cc_1=require("cc"),external_1=__importDefault(require("../../utils/external")),base_1=require("../base"),frustum_1=__importDefault(require("../../controller/frustum")),controller_direction_light_1=__importDefault(require("./controller-direction-light")),NodeUtils=external_1.default.NodeUtils,tempQuat=new cc_1.Quat;class DirectionalLightComponentGizmo extends base_1.SelectGizmo{constructor(){super(...arguments),this._lightGizmoColor=new cc.Color(255,255,50)}init(){this.createController(),this._isInitialized=!0}onShow(){this._controller.show(),this._frustumCtrl.show(),this.updateControllerData()}onHide(){this._controller.hide(),this._frustumCtrl.hide()}createController(){var t=this.getGizmoRoot();this._controller=new controller_direction_light_1.default(t),this._controller.setColor(this._lightGizmoColor),this._frustumCtrl=new frustum_1.default(t)}onControllerMouseDown(){this._isInitialized&&this.target}onControllerMouseMove(){this.updateDataFromController()}onControllerMouseUp(){}updateDataFromController(){var t;this._controller.updated&&this.target&&(t=this.target.node,this.onComponentChanged(t))}updateControllerTransform(){var t,e;null!==this.target&&(e=this.target.node,t=tempQuat,NodeUtils.getWorldRotation3D(e,t),e=NodeUtils.getWorldPosition3D(e),this._controller.setPosition(e),this._controller.setRotation(t),this._frustumCtrl.setPosition(e),this._frustumCtrl.setRotation(t))}updateControllerData(){var t;this._isInitialized&&null!==this.target&&((t=this.target)&&t.shadowEnabled?(this._frustumCtrl.show(),this._frustumCtrl.updateSize(0,t.shadowOrthoSize,1,1,t.shadowNear,t.shadowFar,0)):this._frustumCtrl.hide(),this.updateControllerTransform())}onTargetUpdate(){this.updateControllerData()}onNodeChanged(){this.updateControllerData()}}exports.default=DirectionalLightComponentGizmo;