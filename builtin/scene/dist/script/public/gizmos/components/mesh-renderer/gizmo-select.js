"use strict";var __importDefault=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});const cc_1=require("cc"),engine_1=__importDefault(require("../../utils/engine")),external_1=__importDefault(require("../../utils/external")),base_1=require("../base"),box_1=__importDefault(require("../../controller/box")),controller_light_probe_tetrahedron_1=__importDefault(require("../light-probe-group/controller-light-probe-tetrahedron")),NodeUtils=external_1.default.NodeUtils,getBoundingBox=engine_1.default["getBoundingBox"],tempQuat_a=new cc_1.Quat;class ModelComponentGizmo extends base_1.SelectGizmo{init(){this.createController(),this._isInitialized=!0,cce.Gizmo.registerLightProbeEditModeListener(this)}lightProbeInfoChanged(){this.tetrahedronController.updateController()}onShow(){this._controller.show(),this.tetrahedronController.show(),this.updateControllerTransform()}onHide(){this._controller.hide(),this.tetrahedronController.hide()}createController(){var t=this.getGizmoRoot();this._controller=new box_1.default(t),this._controller.setOpacity(150),this.tetrahedronController=new controller_light_probe_tetrahedron_1.default(t,this)}updateControllerTransform(){this.updateControllerData()}updateControllerData(){var t,e,o,r,l,i;this._isInitialized&&null!=this.target&&(i=this.target.node,(t=getBoundingBox(this.target))?(this._controller.show(),e=new cc_1.Vec3,o=NodeUtils.getWorldScale3D(i),r=NodeUtils.getWorldPosition3D(i),l=tempQuat_a,NodeUtils.getWorldRotation3D(i,l),this._controller.setScale(o),this._controller.setPosition(r),this._controller.setRotation(l),cc_1.Vec3.multiplyScalar(e,t.halfExtents,2),i=cc.v3(t.center.x,t.center.y,t.center.z),this._controller.updateSize(i,e)):this._controller.hide())}onTargetUpdate(){var t;this.updateControllerData(),null!=(t=this.tetrahedronController)&&t.updateController()}onNodeChanged(){var t;this.updateControllerData(),null!=(t=this.tetrahedronController)&&t.updateController()}}exports.default=ModelComponentGizmo;