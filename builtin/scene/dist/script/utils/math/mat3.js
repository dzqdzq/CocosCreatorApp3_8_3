"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MMat3=void 0;const utils_1=require("./utils"),cc_1=require("cc"),vec3_1=require("./vec3");let _a00=0,_a01=0,_a02=0,_a10=0,_a11=0,_a12=0,_a20=0,_a21=0,_a22=0;const v3_1=new cc_1.Vec3,v3_2=new cc_1.Vec3;class MMat3{static clone(m){return new cc_1.Mat3(m.m00,m.m01,m.m02,m.m03,m.m04,m.m05,m.m06,m.m07,m.m08)}static copy(m,a){return m.m00=a.m00,m.m01=a.m01,m.m02=a.m02,m.m03=a.m03,m.m04=a.m04,m.m05=a.m05,m.m06=a.m06,m.m07=a.m07,m.m08=a.m08,m}static set(m,a,_,t,r,s,e,c,M,i){return m.m00=a,m.m01=_,m.m02=t,m.m03=r,m.m04=s,m.m05=e,m.m06=c,m.m07=M,m.m08=i,m}static identity(m){return m.m00=1,m.m01=0,m.m02=0,m.m03=0,m.m04=1,m.m05=0,m.m06=0,m.m07=0,m.m08=1,m}static transpose(m,a){return m===a?(_a01=a.m01,_a02=a.m02,_a12=a.m05,m.m01=a.m03,m.m02=a.m06,m.m03=_a01,m.m05=a.m07,m.m06=_a02,m.m07=_a12):(m.m00=a.m00,m.m01=a.m03,m.m02=a.m06,m.m03=a.m01,m.m04=a.m04,m.m05=a.m07,m.m06=a.m02,m.m07=a.m05,m.m08=a.m08),m}static invert(m,a){_a00=a.m00,_a01=a.m01,_a02=a.m02,_a10=a.m03,_a11=a.m04,_a12=a.m05,_a20=a.m06,_a21=a.m07;var a=(_a22=a.m08)*_a11-_a12*_a21,_=-_a22*_a10+_a12*_a20,t=_a21*_a10-_a11*_a20,r=_a00*a+_a01*_+_a02*t;return r&&(m.m00=a*(r=1/r),m.m01=(-_a22*_a01+_a02*_a21)*r,m.m02=(_a12*_a01-_a02*_a11)*r,m.m03=_*r,m.m04=(_a22*_a00-_a02*_a20)*r,m.m05=(-_a12*_a00+_a02*_a10)*r,m.m06=t*r,m.m07=(-_a21*_a00+_a01*_a20)*r,m.m08=(_a11*_a00-_a01*_a10)*r),m}static determinant(m){return _a00=m.m00,_a01=m.m01,_a02=m.m02,_a10=m.m03,_a11=m.m04,_a12=m.m05,_a20=m.m06,_a21=m.m07,_a22=m.m08,_a00*(_a22*_a11-_a12*_a21)+_a01*(-_a22*_a10+_a12*_a20)+_a02*(_a21*_a10-_a11*_a20)}static multiply(m,a,_){_a00=a.m00,_a01=a.m01,_a02=a.m02,_a10=a.m03,_a11=a.m04,_a12=a.m05,_a20=a.m06,_a21=a.m07,_a22=a.m08;var a=_.m00,t=_.m01,r=_.m02,s=_.m03,e=_.m04,c=_.m05,M=_.m06,i=_.m07,_=_.m08;return m.m00=a*_a00+t*_a10+r*_a20,m.m01=a*_a01+t*_a11+r*_a21,m.m02=a*_a02+t*_a12+r*_a22,m.m03=s*_a00+e*_a10+c*_a20,m.m04=s*_a01+e*_a11+c*_a21,m.m05=s*_a02+e*_a12+c*_a22,m.m06=M*_a00+i*_a10+_*_a20,m.m07=M*_a01+i*_a11+_*_a21,m.m08=M*_a02+i*_a12+_*_a22,m}static multiplyMat4(m,a,_){_a00=a.m00,_a01=a.m01,_a02=a.m02,_a10=a.m03,_a11=a.m04,_a12=a.m05,_a20=a.m06,_a21=a.m07,_a22=a.m08;var a=_.m00,t=_.m01,r=_.m02,s=_.m04,e=_.m05,c=_.m06,M=_.m08,i=_.m09,_=_.m10;return m.m00=a*_a00+t*_a10+r*_a20,m.m01=a*_a01+t*_a11+r*_a21,m.m02=a*_a02+t*_a12+r*_a22,m.m03=s*_a00+e*_a10+c*_a20,m.m04=s*_a01+e*_a11+c*_a21,m.m05=s*_a02+e*_a12+c*_a22,m.m06=M*_a00+i*_a10+_*_a20,m.m07=M*_a01+i*_a11+_*_a21,m.m08=M*_a02+i*_a12+_*_a22,m}static transfrom(m,a,_){_a00=a.m00,_a01=a.m01,_a02=a.m02,_a10=a.m03,_a11=a.m04,_a12=a.m05,_a20=a.m06,_a21=a.m07,_a22=a.m08;a=_.x,_=_.y;return m.m00=_a00,m.m01=_a01,m.m02=_a02,m.m03=_a10,m.m04=_a11,m.m05=_a12,m.m06=a*_a00+_*_a10+_a20,m.m07=a*_a01+_*_a11+_a21,m.m08=a*_a02+_*_a12+_a22,m}static scale(m,a,_){var t=_.x,_=_.y;return m.m00=t*a.m00,m.m01=t*a.m01,m.m02=t*a.m02,m.m03=_*a.m03,m.m04=_*a.m04,m.m05=_*a.m05,m.m06=a.m06,m.m07=a.m07,m.m08=a.m08,m}static rotate(m,a,_){_a00=a.m00,_a01=a.m01,_a02=a.m02,_a10=a.m03,_a11=a.m04,_a12=a.m05,_a20=a.m06,_a21=a.m07,_a22=a.m08;a=Math.sin(_),_=Math.cos(_);return m.m00=_*_a00+a*_a10,m.m01=_*_a01+a*_a11,m.m02=_*_a02+a*_a12,m.m03=_*_a10-a*_a00,m.m04=_*_a11-a*_a01,m.m05=_*_a12-a*_a02,m.m06=_a20,m.m07=_a21,m.m08=_a22,m}static fromMat4(m,a){return m.m00=a.m00,m.m01=a.m01,m.m02=a.m02,m.m03=a.m04,m.m04=a.m05,m.m05=a.m06,m.m06=a.m08,m.m07=a.m09,m.m08=a.m10,m}static fromViewUp(m,a,_){return vec3_1.MVec3.lengthSqr(a)<utils_1.EPSILON*utils_1.EPSILON?cc_1.Mat3.identity(m):(vec3_1.MVec3.normalize(v3_1,vec3_1.MVec3.cross(v3_1,_||vec3_1.MVec3.UNIT_Y,a)),vec3_1.MVec3.lengthSqr(v3_1)<utils_1.EPSILON*utils_1.EPSILON?cc_1.Mat3.identity(m):(vec3_1.MVec3.cross(v3_2,a,v3_1),cc_1.Mat3.set(m,v3_1.x,v3_1.y,v3_1.z,v3_2.x,v3_2.y,v3_2.z,a.x,a.y,a.z))),m}static fromTranslation(m,a){return m.m00=1,m.m01=0,m.m02=0,m.m03=0,m.m04=1,m.m05=0,m.m06=a.x,m.m07=a.y,m.m08=1,m}static fromScaling(m,a){return m.m00=a.x,m.m01=0,m.m02=0,m.m03=0,m.m04=a.y,m.m05=0,m.m06=0,m.m07=0,m.m08=1,m}static fromRotation(m,a){var _=Math.sin(a),a=Math.cos(a);return m.m00=a,m.m01=_,m.m02=0,m.m03=-_,m.m04=a,m.m05=0,m.m06=0,m.m07=0,m.m08=1,m}static fromQuat(m,a){var _=a.x,t=a.y,r=a.z,a=a.w,s=_+_,e=t+t,c=r+r,_=_*s,M=t*s,t=t*e,i=r*s,n=r*e,r=r*c,s=a*s,e=a*e,a=a*c;return m.m00=1-t-r,m.m03=M-a,m.m06=i+e,m.m01=M+a,m.m04=1-_-r,m.m07=n-s,m.m02=i-e,m.m05=n+s,m.m08=1-_-t,m}static inverseTransposeMat4(m,a){var _=a.m00,t=a.m01,r=a.m02,s=a.m03,e=a.m04,c=a.m05,M=a.m06,i=a.m07,n=a.m08,u=a.m09,h=a.m10,l=a.m11,v=a.m12,b=a.m13,o=a.m14,a=a.m15,x=_*c-t*e,y=_*M-r*e,d=_*i-s*e,p=t*M-r*c,f=t*i-s*c,S=r*i-s*M,V=n*b-u*v,I=n*o-h*v,n=n*a-l*v,q=u*o-h*b,u=u*a-l*b,h=h*a-l*o,l=x*h-y*u+d*q+p*n-f*I+S*V;return l?(m.m00=(c*h-M*u+i*q)*(l=1/l),m.m01=(M*n-e*h-i*I)*l,m.m02=(e*u-c*n+i*V)*l,m.m03=(r*u-t*h-s*q)*l,m.m04=(_*h-r*n+s*I)*l,m.m05=(t*n-_*u-s*V)*l,m.m06=(b*S-o*f+a*p)*l,m.m07=(o*d-v*S-a*y)*l,m.m08=(v*f-b*d+a*x)*l,m):null}static toArray(m,a,_=0){return m[_+0]=a.m00,m[_+1]=a.m01,m[_+2]=a.m02,m[_+3]=a.m03,m[_+4]=a.m04,m[_+5]=a.m05,m[_+6]=a.m06,m[_+7]=a.m07,m[_+8]=a.m08,m}static fromArray(m,a,_=0){return m.m00=a[_+0],m.m01=a[_+1],m.m02=a[_+2],m.m03=a[_+3],m.m04=a[_+4],m.m05=a[_+5],m.m06=a[_+6],m.m07=a[_+7],m.m08=a[_+8],m}static add(m,a,_){return m.m00=a.m00+_.m00,m.m01=a.m01+_.m01,m.m02=a.m02+_.m02,m.m03=a.m03+_.m03,m.m04=a.m04+_.m04,m.m05=a.m05+_.m05,m.m06=a.m06+_.m06,m.m07=a.m07+_.m07,m.m08=a.m08+_.m08,m}static subtract(m,a,_){return m.m00=a.m00-_.m00,m.m01=a.m01-_.m01,m.m02=a.m02-_.m02,m.m03=a.m03-_.m03,m.m04=a.m04-_.m04,m.m05=a.m05-_.m05,m.m06=a.m06-_.m06,m.m07=a.m07-_.m07,m.m08=a.m08-_.m08,m}static multiplyScalar(m,a,_){return m.m00=a.m00*_,m.m01=a.m01*_,m.m02=a.m02*_,m.m03=a.m03*_,m.m04=a.m04*_,m.m05=a.m05*_,m.m06=a.m06*_,m.m07=a.m07*_,m.m08=a.m08*_,m}static multiplyScalarAndAdd(m,a,_,t){return m.m00=_.m00*t+a.m00,m.m01=_.m01*t+a.m01,m.m02=_.m02*t+a.m02,m.m03=_.m03*t+a.m03,m.m04=_.m04*t+a.m04,m.m05=_.m05*t+a.m05,m.m06=_.m06*t+a.m06,m.m07=_.m07*t+a.m07,m.m08=_.m08*t+a.m08,m}static strictEquals(m,a){return m.m00===a.m00&&m.m01===a.m01&&m.m02===a.m02&&m.m03===a.m03&&m.m04===a.m04&&m.m05===a.m05&&m.m06===a.m06&&m.m07===a.m07&&m.m08===a.m08}static equals(m,a,_=utils_1.EPSILON){return Math.abs(m.m00-a.m00)<=_*Math.max(1,Math.abs(m.m00),Math.abs(a.m00))&&Math.abs(m.m01-a.m01)<=_*Math.max(1,Math.abs(m.m01),Math.abs(a.m01))&&Math.abs(m.m02-a.m02)<=_*Math.max(1,Math.abs(m.m02),Math.abs(a.m02))&&Math.abs(m.m03-a.m03)<=_*Math.max(1,Math.abs(m.m03),Math.abs(a.m03))&&Math.abs(m.m04-a.m04)<=_*Math.max(1,Math.abs(m.m04),Math.abs(a.m04))&&Math.abs(m.m05-a.m05)<=_*Math.max(1,Math.abs(m.m05),Math.abs(a.m05))&&Math.abs(m.m06-a.m06)<=_*Math.max(1,Math.abs(m.m06),Math.abs(a.m06))&&Math.abs(m.m07-a.m07)<=_*Math.max(1,Math.abs(m.m07),Math.abs(a.m07))&&Math.abs(m.m08-a.m08)<=_*Math.max(1,Math.abs(m.m08),Math.abs(a.m08))}}(exports.MMat3=MMat3).IDENTITY=Object.freeze(new cc_1.Mat3);