"use strict";function update(n){var r=this,e=(r._dump=n,r.$this),t=(e.setAttribute("no-label",""),r.$this.renderInfo.panel);let a="root",i=e.parentElement;for(;i;){if(i.hasAttribute("cache-expand")){a=i.getAttribute("cache-expand")||"";break}i=i.parentElement}var e="-array-joint-",o=n.name+e+n.type,o=a+"-"+o,l=(o.match(new RegExp(`(${e})`,"g"))||[]).length||1,e=(r.$.container.setAttribute("cache-expand",o),r.$.label),p=(t.setLabel(n,e),n.value),o=(r.$.content.list=p,r.$.num);if(o.value=p.length,n.values&&1<n.values.length)o.invalid=!0,r.$.content.innerHTML=`
        <ui-prop style="color: var(--color-default-fill-weakest);">
            <ui-label slot="content" value="i18n:scene.ui_prop.array_not_support_multiple"></ui-label>
        </ui-prop>
        `;else{o.invalid&&(r.$.content.innerHTML=""),o.invalid=!1,t.setReadonly(n,o),r.$.readonly.style.display=n.readonly?"block":"none";for(var u=r.$.content,s=Array.from(u.children);s.length>p.length;){var d=s.pop();d&&u.removeChild(d)}for(let t=0;t<p.length;t++){let e=s[t];e||(e=document.createElement("ui-list-item"),(c=document.createElement("ui-prop")).setAttribute("style",`flex: 1; --left-width: calc(100% - var(--ui-prop-content-width) + var(--ui-prop-margin-right) * ${l});margin-top:0;`),e.appendChild(c),u.appendChild(e)),e.setAttribute("index",String(t)),e.setAttribute("draggable",String(Boolean(!n.readonly))),e.showSuffix=Boolean(!n.readonly),e.showPrefix=!0;var c=e.querySelector("ui-prop");c?(c.setAttribute("type","dump"),c.setAttribute("array-index",t.toString()),c.setAttribute("array-type",r._dump.type),c.render(p[t])):console.log("error $prop")}t.setReadonly(n,u)}}function ready(){const a=this,i=a.$this;a.hovingTimer=null,a.$.num.addEventListener("change",e=>{e.stopPropagation(),e.preventDefault()}),a.$.num.addEventListener("confirm",e=>{var t=a.$.num.value;if(Array.isArray(a._dump.value)||(a._dump.value=[]),a._dump.elementTypeData)for(;a._dump.value.length<t;){var n=JSON.parse(JSON.stringify(a._dump.elementTypeData));n.name=a._dump.value.length.toString(),a._dump.value.push(n)}else for(;a._dump.value.length<t;)a._dump.value.push(null);0<(a._dump.value.length=t)&&!a.$.container.expand&&setTimeout(()=>{a.$.container.expand||(a.$.container.expand=!0)},500),update.call(a,a._dump),a.$this.dispatch("change"),a.$this.dispatch("confirm")}),a.$this.addEventListener("dragover",t=>{if(t.preventDefault(),a._dump&&a._dump.type){var n=Editor.UI.__protected__.DragArea.currentDragInfo;n&&n.type;t.dataTransfer.types.indexOf("Files");const r=[];let e={};try{e=JSON.parse(JSON.stringify(Editor.UI.__protected__.DragArea.currentDragInfo))}catch(e){console.error(e)}e&&e.additional&&(n=e["additional"],n.forEach(e=>{e.type===a._dump.type&&r.push(e.value)})),r.length&&(clearTimeout(i.hovingTimer),i.setAttribute("hoving",""),t.stopPropagation())}}),i.addEventListener("dragleave",e=>{clearTimeout(a.hovingTimer),a.hovingTimer=setTimeout(()=>{i.removeAttribute("hoving")},200)}),i.addEventListener("drop",t=>{if(i.hasAttribute("hoving")&&a._dump&&a._dump.type){t.stopPropagation(),t.preventDefault();const n=[];let e={};try{e=JSON.parse(JSON.stringify(Editor.UI.__protected__.DragArea.currentDragInfo))}catch(e){console.error(e)}var t=e["additional"];t&&t.forEach(e=>{e.type===a._dump.type&&n.push(e.value)}),n.length&&(t=n.length+a._dump.value.length,a.$.num.value=t,a.$.content.setAttribute("expand",""),n.forEach(e=>{var t=JSON.parse(JSON.stringify(a._dump.elementTypeData));t.name=a._dump.value.length.toString(),t.value.uuid=e,a._dump.value.push(t)}),a.$this.dispatch("change"),a.$this.dispatch("confirm"))}}),i.addEventListener("drop",()=>{clearTimeout(a.hovingTimer),a.hovingTimer=setTimeout(()=>{i.removeAttribute("hoving")},200)}),a.$.content.addEventListener("change",e=>{e=e.detail.list;a._dump.value=e,a.$this.render(),a.$this.dispatch("change"),a.$this.dispatch("confirm")},!1)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.ready=exports.update=exports.$=exports.style=exports.template=void 0,exports.template=`
<ui-section no-border>
    <div slot="header" class="prop-name">
        <ui-label style="flex: 1; white-space: nowrap;"></ui-label>
        <ui-icon style="display: none; font-size: 10px;" value="lock"></ui-icon>
    </div>
    <ui-num-input slot="header" class="prop-content" step="1" min="0" preci="0"></ui-num-input>
    <ui-list class="content" style="--ui-prop-margin-left: 4px; margin-left: var(--ui-prop-margin-left);padding-top:2px;"></ui-list>
</ui-section>
`,exports.style=`
:host { margin-left: 0; }
`,exports.$={container:"ui-section",label:"ui-label",readonly:"ui-icon",num:"ui-num-input",content:".content"},exports.update=update,exports.ready=ready;