"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.element=void 0;const path_1=require("path");class element extends Editor.UI.__protected__.DragObject{constructor(){super(),this.missStateShowText="Missing Asset",this.selectIconValue="drag-asset",this.shadowRoot&&(this.shadowRoot.querySelector("#custom-style").innerHTML=".type ui-icon { color: var(--color-primary-fill-normal); }")}get filter(){try{return JSON.parse(this.getAttribute("filter"))}catch(e){console.error(e)}return null}set filter(e){"object"==typeof e?this.setAttribute("filter",JSON.stringify(e)):this.setAttribute("filter",e)}_onAreaClick(){Editor.Message.broadcast("ui-kit:touch-asset",this.$root.value)}_onSelectClick(){var e;this.$root.disabled||this.$root.readonly||(Date.now(),e=this.$root.filter,Editor.Panel.__protected__.openKit("ui-kit.searcher",{elem:this.$root,params:[{type:"asset",value:this.$root.value,droppable:e?void 0:this.$root.droppable,assetFilter:e}],listeners:{confirm:e=>{e&&(this.$root.value=e.value,this.$root.dispatch("confirm"))},change:e=>{e&&(this.$root.value=e.value,this.$root.dispatch("change"))},preview:e=>{e&&this.$root.dispatch("preview",{detail:e})}}}))}async _onTranslationName(e){let t=null,r=!0;if(e){const s=await Editor.Message.request("asset-db","query-asset-info",e);s&&(t=s.source?(0,path_1.basename)(s.source):s.displayName||s.name,e=this._droppable.split(",").filter(Boolean),r=e.includes(s.type),s.extends)&&s.extends.length&&e.forEach(e=>{s.extends&&s.extends.includes(e)&&(r=!0)})}return r?this.removeAttribute("error"):this.setAttribute("error",!0),t}}exports.element=element;