"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ProgramComponent=void 0;const fs_1=require("fs"),path_1=require("path"),Vue=require("vue/dist/vue.js"),template=(Vue.config.productionTip=!1,(Vue.config.devtools=!1,fs_1.readFileSync)((0,path_1.join)(__dirname,"../../../static/template/program.html"),"utf8"));exports.ProgramComponent=Vue.extend({name:"ProgramComponent",props:{program:{type:String,required:!0},item:{type:Object,required:!0},pkg:{type:String,required:!0}},data(){return{type:"global",localValue:{path:"",commandArgument:[]},defaultValue:{path:"",commandArgument:[]}}},async mounted(){await this.refresh(),await this.init()},methods:{getRenderText(e){var t=this;return e.attributes=e.attributes||{},e.attributes.path=t.program+".path",t.defaultValue&&t.defaultValue.path&&(e.attributes.placeholder=t.defaultValue.path),JSON.stringify(e)},async refresh(){var e=this;e.pkg&&(e.localValue=await Editor.Profile.getConfig(e.pkg,e.program,"local"),e.defaultValue=await Editor.Profile.getConfig(e.pkg,e.program,"default"),!e.localValue||null==e.localValue.path&&null==e.localValue.commandArgument?e.type="global":e.type="local")},popup(e,t){const a=this;a.pkg&&Editor.Menu.popup({x:e,y:t,menu:[{label:Editor.I18n.t("preferences.menu.copyConfigKey"),click(){Editor.Clipboard.write("text",`'${a.pkg}', '${a.program}'`)}},{label:Editor.I18n.t("preferences.menu.move_local"),enabled:"global"===a.type,async click(){let e=await Editor.Profile.getConfig(a.pkg,a.program,a.type);null==e&&(e={path:""}),await Editor.Profile.setConfig(a.pkg,a.program,e,"local"),a.refresh()}},{label:Editor.I18n.t("preferences.menu.move_global"),enabled:"local"===a.type,async click(){var e=await Editor.Profile.getConfig(a.pkg,a.program,a.type);await Editor.Profile.setConfig(a.pkg,a.program,e,"global"),await Editor.Profile.removeConfig(a.pkg,a.program,a.type),a.refresh()}}]})},showArgumentsMenu(e){const t=this;var a=[];for(const o in t.item.arguments){var r=t.item.arguments[o],r={label:o,sublabel:r.label,click(){t.addArgument(o)}};a.push(r)}Editor.Menu.popup({x:e.x,y:e.y,menu:a})},addArgument(e){var t,a=this.$refs.commandArgument;a&&(t=a.value||"",a.value=(t+=" ${"+e+"}").trim(),a.dispatch("confirm"))},async onCommandArgumentConfirm(e){var t=this,e=e.target.value;await Editor.Profile.setConfig(t.pkg,t.program+".commandArgument",e,t.type)},async init(){var e=this,t=await Editor.Profile.getConfig(e.pkg,e.program+".commandArgument",e.type),e=e.$refs.commandArgument;e&&null!=t&&(e.value=t)}},template:template});