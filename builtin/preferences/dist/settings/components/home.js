"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PreferenceHomeVM=exports.template=void 0;const fs_1=require("fs"),path_1=require("path"),Vue=require("vue/dist/vue.js");exports.template=(0,fs_1.readFileSync)((0,path_1.join)(__dirname,"../../../static/settings/index.html"),"utf8"),exports.PreferenceHomeVM=Vue.extend({components:{general:require("./general"),laboratory:require("./laboratory"),item:require("./item")},data(){return{tab:"general",data:{},args:[],preferencesPackagesChanged(){}}},watch:{tab(){this.handleCustomConfig()}},async mounted(){await this.refreshPackagesConfigs(),this.preferencesPackagesChanged=()=>{const e=this.tab;this.tab="",this.$nextTick(()=>{this.tab=e,this.refreshPackagesConfigs()})},Editor.Message.__protected__.addBroadcastListener("preferences:packages-changed",this.preferencesPackagesChanged)},beforeDestroy(){Editor.Message.__protected__.removeBroadcastListener("project:packages-changed",this.preferencesPackagesChanged)},methods:{t(e){return e.startsWith("i18n:")?Editor.I18n.t(e.substring(5)):e},changeTab(e){this.tab=e},inform(e,t,a){t.message&&Editor.Message.send(e,t.message,t.path,a)},async refreshPackagesConfigs(){this.data=await Editor.Message.request("preferences","query-preferences-configs"),this.data&&(this.data[this.tab]||"laboratory"===this.tab)||(this.tab="general"),this.handleCustomConfig()},handleCustomConfig(){if(this.data&&this.data[this.tab]&&this.data[this.tab].custom){const t=Editor.Module.__protected__.requireFile(this.data[this.tab].custom),a=document.createElement("ui-panel"),s={};t&&(Object.keys(t).forEach(e=>{s[e]=t[e]}),t.ready)&&(s.ready=()=>(a.ready=!0,t.ready.call(a.panelObject,...this.args))),a.config=s,this.$nextTick(()=>{var e=this.$refs[this.tab];e&&(e.innerHTML="",e.appendChild(a))})}}},template:exports.template});